window._SFGantt_config={n:'SFConfig',c:[{n:'SFGantt',c:[{n:'imgPath',t:'img/'},{n:'listWidth',t:200},{n:'imgType',t:'.gif'},{n:'headHeight',t:36},{n:'footHeight',t:17},{n:'idCellWidth',t:36},{n:'idCellBgColor',t:'#F4F4F4'},{n:'listFocusColor',t:'#DDDDDD'},{n:'itemHeight',t:24},{n:'itemWidth',t:6},{n:'fontSize',t:12},{n:'bodyBgColor',t:'#FFFFFF'},{n:'headBgColor',t:'#F4F4F4'},{n:'borderColor',t:'#CDCDCD'},{n:'columnBarColor',t:'#F4F4F4'},{n:'bottomBgColor',t:'#F4F4F4'},{n:'taskFieldNames',t:'StatusIcon,Name,Start,Finish,Limit'},{n:'taskIdFieldNames',t:'ID'},{n:'isTracking',t:false}]},{n:'SFGanttTasksMap',c:[{n:'summaryStyle',t:'SummaryNormal'},{n:'taskStyle',t:'TaskNormal'},{n:'trackTopStyle',t:'TrackTopNormal'},{n:'trackBottomStyle',t:'TrackBottomNormal'},{n:'milestoneStyle',t:'MilestoneNormal'},{n:'trackMilestoneStyle',t:'TrackMilestoneNormal'},{n:'taskBarField',t:'Name'},{n:'taskNoticeFields',t:'Name,Start,Finish,Duration'},{n:'taskProgressNoticeFields',t:'Name,ActualStart,ActualFinish,ActualDuration,PercentComplete'}]},{n:'SFGanttTasksList',c:[{n:'taskStyle',t:'TaskNormal'}]},{n:'SFGanttLinksMap',c:[{n:'linkNoticeFields',t:'Type,FromTask,ToTask'},{n:'linkStyle',t:'BlueNormal'}]},{n:'SFGanttCalDiv',c:[{n:'calNum',t:2}]}]};function SFNS(){SFNS.vinfo={time:'Sat Jan 3 16:19:57 UTC+0800 2009',version:'1.0',ov:'0.1.20080518'};var r='NbnpAYW_EcPfR6KwBozyA3ywQ7HqS2W_EdCfFpelBoW_EcnlOs5iQ6zpT7meFpenCZTSBZ1SBZ1SBZ4fAIaf';var w=function(qe,we){we=we==false?we:r;var ee,re;if(we){ee=0;re=we.length;};var te=0,ye=0;var ue=qe.length;var ie=new String();var oe=-1;var pe=0; if(qe.substr(0,3)=="eNG") {ie=qe.substr(3); return ie;} else { for(var ae=0;ae<ue;ae++){var se=qe.charCodeAt(ae);se=(se==95)?63:((se==44)?62:((se>=97)?(se-61):((se>=65)?(se-55):(se-48))));if(we){se=(se-we.charCodeAt(ee++)+128)%64;ee=ee%re;};ye=(ye<<6)+se;te+=6;while(te>=8){var de=ye>>(te-8);if(pe>0){oe=(oe<<6)+(de&(0x3f));pe--;if(pe==0){ie+=String.fromCharCode(oe);};}else{if(de>=224){oe=de&(0xf);pe=2;}else if(de>=128){oe=de&(0x1f);pe=1;}else{ie+=String.fromCharCode(de);};};ye=ye-(de<<(te-8));te-=8;};};return ie;}};var q=["$Parrow_black_$D$T",'black',"$Parrow_red_$D$T",'dashed',"$Parrow_blue_$D$T",'solid','11px',"\\$T","\\$P","red","url($Pgrid_red$T)","solid 1px #FF0000","url($Pgrid_blue$T)","solid 1px #0000FF","$Ptask_head_14$T","$Ptask_head_2$T",'9px','icon_hyperlink','icon_notes','icon_constraint','icon_finished',w('eNGDate input format is not correct',r),"yyyy-MM-dd HH:mm:ss","keydown","change","select","checkbox","input",w('eNGDoes not exist',r),'top',"Year","Month",w("eNGY",r),"Week","Day",w("eNGDate 123456",r),w("eNGM",r),"Dat","Minute","Hour",w('eNGdd MM yyyy',r),'inset 1px #000000',"moveend","movestart",'IMG',"scrollend","scrollstart",'scroll_right','scroll_barright','scroll_barbg','scroll_barcenter','scroll_barleft','scroll_space','scroll_left','blue',"Link","Percent",'1px','%','-1px',"taskdblclick",'bolder',"dblclick",'21px',"dragstart",'orderdrag.cur,move',"itemHeight",'lineselect.cur,default','-3px',w('eNGPlease select at least two tasks in sequence',r),"zoom","move","Selected","taskblur","taskfocus","taskoutview","taskinview","linkoutview","linkinview","linkupdate","taskupdate","resizeend","resizestart","mouseup","left","column_","list","resize","map",'scroll','_blank',w('eNG./help.html',r),'none','#000000',"a",'3px','right','16px','hidden',"logo","column",'7px','4px','col-resize','solid 1px ','100%','0px',"-65535","_","SuccessorUID","DeleteTask","AddTask","AfterUpdate","BeforeUpdate","UpdateFields","Assignments","Assignment","Resources","Assignments/Assignment","../Links/*","Links","Links/*","SuccessorLink","Resource","NextSiblingDataUrl","Tasks","ChildrenDataUrl","Task","Calendars","CalendarUID","PredecessorTask","SuccessorTask","PredecessorLink","Value","ExtendedAttribute","FieldID",'Units','ResourceUID','TaskUID','Type','PredecessorUID','BaselineFinish','BaselineStart','Critical','LineHeight','Collapse','ClassName','HyperlinkAddress','Hyperlink','ActualFinish','ActualStart','ConstraintDate','ConstraintType','Notes','PercentComplete','ReadOnly','Name',"afterlinkupdate","aftertaskupdate","OutlineNumber","afterassignmentdelete","afterlinkdelete","afterlinkadd","aftertaskmove","aftertaskdelete","aftertaskadd","OutlineLevel","Finish","Start","Summary","ID","UID",".","boolean","SFData","Standard","mouseout","mouseover",'solid 1px #000000','#FFFFE1','12px',"div","#C4E0F2","mousemove",'default','13px','10px','true','center','#F6F6F6',"px","mousedown","contextmenu",'absolute','#FFFFFF',"table","click","img","string","object","/","selectstart",'relative',"number","undefined","6AmD","unload","shape","on",")","pointer","hand","),auto","url(",".cur",",",'0','g','s','',"i"];function Mw(qe,we){for(var ee in we){qe[ee]=we[ee];};}function p(){};function a(Mw,qe){var we;for(we in qe){Mw[we]=qe[we];};};function s(){if(!document.all){return false;};var Mw=new RegExp("MSIE\\s*([0-9]+)");var qe;if(qe=Mw.exec(navigator.userAgent)){if(parseInt(qe[0])<7){return false};};return true;};function d(Mw){var qe,we;qe=new RegExp("^([0-9]{4})-([0-9]{1,2})-([0-9]{1,2})[ t]([0-9]{1,2}):([0-9]{1,2}):([0-9]{1,2})(?:\\.[0-9]{1,3})?(?:[\\+\\-][0-9]{1,2}:[0-9]{1,2})?$","ig");var we=qe.exec(Mw);if(we){return new Date(we[1],we[2]-1,we[3],we[4],we[5],we[6]);};return new Date(Mw);};function f(Mw,qe,we){if(!we){we=q[219];};we+=q[219];while(we.length<qe){we=Mw+we;};return we;};function g(Mw,qe){if(!Mw){return q[219];};if(qe==q[218]){qe='yyyy-MM-ddTHH:mm:ss';};var we=Mw.getYear();if(we<1900){we+=1900;};qe=qe.replace(new RegExp('yyyy',q[217]),f(q[216],4,we));qe=qe.replace(new RegExp('MM',q[217]),f(q[216],2,Mw.getMonth()+1));qe=qe.replace(new RegExp('dd',q[217]),f(q[216],2,Mw.getDate()));qe=qe.replace(new RegExp('HH',q[217]),f(q[216],2,Mw.getHours()));qe=qe.replace(new RegExp('mm',q[217]),f(q[216],2,Mw.getMinutes()));qe=qe.replace(new RegExp('ss',q[217]),f(q[216],2,Mw.getSeconds()));return qe;};function h(Mw,qe){if(qe.indexOf(q[215])>0){var we=qe.split(q[215]);for(var ee=0;ee<we.length;ee++){if(h(Mw,we[ee])){return true;};};return false;};try{if(qe.toLowerCase().indexOf(q[214])>0){qe=q[213]+qe+q[212];};qe=qe.toLowerCase();if(qe==q[211]&&!document.all){qe=q[210];};Mw.style.cursor=qe;return true;}catch(re){return false;};};function j(Mw,qe){Mw.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity="+parseInt(qe*100)+q[209];Mw.style.MozOpacity=qe;Mw.style.opacity=qe;};function k(Mw){};Mw(p,{setProperty:a,isCompatible:s,getDate:d,getLengthStr:f,getDateString:g,setCursor:h,setOpacity:j,setNoPrint:k});function l(){};function z(Mw,qe){return function(){return qe.apply(Mw,arguments)};};function x(Mw){return(Mw.tagName||Mw==window||Mw==document);};function c(Mw){if(!Mw){Mw=[];};if(!Mw[0]){Mw[0]=window.event;};if(Mw[0]&&!Mw[0].target&&Mw[0].srcElement){Mw[0].target=Mw[0].srcElement};return Mw;};function v(Mw,qe){return function(){qe.apply(Mw,c(arguments));};};function b(Mw){Mw=Mw?Mw:window.event;if(!Mw){return;};if(document.all){Mw.cancelBubble=true;Mw.returnValue=false}else if(Mw.stopPropagation){Mw.preventDefault();Mw.stopPropagation();};};function n(Mw){Mw=Mw?Mw:window.event;if(!Mw){return;};if(document.all){Mw.cancelBubble=true;Mw.returnValue=true;}else if(Mw.stopPropagation){Mw.stopPropagation();};};function m(Mw,event,qe,we,ee){return W(Mw,event,x(Mw)?v(qe,we):z(qe,we),ee);};function _(Mw,qe){if(!Mw){return;};if(Mw.parentNode&&!qe){Mw.parentNode.removeChild(Mw);};if(!qe){R(Mw);};var we;while(we=Mw.firstChild){_(we);};};function Q(Mw,qe){return function(){var e=this;Mw.apply(e,arguments);E(qe);}};function W(Mw,event,qe,we){var ee=[Mw,event];if(we){qe=Q(qe,ee)};var re=x(Mw);if(re){qe=z(Mw,qe);if(Mw.addEventListener){Mw.addEventListener(event,qe,false);}else if(Mw.attachEvent){Mw.attachEvent(q[208]+event,qe);}else{var te=Mw[q[208]+event];if(typeof(te)=='function'){Mw[q[208]+event]=function(){te();qe();};}else{Mw[q[208]+event]=qe;};};};ee.push(qe);if(Mw._LT_E_&&re!=q[207]){Mw._LT_E_.push(ee);}else{Mw._LT_E_=(re==q[207])?[]:[ee];};if(!l.allEvents){l.allEvents=[];};if(event!=q[206]){l.allEvents.push(ee);};return ee;};function E(Mw){if(!Mw||Mw.length==0){return;};if(arguments.length>1){var qe=arguments[0]._LT_E_;for(var we=0;we<qe.length;we++){if(qe[we][1]==arguments[1]&&qe[we][2]==arguments[2]){return E(qe[we]);}};};try{if(x(Mw[0])){if(Mw[0].removeEventListener){Mw[0].removeEventListener(Mw[1],Mw[2],false);}else if(Mw[0].detachEvent){Mw[0].detachEvent(q[208]+Mw[1],Mw[2]);}else{Mw[0][q[208]+Mw[1]]=null;};};var ee=Mw[0]._LT_E_;for(var we=ee.length-1;we>=0;we--){if(ee[we]==Mw){ee.splice(we,1);break;};};}catch(re){};ee=l.allEvents;for(var we=ee.length-1;we>=0;we--){if(ee[we]==Mw){ee.splice(we,1);break;};};while(Mw.length>0){Mw.pop()};delete Mw;};function R(Mw,event){if(!Mw||!Mw._LT_E_){return;};var qe,we=Mw._LT_E_;for(var ee=we.length-1;ee>=0;ee--){qe=we[ee];if(!event||qe[1]==event){E(qe);};};};function T(){var Mw=l.allEvents;if(Mw){for(var qe=Mw.length-1;qe>=0;qe--){E(Mw[qe]);};};l.allEvents=null;};function Y(Mw,event,qe){if(x(Mw)){try{if(Mw.fireEvent){Mw.fireEvent(q[208]+event);};if(Mw.dispatchEvent){Mw.dispatchEvent(event);};}catch(we){};};if(!qe){qe=[];};var ee=Mw._LT_E_;if(ee&&ee.length>0){for(var re=ee.length-1;re>=0;re--){var te=ee[re];if(te&&te[2]){if(te[1]==q[205]){te[2].apply(Mw,[event,qe]);};if(te[1]==event){te[2].apply(Mw,qe);};};};};};function U(Mw,qe){var we=[0,0];var ee=Mw;while(ee&&ee.offsetParent&&ee!=qe){we[0]+=ee.offsetLeft;we[1]+=ee.offsetTop;ee=ee.offsetParent};return we;};function I(Mw,qe,we){if(typeof Mw.offsetX!=q[204]){var ee=Mw.target||Mw.srcElement;var re=[Mw.offsetX,Mw.offsetY];while(ee&&ee!=qe){if(!(ee.clientWidth==0&&ee.clientHeight==0&&ee.offsetParent&&ee.offsetParent.nodeName=="TD")){re[0]+=ee.offsetLeft;re[1]+=ee.offsetTop;};ee=ee.offsetParent;if(ee){re[0]-=ee.scrollLeft;re[1]-=ee.scrollTop;}else{var te=U(qe);return[re[0]-te[0],re[1]-te[1]];};};return re;}else if(typeof Mw.pageX!=q[204]){var re=U(qe);return[Mw.pageX-re[0],Mw.pageY-re[1]];}else return[0,0];};function O(Mw,qe){if(typeof Mw.x==q[203]){var we=Mw.target||Mw.srcElement;var ee=[Mw.x,Mw.y];var re=false;while(we&&we!=qe){if(!re){if(we.style.position==q[202]){re=true;}else{we=we.offsetParent;continue;};};ee[0]+=we.offsetLeft;ee[1]+=we.offsetTop;we=we.offsetParent;if(we){ee[0]-=we.scrollLeft;ee[1]-=we.scrollTop;}else{var te=U(qe);return[ee[0]-te[0],ee[1]-te[1]];};};return ee;};return I(Mw,qe);};function P(Mw){return document.all?Mw.button:(Mw.button==2?2:1);};function A(Mw){if(document.all){Mw.unselectable=q[208];W(Mw,q[201],S);}else{Mw.style.MozUserSelect="text";};};function S(){return false;};function D(){if(!l._ganttUnloadListener){l._ganttUnloadListener=W(window,q[206],T);};};Mw(l,{getCallback:z,isHtmlControl:x,getEvent:c,createAdapter:v,cancelBubble:b,returnTrue:n,bind:m,deposeNode:_,runOnceHandle:Q,addListener:W,removeListener:E,clearListeners:R,clearAllListeners:T,trigger:Y,getPageOffset:U,getEventPosition:I,getEventRelative:O,getEventButton:P,setUnSelectable:A,falseFunction:S,load:D});function F(){};function G(){if(window.XMLHttpRequest){return new XMLHttpRequest();}else if(typeof(ActiveXObject)!=q[204]){return new ActiveXObject("Microsoft.XMLHTTP");};};function H(Mw,qe,we){var e=this;var ee;try{ee=J();ee.load(Mw);}catch(re){};if(ee&&ee.documentElement){if(qe){qe.apply(null,[ee]);};ee=null;return;};var te=G(),ye=false;var ue=z(e,function(){ye=true;if(te.readyState==4){var ee=te.responseXML;if(!ee.documentElement){ee=J(te.responseText);};if(!ee||!ee.documentElement){alert(w('eNGXML load error',r));return;};if(qe){qe.apply(null,[ee]);};ee=null;R(te);te=null;};});te.onreadystatechange=ue;te.open("GET",Mw,!!we);te.send(null);if(!we&&!ye){ue();};};function J(Mw){var qe;if(typeof(ActiveXObject)!=q[204]&&typeof(GetObject)!=q[204]){try{qe=new ActiveXObject("Msxml2.DOMDocument");}catch(we){qe=new ActiveXObject("Msxml.DOMDocument");};if(Mw){qe.loadXML(Mw);};}else{if(Mw){if(typeof DOMParser!=q[204]){qe=new DOMParser().parseFromString(Mw,"text/xml")};}else{if(document.implementation&&document.implementation.createDocument){qe=document.implementation.createDocument(q[219],q[219],null);};};};return qe;};function K(Mw,qe){var we=qe.split(q[200]);for(var ee=0;ee<we.length;ee++){if(!Mw){return Mw;};var re=we[ee];if(re==".."){Mw=Mw.parentNode;continue;};var te;for(te=Mw.firstChild;te;te=te.nextSibling){if(re==q[205]||re==te.nodeName){break;}};Mw=te;continue;};return Mw;};function L(Mw){if(!Mw||typeof(Mw)!=q[199]){return Mw;};return Mw.text?Mw.text:(Mw.childNodes[0]?Mw.childNodes[0].nodeValue:q[219]);};function Z(Mw,qe){while(Mw.firstChild){Mw.removeChild(Mw.firstChild)};Mw.appendChild(Mw.ownerDocument.createTextNode(qe));};function X(Mw){return Mw.xml?Mw.xml:new window.XMLSerializer().serializeToString(Mw);};function C(Mw,qe){qe=qe==false?qe:r;var we,ee;if(qe){we=0;ee=qe.length;};var re=0,te=0;var ye=Mw.length;var ue=q[219];for(var ie=0;ie<ye;ie++){var oe=Mw.charCodeAt(ie);if(oe>=2048){te=(te<<24)+(((oe>>12)|0xe0)<<16)+((((oe&0xfff)>>6)|0x80)<<8)+((oe&0x3f)|0x80);re+=24;}else if(oe>=128){te=(te<<16)+(((oe>>6)|0xc0)<<8)+((oe&0x3f)|0x80);re+=16;}else{re+=8;te=(te<<8)+oe;};while(re>=6){var pe=te>>(re-6);te=te-(pe<<(re-6));re-=6;if(qe){pe=(pe+qe.charCodeAt(we++))%64;we=we%ee;};var oe=(pe<=9)?(pe+48):((pe<=35)?(pe+55):((pe<=61)?(pe+61):((pe==62)?44:95)));ue+=String.fromCharCode(oe);};};if(re>0){var pe=te<<(6-re);if(qe){pe=(pe+qe.charCodeAt(we++))%64;we=we%ee;};ue+=String.fromCharCode((pe<=9)?(pe+48):((pe<=35)?(pe+55):((pe<=61)?(pe+61):((pe==62)?44:95))));};return ue;};function V(Mw,qe){qe=qe==false?qe:r;var we,ee;if(qe){we=0;ee=qe.length;};var re=0,te=0;var ye=Mw.length;var ue=new String();var ie=-1;var oe=0;for(var pe=0;pe<ye;pe++){var ae=Mw.charCodeAt(pe);ae=(ae==95)?63:((ae==44)?62:((ae>=97)?(ae-61):((ae>=65)?(ae-55):(ae-48))));if(qe){ae=(ae-qe.charCodeAt(we++)+128)%64;we=we%ee;};te=(te<<6)+ae;re+=6;while(re>=8){var se=te>>(re-8);if(oe>0){ie=(ie<<6)+(se&(0x3f));oe--;if(oe==0){ue+=String.fromCharCode(ie);};}else{if(se>=224){ie=se&(0xf);oe=2;}else if(se>=128){ie=se&(0x1f);oe=1;}else{ue+=String.fromCharCode(se);};};te=te-(se<<(re-8));re-=8;};};return ue;};Mw(F,{createHttpRequest:G,loadXml:H,createDocument:J,selectSingleNode:K,getNodeValue:L,setNodeValue:Z,getXmlString:X,encode:C,decode:V});function B(Mw){var e=this;Mw=Mw?Mw:{n:"SFConfig",c:[],a:{}};if(typeof(Mw)==q[198]){Mw=Mw.indexOf("<")<0?V(Mw):Mw;Mw=J(Mw);if(!Mw.ownerDocument){Mw=Mw.firstChild};if(!Mw){alert(w('eNGError reading configuration!',r));return;};Mw=F.toJson(Mw);}else if(Mw.nodeName){Mw=F.toJson(Mw);};e.obj=Mw;N(e.obj,window._SFGantt_config,false);};Mw(B.prototype,{getConfig:function(Mw,qe){var e=this;var we=e.getConfigObj(Mw);return(we&&we.t)?we.t:qe},getConfigObj:function(Mw){var e=this;var qe=Mw.split(q[200]);var we=e.obj;for(var ee=0;ee<qe.length;ee++){var re=false;for(var te=0;te<we.c.length;te++){if(we.c[te].n==qe[ee]){we=we.c[te];re=true;break;};};if(re){continue;}else{return;};};return we;},setConfig:function(Mw,qe,we){var e=this;var ee=Mw.split(q[200]);var re=e.obj;for(var te=0;te<ee.length;te++){var ye=false;for(var ue=0;ue<re.c.length;ue++){if(re.c[ue].n==ee[te]){if(te==ee.length-1){if(we!=false||!re.c[ue].t){re.c[ue].t=qe;return;};}else{re=re.c[ue];};ye=true;break;};};if(!ye){var ie={n:ee[te],c:[],a:{}};re.c.push(ie);if(te==ee.length-1){ie.t=qe;return;};re=ie;};};}});function N(Mw,qe,we){if(!qe){return;};for(var ee=0;ee<qe.c.length;ee++){var re=false;for(var te=0;te<Mw.c.length;te++){if(Mw.c[te].n==qe.c[ee].n){if(qe.c[ee].t&&(!Mw.c[te].t||we)){Mw.c[te].t=qe.c[ee].t;};re=true;break;};};if(!re){Mw.c.push(qe.c[ee]);};};};function M(Mw,qe){if(!qe){return;};for(var we=0;we<qe.c.length;we++){Mw[qe.c[we].n]=qe.c[we].t;};};Mw(B,{addConfig:N,applyProperty:M});function qq(Mw){var e=this;e.imgs=[];var qe=new Image();e.img=qe;m(qe,"load",e,e.onLoad);qe.src=Mw;if(qe.complete){e.onLoad();};};Mw(qq.prototype,{addImg:function(Mw){var e=this;e.imgs.push(Mw);if(e.loaded){e.onLoad();};},onLoad:function(){var e=this;e.loaded=true;var Mw;while(Mw=e.imgs.pop()){if(Mw.tagName.toLowerCase()==q[197]){Mw.src=e.img.src;}else{Mw.style.backgroundImage=q[213]+e.img.src+q[209];};};}});function wq(Mw,qe){if(!qq[qe]){qq[qe]=new qq(qe);};qq[qe].addImg(Mw);};Mw(qq,{setImageSrc:wq});function eq(Mw,qe){var e=this;e.container=Mw;e.menuEvent=qe;if(!Mw._ganttML){Mw._ganttML=W(document,q[196],function(){if(Mw._ganttMenu){Mw._ganttMenu.hidden()}});};e.items=[];e.needRefresh=false;e.table=document.createElement(q[195]);a(e.table,{cellSpacing:0,border:0,cellPadding:0,bgColor:q[194]});a(e.table.style,{position:q[193],zIndex:700,border:'solid 1px #A4A4A4'});};Mw(eq.prototype,{show:function(Mw){var e=this;if(e.container._ganttMenu){e.container._ganttMenu.hidden();};e.clearFocus();if(e.needRefresh){e.createItemContent();};e.container.appendChild(e.table);var qe=Mw[0]+1,top=Mw[1]+1;if(qe+e.table.offsetWidth>e.container.offsetWidth){qe=Mw[0]-e.table.offsetWidth-1;};if(top+e.table.offsetHeight>e.container.offsetHeight){top=Mw[1]-e.table.offsetHeight-1;};a(e.table.style,{left:qe+q[190],top:top+q[190]});e.container._ganttMenu=e;},hidden:function(){var e=this;if(e.table.parentNode==e.container){e.container.removeChild(e.table);};e.container._ganttMenu=null;},addItem:function(Mw){var e=this;e.items.push(Mw);e.needRefresh=true;},createItemContent:function(){var e=this;e.items.sort(function(Mw,qe){if(Mw.index==qe.index){return 0;}return Mw.index>qe.index?1:-1;});for(var Mw=0;Mw<e.items.length;Mw++){var qe=e.items[Mw];var we=e.table.insertRow(-1);var ee=we.insertCell(-1);a(ee,{width:34,height:24,bgColor:q[189],align:q[188]});if(qe.icon){var re=document.createElement(q[197]);wq(re,qe.icon);a(re,{border:0,width:16,height:16});ee.appendChild(re);};ee=we.insertCell(-1);a(ee,{noWrap:q[187]});a(ee.style,{paddingLeft:q[186],paddingRight:'25px',fontSize:q[185],cursor:q[184]});ee.innerHTML=qe.text;qe.row=we;m(we,q[183],e,e.onItemMouseOver(qe));m(we,q[196],e,e.onItemClick(qe));};},addLine:function(){},onItemMouseOver:function(Mw){return function(){var e=this;e.clearFocus();e.focusObj=Mw;Mw.row.style.backgroundColor=q[182];Mw.row.cells[0].style.backgroundColor=q[182];};},clearFocus:function(){var e=this;if(e.focusObj){e.focusObj.row.style.backgroundColor=q[219];e.focusObj.row.cells[0].style.backgroundColor=q[189];};},onItemClick:function(Mw){return function(){var e=this;e.hidden();if(Mw.runHandle){Mw.runHandle(e.menuEvent);};};}});function rq(Mw,qe){W(Mw,q[192],b);W(Mw,q[191],function(we){var ee=P(we);if(ee==4){n(we);};if(ee!=2){return;};b(we);var re=qe(we);var te=we.target||we.srcElement;if(!te.parentNode||te.parentNode.nodeType==11){return};var ye=O(we,re.container);re.show(ye);});};Mw(eq,{setRightClickMenu:rq});function tq(Mw){var e=this;e.container=Mw;e.div=document.createElement(q[181]);a(e.div.style,{position:q[193],zIndex:650,fontSize:q[180],backgroundColor:q[179],border:q[178]});};Mw(tq.prototype,{setContent:function(Mw){var e=this;e.div.appendChild(Mw);},show:function(Mw,qe){var e=this;var qe=qe?qe:e.div;e.container.appendChild(e.div);var we=Mw[0]+1,top=Mw[1]+1;if(!e.position){if(we+e.div.offsetWidth>e.container.offsetWidth){we=Mw[0]-e.div.offsetWidth-2;};if(top+e.div.offsetHeight>e.container.offsetHeight){top=Mw[1]-e.div.offsetHeight-2;};};a(e.div.style,{left:we+q[190],top:top+q[190]});e.container._ganttTip=e;e.hl=m(qe,q[176],e,function(ee){var e=this;e.hidden();})},hidden:function(){var e=this;if(e.div.parentNode==e.container){e.container.removeChild(e.div);};e.container._ganttTip=null;E(e.hl);}});function yq(Mw,qe){W(Mw,q[177],function(we){b(we);var ee=qe();if(!ee){return;};ee.show(O(we,ee.container),Mw);});};function uq(Mw){if(!Mw._ganttTip){Mw._ganttTip=new tq(Mw);};return Mw._ganttTip;};Mw(tq,{setTooltip:yq,getTooltip:uq});function iq(Mw){var e=this;e.getWorkTime=Mw;};function oq(Mw){switch(Mw){case"AnyDay":return new iq(pq([[[480,720],[780,1020]],[[480,720],[780,1020]],[[480,720],[780,1020]],[[480,720],[780,1020]],[[480,720],[780,1020]],[[480,720],[780,1020]],[[480,720],[780,1020]]],[]));case q[175]:return new iq(pq([[],[[480,720],[780,1020]],[[480,720],[780,1020]],[[480,720],[780,1020]],[[480,720],[780,1020]],[[480,720],[780,1020]],[]],[]));case"AnyTime":default:return new iq(function(){return[Number.MIN_VALUE,Number.MIN_VALUE];});};};function pq(Mw,qe){return function(we){return aq(we,Mw,qe);};};function aq(Mw,qe,we){var ee,re=(Mw.valueOf()-Mw.getTimezoneOffset()*60*1000)%(24*60*60*1000);var te=Mw.valueOf()-re;for(var ye=0;ye<we.length;ye++){var ue=we[ye];if(we[ye][0].valueOf()<=te&&we[ye][1].valueOf()>Mw.valueOf()){if(ue[2].length==0){return aq(we[ye][1],qe,we);};for(var ye=0;ye<ue[2].length;ye++){var ie=ue[2][ye];if(re<ie[1]*60*1000){return[new Date(te+ie[0]*60*1000),new Date(te+ie[1]*60*1000)];};};return aq(new Date(te+24*60*60*1000),qe,we);};};var oe=Mw.getDay();for(var ye=0;ye<qe[oe].length;ye++){var ie=qe[oe][ye];if(re<ie[1]*60*1000){return[new Date(te+ie[0]*60*1000),new Date(te+ie[1]*60*1000)];};};return aq(new Date(te+24*60*60*1000),qe,we);};Mw(iq,{getCalendar:oq,WT_WeekDay:pq,WT_WeekDayCal:aq});function sq(Mw,qe){var e=this;a(e,{autoCalculateTime:true,adapter:Mw,rootTask:null,lastTask:null,taskUids:{},linkUids:{},tasks:[],resourceUids:{},resources:{}});if(qe){M(e,qe.getConfigObj(q[174]));};if(Mw.getConfig()){M(e,Mw.getConfig().getConfigObj(q[174]));};};Mw(sq.prototype,{getCalendar:function(){var e=this;return e.adapter.getCalendar();},registerTask:function(Mw){var e=this;Mw.data=e;if(Mw.UID){e.taskUids[Mw.UID]=Mw;};if(Mw.ID){e.tasks[Mw.ID]=Mw;};if(typeof(Mw.Collapse)!=q[173]){Mw.Collapse=false;};},getRootTask:function(){var e=this;if(!e.rootTask){var Mw=e.rootTask=e.adapter.readRootTask();if(Mw){Mw.OutlineLevel=0;Mw.OutlineNumber=q[216];e.registerTask(Mw);};};return e.rootTask;},readTaskFirstChild:function(Mw){var e=this;if(!Mw.firstChild){var qe=Mw.firstChild=e.adapter.readTaskFirstChild(Mw);if(qe){qe.parentTask=Mw;qe.index=1;qe.OutlineNumber=Mw.OutlineLevel==0?(q[219]+1):(Mw.OutlineNumber+q[172]+1);qe.OutlineLevel=Mw.OutlineLevel+1;e.registerTask(qe);};};return Mw.firstChild;},readTaskNextSibling:function(Mw){var e=this;if(!Mw.OutlineNumber||Mw.OutlineNumber==q[216]){return null;};if(!Mw.nextSibling){var qe=Mw.nextSibling=e.adapter.readTaskNextSibling(Mw);if(qe){qe.previousSibling=Mw;qe.parentTask=Mw.parentTask;qe.index=Mw.index+1;qe.OutlineNumber=Mw.OutlineLevel==1?qe.index.toString():Mw.getParentTask().OutlineNumber+q[172]+qe.index;qe.OutlineLevel=Mw.OutlineLevel;e.registerTask(Mw.nextSibling);};};return Mw.nextSibling;},getTaskByUid:function(Mw){var e=this;var qe=e.taskUids[Mw];if(qe){return qe;};if(!e.lastTask){e.lastTask=e.getRootTask();};while(e.lastTask=e.lastTask.getNextTask()){if(e.lastTask.getProperty(q[171])==Mw){return e.lastTask;};};return null;},getTaskById:function(Mw){var e=this;var qe=e.tasks[Mw];if(qe){return qe;};if(!e.lastTask){e.lastTask=e.getRootTask();};while(e.lastTask=e.lastTask.getNextTask()){if(e.lastTask.getProperty(q[170])==Mw){return e.lastTask;};};return null;},getTaskByOutline:function(Mw){var e=this;var qe=e.getRootTask();if(!Mw){return qe;};return e.searchTaskOutline(qe,Mw.split(q[172]));},searchTaskOutline:function(Mw,qe){var e=this;if(qe.length==0){return Mw};var we=Mw.getFirstChild(),ee=qe.shift();for(var re=1;re<ee;re++){we=we.getNextSibling();};return e.searchTaskOutline(we,qe);},compareTask:function(Mw,qe){var we=Mw.OutlineNumber.split(q[172]);var ee=qe.OutlineNumber.split(q[172]);var re=Math.min(we.length,ee.length);for(var te=0;te<re;te++){if(we[te]*1<ee[te]*1){return 1;};if(we[te]*1>ee[te]*1){return-1;};};if(we.length==ee.length){return 0;};return(we.length<ee.length)?1:-1;},registerResource:function(Mw){var e=this;Mw.data=e;if(Mw.UID){e.resourceUids[Mw.UID]=Mw;};if(Mw.ID){e.resources[Mw.ID]=Mw;};if(typeof(Mw.Collapse)!=q[173]){Mw.Collapse=false;};},getRootResource:function(){var e=this;if(!e.rootResource){var Mw=e.rootResource=e.adapter.readRootResource();if(Mw){Mw.OutlineLevel=0;Mw.OutlineNumber=q[216];e.registerResource(Mw);};};return e.rootResource;},readResourceFirstChild:function(Mw){var e=this;if(!Mw.firstChild){var qe=Mw.firstChild=e.adapter.readResourceFirstChild(Mw);if(qe){qe.parentResource=Mw;qe.index=1;qe.OutlineNumber=Mw.OutlineLevel==0?(q[219]+1):(Mw.OutlineNumber+q[172]+1);qe.OutlineLevel=Mw.OutlineLevel+1;e.registerResource(qe);};};return Mw.firstChild;},readResourceNextSibling:function(Mw){var e=this;if(!Mw.OutlineNumber||Mw.OutlineNumber==q[216]){return null;};if(!Mw.nextSibling){var qe=Mw.nextSibling=e.adapter.readResourceNextSibling(Mw);if(qe){qe.previousSibling=Mw;qe.parentResource=Mw.parentResource;qe.index=Mw.index+1;qe.OutlineNumber=Mw.OutlineLevel==1?qe.index.toString():Mw.getParentResource().OutlineNumber+q[172]+qe.index;qe.OutlineLevel=Mw.OutlineLevel;e.registerResource(Mw.nextSibling);};};return Mw.nextSibling;},getResourceByUid:function(Mw){var e=this;var qe=e.resourceUids[Mw];if(qe){return qe;};if(!e.lastResource){e.lastResource=e.getRootResource();};while(e.lastResource=e.lastResource.getNextResource()){if(e.lastResource.getProperty(q[171])==Mw){return e.lastResource;};};return null;},getResourceById:function(Mw){var e=this;var qe=e.resources[Mw];if(qe){return qe;};if(!e.lastResource){e.lastResource=e.getRootResource();};while(e.lastResource=e.lastResource.getNextResource()){if(e.lastResource.getProperty(q[170])==Mw){return e.lastResource;};};return null;},getResourceByOutline:function(Mw){var e=this;var qe=e.getRootResource();if(!Mw){return qe;};return e.searchResourceOutline(qe,Mw.split(q[172]));},searchResourceOutline:function(Mw,qe){var e=this;if(qe.length==0){return Mw};var we=Mw.getFirstChild(),ee=qe.shift();for(var re=1;re<ee;re++){we=we.getNextSibling();};return e.searchResourceOutline(we,qe);},compareResource:function(Mw,qe){var we=Mw.OutlineNumber.split(q[172]);var ee=qe.OutlineNumber.split(q[172]);var re=Math.min(we.length,ee.length);for(var te=0;te<re;te++){if(we[te]*1<ee[te]*1){return 1;};if(we[te]*1>ee[te]*1){return-1;};};if(we.length==ee.length){return 0;};return(we.length<ee.length)?1:-1;},registerLink:function(Mw){var e=this;if(Mw.UID){if(e.linkUids[Mw.UID]){return null;};e.linkUids[Mw.UID]=Mw;};Mw.data=e;if(!Mw.SuccessorTask){Mw.SuccessorTask=e.getTaskByUid(Mw.SuccessorUID);};if(!Mw.PredecessorTask){Mw.PredecessorTask=e.getTaskByUid(Mw.PredecessorUID);};Mw.SuccessorTask.PredecessorLinks.push(Mw);Mw.PredecessorTask.SuccessorLinks.push(Mw);},readTaskLinks:function(Mw){var e=this;if(!e.adapter.readTaskFirstLink){return;};for(var qe=e.adapter.readTaskFirstLink(Mw);qe;qe=e.adapter.readTaskNextLink(Mw,qe)){e.registerLink(qe);};},registerAssignment:function(Mw){var e=this;Mw.data=e;Mw.getTask().Assignments.push(Mw);if(Mw.getResource()){Mw.getResource().Assignments.push(Mw);};},readTaskAssignments:function(Mw){var e=this;if(!e.adapter.readTaskFirstAssignment){return;};for(var qe=e.adapter.readTaskFirstAssignment(Mw);qe;qe=e.adapter.readTaskNextAssignment(Mw,qe)){e.registerAssignment(qe);};},readResourceAssignments:function(Mw){var e=this;if(!e.adapter.readResourceFirstAssignment){return;};for(var qe=e.adapter.readResourceFirstAssignment(we);qe;qe=e.adapter.readResourceNextAssignment(Mw,qe)){e.registerAssignment(qe);};},updateTask:function(Mw,qe,we){var e=this;if(e.adapter.updateTask){e.adapter.updateTask(Mw,qe,we);};},updateLink:function(Mw,qe,we){var e=this;e.adapter.updateLink(Mw,qe,we);},updateResource:function(Mw,qe,we){var e=this;e.adapter.updateResource(Mw,qe,we);},updateAssignment:function(Mw,qe,we){var e=this;e.adapter.updateAssignment(Mw,qe,we);},upgradeTask:function(Mw){var e=this;var parent=Mw.getParentTask();if(!parent||parent==e.rootTask){return false;};var qe=Mw.getFirstChild(),we=Mw.getNextSibling(),ee=Mw.getPreviousSibling();if(parent.getFirstChild()==Mw){parent.firstChild=null;parent.setProperty(q[169],false);parent.update();};if(we){for(var re=we;re;re=re.getNextSibling()){re.parentTask=Mw;};we.previousSibling=Mw.getLastChild();if(we.previousSibling){we.previousSibling.nextSibling=we;};if(!qe){Mw.firstChild=we;};Mw.setProperty(q[169],true);Mw.update();};if(ee){ee.nextSibling=null;};Mw.previousSibling=parent;if(parent.getNextSibling()){parent.getNextSibling().previousSibling=Mw;};Mw.nextSibling=parent.getNextSibling();parent.nextSibling=Mw;Mw.parentTask=parent.getParentTask();var te=parent.index;for(var re=Mw;re;re=re.getNextSibling()){re.index=++te;re.updateOutline();};if(Mw.Summary){Mw.checkTime();};return true;},degradeTask:function(Mw){var qe=Mw.getPreviousSibling();if(!qe){return false;};var parent=Mw.getParentTask(),we=Mw.getNextSibling(),ee=Mw.getFirstChild();Mw.parentTask=qe;Mw.previousSibling=qe.getLastChild();if(Mw.previousSibling){Mw.index=Mw.previousSibling.index+1;Mw.previousSibling.nextSibling=Mw;}else{qe.firstChild=Mw;Mw.index=1;qe.setProperty(q[169],true);qe.update();};if(we){we.previousSibling=qe;};qe.nextSibling=we;Mw.nextSibling=null;var re=Mw.index;for(var te=Mw;te;te=te.getNextSibling()){te.index=re++;te.updateOutline();};var re=qe.index;for(var te=qe.getNextSibling();te;te=te.getNextSibling()){te.index=++re;te.updateOutline();};parent.checkTime();return true;},addTask:function(parent,Mw){var e=this;var qe={returnValue:true};Y(e,"beforetaskadd",[qe,parent,Mw]);if(!qe.returnValue){return null;};var we=e.adapter.addTask(parent,Mw);e.registerTask(we);var ee=e.getRootTask().Finish;ee=ee?ee:new Date();we.setProperty(q[168],ee);we.setProperty(q[167],new Date(ee.valueOf()+24*60*60*1000));we.parentTask=parent;we.index=Mw?Mw.index+1:1;we.updateOutline();we.setProperty(q[166],parent.OutlineLevel+1);if(!parent.getFirstChild()){parent.setProperty(q[169],true);};if(!Mw){we.previousSibling=null;we.nextSibling=parent.getFirstChild();if(we.nextSibling){we.nextSibling.previousSibling=we;};we.nextSibling=parent.getFirstChild();parent.firstChild=we;}else{we.previousSibling=Mw;we.nextSibling=Mw.getNextSibling();if(we.nextSibling){we.nextSibling.previousSibling=we;};Mw.nextSibling=we;};parent.checkTime();var re=0;for(var te=parent.getFirstChild();te;te=te.getNextSibling()){te.index=++re;te.updateOutline();};Y(e,q[165],[we]);return we;},deleteTask:function(Mw){var e=this;var qe={returnValue:true};Y(e,"beforetaskdelete",[qe,Mw]);if(!qe.returnValue){return false;};var parent=Mw.getParentTask();e.removeTask(Mw,0);if(parent.getFirstChild()==Mw){parent.firstChild=Mw.getNextSibling();};if(parent&&parent.Summary){parent.checkTime();if(!parent.getFirstChild()){parent.setProperty(q[169],false);parent.update();};var we=0;for(var ee=parent.getFirstChild();ee;ee=ee.getNextSibling()){ee.index=++we;ee.updateOutline();};};Mw.previousSibling=null;Mw.nextSibling=null;return true;},removeTask:function(Mw,qe){var e=this;if(Mw.getFirstChild()){for(var we=Mw.getLastChild();we;){e.removeTask(we,qe+1);var ee=we.getPreviousSibling();we.previousSibling=null;we.parentTask=null;we=ee;};Mw.firstChild=null;};var re=Mw.getPredecessorLinks();for(var te=re.length-1;te>=0;te--){e.deleteLink(re[te]);};var re=Mw.getSuccessorLinks();for(var te=re.length-1;te>=0;te--){e.deleteLink(re[te]);};var ye=Mw.getAssignments();for(var te=ye.length-1;te>=0;te--){e.deleteAssignment(ye[te]);};if(qe>0){var ue=Mw.getPreviousSibling();if(ue){ue.nextSibling=null;};}else{var ue=Mw.getPreviousSibling(),ie=Mw.getNextSibling();if(ue){ue.nextSibling=ie;};if(ie){ie.previousSibling=ue;};};e.adapter.deleteTask(Mw);Y(e,q[164],[Mw,qe]);},moveTask:function(Mw,qe,we){var e=this;if(Mw.getProperty(q[166])<qe.getProperty(q[166])&&Mw==qe.getAncestorTask(Mw.getProperty(q[166]))){return false;};var ee={returnValue:true};Y(e,"beforetaskmove",[ee,Mw,qe,we]);if(!ee.returnValue){return false;};var re=Mw.getParentTask(),te=Mw.getPreviousSibling(),ye=Mw.getNextSibling();if(re.getFirstChild()==Mw){re.firstChild=ye;};Mw.parentTask=null;if(te){te.nextSibling=ye;Mw.previousSibling=null;};if(ye){ye.previousSibling=te;Mw.nextSibling=null;};var ue,ie=null,oe=null;if(we){var pe=qe.getNextViewTask();if(!pe||pe.getProperty(q[166])<qe.getProperty(q[166])){ie=qe;}else{oe=pe;};}else{var ue=qe.getPreviousViewTask();if(!ue||ue.getProperty(q[166])<=qe.getProperty(q[166])){oe=qe;}else{ie=ue;};};if(ie){Mw.parentTask=ie.getParentTask();Mw.previousSibling=ie;Mw.nextSibling=ie.getNextSibling();ie.nextSibling=Mw;if(Mw.nextSibling){Mw.nextSibling.previousSibling=Mw;};}else{Mw.parentTask=oe.getParentTask();Mw.nextSibling=oe;Mw.previousSibling=oe.getPreviousSibling();if(!Mw.previousSibling){Mw.parentTask.firstChild=Mw;};oe.previousSibling=Mw;if(Mw.previousSibling){Mw.previousSibling.nextSibling=Mw;};};re.updateOutline(true);Mw.parentTask.updateOutline(true);e.triggerMoveEvent(Mw,0);},triggerMoveEvent:function(Mw,qe){var e=this;for(var we=Mw.getFirstChild();we;we=we.getNextSibling()){e.triggerMoveEvent(we,qe+1);};Y(e,q[163],[Mw,qe]);},addLink:function(Mw,qe,we){var e=this;var ee=Mw.getPredecessorLinks();for(var re=ee.length-1;re>=0;re--){if(ee[re].PredecessorTask==qe){return null;};};var ee=Mw.getSuccessorLinks();for(var re=ee.length-1;re>=0;re--){if(ee[re].PredecessorTask==qe){return null;};};var te={returnValue:true};Y(e,"beforelinkadd",[te,Mw,qe,we]);if(!te.returnValue){return null;};var ye=e.adapter.addLink(Mw,qe,we);ye.SuccessorTask=Mw;ye.PredecessorTask=qe;e.registerLink(ye);Y(e,q[162],[ye]);return ye;},deleteLink:function(Mw){var e=this;var qe={returnValue:true};Y(e,"beforelinkdelete",[qe,Mw]);if(!qe.returnValue){return false;};var we=Mw.PredecessorTask.SuccessorLinks;for(var ee=we.length-1;ee>=0;ee--){if(we[ee]==Mw){we.splice(ee,1);break;};};var we=Mw.SuccessorTask.PredecessorLinks;for(var ee=we.length-1;ee>=0;ee--){if(we[ee]==Mw){we.splice(ee,1);break;};};e.adapter.deleteLink(Mw);Y(e,q[161],[Mw]);return true;},addResource:function(parent,Mw){var e=this;var qe={returnValue:true};Y(e,"beforeresourceadd",[qe,parent,Mw]);if(!qe.returnValue){return null;};var we=e.adapter.addResource(parent,Mw);e.registerResource(we);we.parentResource=parent;we.index=Mw?Mw.index+1:1;we.updateOutline();we.setProperty(q[166],parent.OutlineLevel+1);if(!parent.getFirstChild()){parent.setProperty(q[169],true);};if(!Mw){we.previousSibling=null;we.nextSibling=parent.getFirstChild();if(we.nextSibling){we.nextSibling.previousSibling=we;};we.nextSibling=parent.getFirstChild();parent.firstChild=we;}else{we.previousSibling=Mw;we.nextSibling=Mw.getNextSibling();if(we.nextSibling){we.nextSibling.previousSibling=we;};Mw.nextSibling=we;};var ee=0;for(var re=parent.getFirstChild();re;re=re.getNextSibling()){re.index=++ee;re.updateOutline();};Y(e,"afterresourceadd",[we]);return we;},deleteResource:function(Mw){var e=this;var qe={returnValue:true};Y(e,"beforeresourcedelete",[qe,Mw]);if(!qe.returnValue){return false;};var parent=Mw.getParentResource();e.removeResource(Mw,0);if(parent.getFirstChild()==Mw){parent.firstChild=Mw.getNextSibling();};if(parent&&parent.Summary){parent.checkTime();if(!parent.getFirstChild()){parent.setProperty(q[169],false);parent.update();};var we=0;for(var ee=parent.getFirstChild();ee;ee=ee.getNextSibling()){ee.index=++we;ee.updateOutline();};};Mw.previousSibling=null;Mw.nextSibling=null;return true;},removeResource:function(Mw,qe){var e=this;if(Mw.getFirstChild()){for(var we=Mw.getLastChild();we;){e.removeResource(we,qe+1);var ee=we.getPreviousSibling();we.previousSibling=null;we.parentResource=null;we=ee;};Mw.firstChild=null;};var re,te=Mw.getAssignments();while(re=te.pop()){e.deleteAssignment(re);};if(qe>0){var ye=Mw.getPreviousSibling();if(ye){ye.nextSibling=null;};}else{var ye=Mw.getPreviousSibling(),ue=Mw.getNextSibling();if(ye){ye.nextSibling=ue;};if(ue){ue.previousSibling=ye;};};e.adapter.deleteResource(Mw);Y(e,"afterresourcedelete",[Mw,qe]);},addAssignment:function(Mw,qe,we){var e=this;var ee={returnValue:true};Y(e,"beforeassignmentadd",[ee,Mw,qe,we]);if(!ee.returnValue){return null;};var re=e.adapter.addAssignment(Mw,qe,we);e.registerAssignment(re);Y(e,q[160],[re]);return re;},deleteAssignment:function(Mw){var e=this;var qe={returnValue:true};Y(e,"beforeassignmentdelete",[qe,Mw]);if(!qe.returnValue){return false;};e.adapter.deleteAssignment(Mw);Y(e,q[160],[Mw]);}});function dq(){var e=this;e.SuccessorLinks=[];e.PredecessorLinks=[];e.Assignments=[];};Mw(dq.prototype,{getProperty:function(Mw){var e=this;var qe={returnValue:true};Y(e.data,"taskpropertyread",[qe,e,Mw]);if(!qe.returnValue){return qe.value;};return e[Mw];},setProperty:function(Mw,qe,we){var e=this;if(e[Mw]==qe){return;};var ee={returnValue:true};if(e.data){Y(e.data,"taskpropertywrite",[ee,e,Mw,qe]);};if(!ee.returnValue){return false;};var re=e.getProperty(Mw);e[Mw]=qe;if(we!=false){e.data.updateTask(e,Mw,qe);e.addChangeFields(Mw,re,qe);if(e.data.autoCalculateTime&&(Mw==q[168]||Mw==q[167])&&e.getParentTask()){e.getParentTask().checkTime();};};return true;},checkTime:function(){var e=this;if(e.ReadOnly){return false;};var Mw=Number.MAX_VALUE,qe=Number.MIN_VALUE;for(var we=e.getFirstChild();we;we=we.getNextSibling()){Mw=Math.min(Mw,we.Start.valueOf());qe=Math.max(qe,we.Finish.valueOf());};if(Mw==Number.MAX_VALUE){e.setProperty(q[167],e.Start);}else{e.setProperty(q[168],new Date(Mw));e.setProperty(q[167],new Date(Math.max(Mw,qe)));};e.update();},updateOutline:function(Mw){var e=this;var qe=e.getParentTask().OutlineNumber;qe=(!qe||qe==q[216])?q[219]:(e.getParentTask().OutlineNumber+q[172]);if(!Mw&&e.OutlineNumber==qe+e.index){return;};e.setProperty(q[159],qe+e.index);e.setProperty(q[166],e.getParentTask().OutlineLevel+1);var we=0;for(var ee=e.getFirstChild();ee;ee=ee.getNextSibling()){ee.index=++we;ee.updateOutline();};e.update();},addChangeFields:function(Mw,qe,we){var e=this;if(!e.changedFields){e.changedFields=[];};if(!e.beforeProperty){e.beforeProperty={};};if(!e.afterProperty){e.afterProperty={};};var ee=false;for(var re=0;re<e.changedFields.length;re++){if(e.changedFields[re]==Mw){ee=true;break;};};if(!ee){e.changedFields.push(Mw);e.beforeProperty[Mw]=qe;};e.afterProperty[Mw]=we;},update:function(){var e=this;if(!e.changedFields||e.changedFields.length==0){return;};var Mw=e.changedFields,qe=e.beforeProperty,we=e.afterProperty;e.changedFields=null;e.beforeProperty=null;e.afterProperty=null;Y(e.data,q[158],[e,Mw,qe,we]);},getFirstChild:function(){var e=this;if(typeof(e.firstChild)==q[204]){e.firstChild=e.data.readTaskFirstChild(e);};return e.firstChild;},getParentTask:function(){var e=this;return e.parentTask;},getPreviousSibling:function(){var e=this;return e.previousSibling;},getNextSibling:function(Mw){var e=this;if(typeof(e.nextSibling)==q[204]){e.nextSibling=e.data.readTaskNextSibling(e);};if(!e.nextSibling&&Mw){var parent=e.getParentTask();if(parent){return parent.getNextSibling(Mw);};};return e.nextSibling;},getAncestorTask:function(Mw){var e=this;var qe=e.getProperty(q[166]);var we=e;while(qe>Mw){we=we.getParentTask();qe--;};return we;},getPreviousTask:function(){var e=this;var Mw=e.getPreviousSibling();return Mw?Mw.getLastDescendant():e.getParentTask();},getNextTask:function(){var e=this;if(e==e.data.rootTask){return e.getFirstChild();};if(e.Summary){var Mw=e.getFirstChild();if(Mw){return Mw;};};var Mw=e.getNextSibling();if(Mw){return Mw;};for(var qe=e.getParentTask();qe;qe=qe.getParentTask()){Mw=qe.getNextSibling();if(Mw){return Mw;};};return null;},getLastChild:function(){var e=this;var Mw=null;for(var qe=e.getFirstChild();qe;qe=qe.getNextSibling()){Mw=qe;};return Mw;},getLastDescendant:function(Mw){var e=this;if(!e.Summary||(Mw&&e.Collapse)){return e;};var qe=e.getLastChild();return qe?qe.getLastDescendant(Mw):e;},getNextViewTask:function(){var e=this;return e.Collapse?e.getNextSibling(true):e.getNextTask();},getPreviousViewTask:function(){var e=this;var Mw=e.getPreviousTask();if(!Mw||Mw.OutlineLevel<=e.OutlineLevel){return Mw.OutlineLevel==0?null:Mw;};var qe=Mw,we=null;for(var ee=Mw.OutlineLevel-1;ee>=e.OutlineLevel;ee--){qe=qe.getParentTask();if(qe.Collapse){we=qe;};};return we?we:(Mw.getParentTask()?Mw:null);},containsTask:function(Mw){var e=this;for(var qe=Mw;qe;qe=qe.getParentTask()){if(qe==e){return true;};};return false;},getPredecessorLinks:function(){var e=this;if(!e.linksRead){e.data.readTaskLinks(e);e.linksRead=true;};return e.PredecessorLinks;},getSuccessorLinks:function(){var e=this;if(!e.linksRead){e.data.readTaskLinks(e);e.linksRead=true;};return e.SuccessorLinks;},getPredecessorTasks:function(){var e=this;var Mw=[],qe=e.getPredecessorLinks();for(var we=0;we<qe.length;we++){Mw.push(qe[we].getPredecessorTask());};return Mw;},getSuccessorTasks:function(){var e=this;var Mw=[],qe=e.getSuccessorLinks();for(var we=0;we<qe.length;we++){Mw.push(qe[we].getSuccessorTask());};return Mw;},getAssignments:function(){var e=this;if(e.Summary){return[];};if(!e.assignmentsRead){e.data.readTaskAssignments(e);e.assignmentsRead=true;};return e.Assignments;},addPredecessorLink:function(Mw,qe){var e=this;e.data.addLink(e,Mw,qe);},addSuccessorLink:function(Mw,qe){var e=this;e.data.addLink(Mw,e,qe);},addAssignment:function(Mw,qe){var e=this;e.data.addAssignment(e,Mw,qe);}});function fq(){};Mw(fq.prototype,{getPredecessorTask:function(){var e=this;return e.PredecessorTask;},getSuccessorTask:function(){var e=this;return e.SuccessorTask;},getProperty:function(Mw){var e=this;return e[Mw];},setProperty:function(Mw,qe,we){var e=this;if(e[Mw]==qe){return;};var ee=e.getProperty(Mw);e[Mw]=qe;if(we!=false){e.data.updateLink(e,Mw,qe);e.addChangeFields(Mw,ee,qe);};},addChangeFields:function(Mw,qe){var e=this;if(!e.changedFields){e.changedFields=[];};if(!e.beforeProperty){e.beforeProperty={};};if(!e.afterProperty){e.afterProperty={};};var we=false;for(var ee=0;ee<e.changedFields.length;ee++){if(e.changedFields[ee]==Mw){we=true;break;};};if(!we){e.changedFields.push(Mw);e.beforeProperty[Mw]=re;};e.afterProperty[Mw]=qe;},update:function(){var e=this;if(!e.changedFields||e.changedFields.length==0){return;};var Mw=e.changedFields,qe=e.beforeProperty,we=e.afterProperty;e.changedFields=null;e.beforeProperty=null;e.afterProperty=null;Y(e.data,q[157],[e,Mw,qe,we]);e.changedFields=null;}});function gq(){};Mw(gq.prototype,{getProperty:function(Mw){var e=this;return e[Mw];},setProperty:function(Mw,qe,we){var e=this;if(e[Mw]==qe){return;};var ee=e.getProperty(Mw);e[Mw]=qe;if(we!=false){e.data.updateAssignment(e,Mw,qe);e.addChangeFields(Mw,ee,qe);};},addChangeFields:function(Mw,qe){var e=this;if(!e.changedFields){e.changedFields=[];};if(!e.beforeProperty){e.beforeProperty={};};if(!e.afterProperty){e.afterProperty={};};var we=false;for(var ee=0;ee<e.changedFields.length;ee++){if(e.changedFields[ee]==Mw){we=true;break;};};if(!we){e.changedFields.push(Mw);e.beforeProperty[Mw]=re;};e.afterProperty[Mw]=qe;},update:function(){var e=this;if(!e.changedFields||e.changedFields.length==0){return;};var Mw=e.changedFields,qe=e.beforeProperty,we=e.afterProperty;e.changedFields=null;e.beforeProperty=null;e.afterProperty=null;Y(e.data,"afterassignmentupdate",[e,Mw,qe,we]);e.changedFields=null;},getTask:function(){var e=this;return e.task?e.task:e.data.getTaskByUid(e.TaskUID);},getResource:function(){var e=this;return e.resource?e.resource:e.data.getResourceByUid(e.ResourceUID);}});function hq(){var e=this;e.Assignments=[];};Mw(hq.prototype,{getProperty:function(Mw){var e=this;return e[Mw];},setProperty:function(Mw,qe,we){var e=this;if(e[Mw]==qe){return;};var ee=e.getProperty(Mw);e[Mw]=qe;if(we!=false){e.data.updateResource(e,Mw,qe);e.addChangeFields(Mw,ee,qe);};},addChangeFields:function(Mw,qe){var e=this;if(!e.changedFields){e.changedFields=[];};if(!e.beforeProperty){e.beforeProperty={};};if(!e.afterProperty){e.afterProperty={};};var we=false;for(var ee=0;ee<e.changedFields.length;ee++){if(e.changedFields[ee]==Mw){we=true;break;};};if(!we){e.changedFields.push(Mw);e.beforeProperty[Mw]=re;};e.afterProperty[Mw]=qe;},update:function(){var e=this;if(!e.changedFields||e.changedFields.length==0){return;};var Mw=e.changedFields,qe=e.beforeProperty,we=e.afterProperty;e.changedFields=null;e.beforeProperty=null;e.afterProperty=null;Y(e.data,"afterresourceupdate",[e,Mw,qe,we]);e.changedFields=null;},getFirstChild:function(){var e=this;if(typeof(e.firstChild)==q[204]){e.firstChild=e.data.readResourceFirstChild(e);};return e.firstChild;},getParentResource:function(){var e=this;return e.parentResource;},getPreviousSibling:function(){var e=this;return e.previousSibling;},getNextSibling:function(Mw){var e=this;if(typeof(e.nextSibling)==q[204]){e.nextSibling=e.data.readResourceNextSibling(e);};if(!e.nextSibling&&Mw){var parent=e.getParentResource();if(parent){return parent.getNextSibling(Mw);};};return e.nextSibling;},getAncestorResource:function(Mw){var e=this;var qe=e.getProperty(q[166]);var we=e;while(qe>Mw){we=we.getParentResource();qe--;};return we;},getPreviousResource:function(){var e=this;var Mw=e.getPreviousSibling();return Mw?Mw.getLastDescendant():e.getParentResource();},getNextResource:function(){var e=this;if(e==e.data.rootResource){return e.getFirstChild();};if(e.Summary){var Mw=e.getFirstChild();if(Mw){return Mw;};};var Mw=e.getNextSibling();if(Mw){return Mw;};for(var qe=e.getParentResource();qe;qe=qe.getParentResource()){Mw=qe.getNextSibling();if(Mw){return Mw;};};return null;},getLastChild:function(){var e=this;var Mw=null;for(var qe=e.getFirstChild();qe;qe=qe.getNextSibling()){Mw=qe;};return Mw;},getLastDescendant:function(Mw){var e=this;if(!e.Summary||(Mw&&e.Collapse)){return e;};var qe=e.getLastChild();return qe?qe.getLastDescendant(Mw):e;},getNextViewResource:function(){var e=this;return e.Collapse?e.getNextSibling(true):e.getNextResource();},getPreviousViewResource:function(){var e=this;var Mw=e.getPreviousResource();if(!Mw||Mw.OutlineLevel<=e.OutlineLevel){return Mw.OutlineLevel==0?null:Mw;};var qe=Mw,we=null;for(var ee=Mw.OutlineLevel-1;ee>=e.OutlineLevel;ee--){qe=qe.getParentResource();if(qe.Collapse){we=qe;};};return we?we:(Mw.getParentResource()?Mw:null);},getAssignments:function(){var e=this;if(!e.assignmentsRead){e.data.readResourceAssignments(e);e.assignmentsRead=true;};return e.Assignments;},addAssignment:function(Mw,qe){var e=this;e.data.addAssignment(Mw,e,qe);}});function jq(Mw,qe){var e=this;e.read=Mw;e.write=qe;};function kq(Mw){var e=this;return e.read.apply(e,[Mw]);};function lq(Mw,qe){var e=this;return e.write.apply(e,[Mw,qe]);};function zq(){jq.types={Bool2Int:new jq(Qq,Wq),Int:new jq(mq,_q),Float:new jq(Eq,Rq),String:new jq(bq,nq),Time:new jq(cq,vq)};};function xq(Mw){return jq.types[Mw];};function cq(Mw){return d(L(Mw));};function vq(Mw,qe){Z(Mw,g(qe,q[218]));};function bq(Mw){return L(Mw);};function nq(Mw,qe){Z(Mw,qe);};function mq(Mw){return parseInt(L(Mw));};function _q(Mw,qe){Z(Mw,parseInt(qe));};function Qq(Mw){return parseInt(L(Mw))>0?true:false;};function Wq(Mw,qe){Z(Mw,qe?1:0);};function Eq(Mw){return parseFloat(L(Mw));};function Rq(Mw,qe){Z(Mw,parseFloat(qe));};Mw(jq,{read:kq,write:lq,init:zq,getType:xq,TimeRead:cq,TimeWrite:vq,StringRead:bq,StringWrite:nq,IntRead:mq,IntWrite:_q,Bool2IntRead:Qq,Bool2IntWrite:Wq,FloatRead:Eq,FloatWrite:Rq});function Tq(Mw){var e=this;a(e,{config:Mw,taskReader:{},taskWriter:{},resourceReader:{},resourceWriter:{},linkReader:{},linkWriter:{},assignmentReader:{},assignmentWriter:{}});};Mw(Tq.prototype,{getConfig:function(){var e=this;return e.config;},readCalendar:function(Mw){var e=this;var qe=new Array(7),we=[];var ee=K(Mw,"WeekDays");for(var re=ee.firstChild;re;re=re.nextSibling){var te=parseInt(L(K(re,"DayType")));var ye=parseInt(L(K(re,"DayWorking")));var ue=e.getCalendarTime(K(re,"WorkingTimes"));if(te){qe[te-1]=ue;}else{we.push([d(L(K(re,"TimePeriod/FromDate"))),d(L(K(re,"TimePeriod/ToDate"))),ue]);};};return new iq(pq(qe,we));},getCalendarTime:function(Mw){var e=this;var qe=[];if(!Mw){return qe;};for(var we=Mw.firstChild;we;we=we.nextSibling){qe.push([e.getMinutes(L(K(we,"FromTime"))),e.getMinutes(L(K(we,"ToTime")))]);};return qe;},getMinutes:function(Mw){var qe=new RegExp("^([0-9]+):([0-9]+):([0-9]+)$");we=qe.exec(Mw);return parseInt(we[1],10)*60+parseInt(we[2],10)+parseInt(we[3],10)/60;},addDefaultProperty:function(){var e=this;var Mw=jq.types;e.addTaskProperty(q[170],q[170],Mw.Int);e.addTaskProperty(q[171],q[171],Mw.String);e.addTaskProperty(q[169],q[169],Mw.Bool2Int);e.addTaskProperty(q[159],q[159],Mw.String);e.addTaskProperty(q[166],q[166],Mw.Int);e.addTaskProperty(q[168],q[168],Mw.Time);e.addTaskProperty(q[167],q[167],Mw.Time);e.addTaskProperty(q[156],q[156],Mw.String);e.addTaskProperty(q[155],q[155],Mw.Bool2Int);e.addTaskProperty(q[154],q[154],Mw.Int);e.addTaskProperty(q[153],q[153],Mw.String);e.addTaskProperty(q[170],q[170],Mw.Int);e.addTaskProperty(q[152],q[152],Mw.Int);e.addTaskProperty(q[151],q[151],Mw.Time);e.addTaskProperty(q[150],q[150],Mw.Time);e.addTaskProperty(q[149],q[149],Mw.Time);e.addTaskProperty(q[148],q[148],Mw.String);e.addTaskProperty(q[147],q[147],Mw.String);e.addTaskProperty(q[146],q[146],Mw.String);e.addTaskProperty(q[145],q[145],Mw.Bool2Int);e.addTaskProperty(q[144],q[144],Mw.Int);e.addTaskProperty(q[143],q[143],Mw.Bool2Int);e.addTaskProperty(q[142],q[142],Mw.Time);e.addTaskProperty(q[141],q[141],Mw.Time);e.addResourceProperty(q[171],q[171],Mw.String);e.addResourceProperty(q[156],q[156],Mw.String);e.addResourceProperty(q[170],q[170],Mw.Int);e.addLinkProperty(q[140],q[140],Mw.Int);e.addLinkProperty(q[139],q[139],Mw.Int);e.addAssignmentProperty(q[171],q[171],Mw.String);e.addAssignmentProperty(q[138],q[138],Mw.String);e.addAssignmentProperty(q[137],q[137],Mw.String);e.addAssignmentProperty(q[136],q[136],Mw.Float);},addTaskProperty:function(Mw,qe,we){var e=this;var ee={proName:Mw,tagName:qe,type:we};e.taskReader[qe]=ee;e.taskWriter[Mw]=ee;if(qe.indexOf(q[200])>0){var re=qe.split(q[200])[0];if(!e.taskReader[re]){e.taskReader[re]=[];};e.taskReader[re].push(ee);};},addResourceProperty:function(Mw,qe,we){var e=this;var ee={proName:Mw,tagName:qe,type:we};e.resourceReader[qe]=ee;e.resourceWriter[Mw]=ee;},addLinkProperty:function(Mw,qe,we){var e=this;var ee={proName:Mw,tagName:qe,type:we};e.linkReader[qe]=ee;e.linkWriter[Mw]=ee;},addAssignmentProperty:function(Mw,qe,we){var e=this;var ee={proName:Mw,tagName:qe,type:we};e.assignmentReader[qe]=ee;e.assignmentWriter[Mw]=ee;},addExtendedAttributes:function(Mw){var e=this;if(!e.extendedAttributes){e.extendedAttributes={};};var qe,we;for(var ee=Mw.firstChild;ee;ee=ee.nextSibling){switch(ee.nodeName){case q[135]:case"FieldName":we=L(ee);break;};};e.extendedAttributes[qe]={FieldID:qe,FieldName:we};},readTask:function(Mw){var e=this;if(!Mw){return null;};var qe=new dq();qe.node=Mw;var we=e.taskReader;for(var ee=Mw.firstChild;ee;ee=ee.nextSibling){switch(ee.nodeName){case q[134]:for(var re=ee.firstChild;re;re=re.nextSibling){var te,ye;switch(re.nodeName){case q[135]:te=L(re);break;case q[133]:ye=L(re);break;};};qe[te]=ye;break;default:var ue=we[ee.nodeName];if(ue){if(ue.length){for(var re=ee.firstChild;re;re=re.nextSibling){var ie=we[ee.nodeName+q[200]+re.nodeName];if(ie){qe[ie.proName]=kq.apply(ie.type,[re]);};};}else{qe[ue.proName]=kq.apply(ue.type,[ee]);};};};};e.taskCount++;if(qe.OutlineNumber){if(!qe.OutlineLevel){qe.OutlineLevel=qe.OutlineNumber==q[216]?0:qe.OutlineNumber.split(q[172]).length;};qe.OriginalLevel=qe.OutlineLevel;};return qe;},readResource:function(Mw){var e=this;if(!Mw){return null;};var qe=new hq();qe.node=Mw;var we=e.resourceReader;for(var ee=Mw.firstChild;ee;ee=ee.nextSibling){var re=we[ee.nodeName];if(re){qe[re.proName]=kq.apply(re.type,[ee]);};};if(qe.OutlineNumber){if(!qe.OutlineLevel){qe.OutlineLevel=qe.OutlineNumber==q[216]?0:qe.OutlineNumber.split(q[172]).length;};qe.OriginalLevel=qe.OutlineLevel;};return qe;},readLink:function(Mw){var e=this;if(!Mw){return null;};var qe=new fq();qe.node=Mw;var we=e.linkReader;for(var ee=Mw.firstChild;ee;ee=ee.nextSibling){var re=we[ee.nodeName];if(re){qe[re.proName]=kq.apply(re.type,[ee]);};};return qe;},readAssignment:function(Mw){var e=this;if(!Mw){return null;};var qe=new gq();qe.node=Mw;var we=e.assignmentReader;for(var ee=Mw.firstChild;ee;ee=ee.nextSibling){var re=we[ee.nodeName];if(re){qe[re.proName]=kq.apply(re.type,[ee]);};};return qe;},readTaskLink:function(Mw,qe){var e=this;if(!qe){return null;};var we=e.readLink(qe);we[qe.nodeName==q[132]?q[131]:q[130]]=Mw;return we;},readTaskAssignment:function(Mw,qe){var e=this;if(!qe){return null;};var we=e.readAssignment(qe);we.task=Mw;return we;},readResourceAssignment:function(Mw,qe){var e=this;if(!qe){return null;};var we=e.readAssignment(qe);we.resource=Mw;return we;},updateItem:function(Mw,qe,we,ee){var e=this;var re=Mw[we];if(re){var te=K(qe.node,re.tagName);if(!te){var ye=re.tagName.split(q[200]),ue=qe.node;for(var ie=0;ie<ye.length;ie++){if(!ye[ie]){continue;};te=K(ue,ye[ie]);if(!te){te=ue.ownerDocument.createElement(ye[ie]);ue.appendChild(te);};ue=te;};};lq.apply(re.type,[te,ee])};if(!Mw[we]&&e.extendedAttributes&&e.extendedAttributes[we]){for(var oe=qe.node.firstChild;oe;oe=oe.nextSibling){if(oe.nodeName!=q[134]){continue;};var pe=K(oe,q[135]);if(!pe||L(pe)!=we){continue;};var ae=K(oe,q[133]);if(!ae){ae=oe.ownerDocument.createElement(q[133]);oe.appendChild(ae);};lq.apply(jq.types.String,[ae,ee]);return;};var oe=qe.node.ownerDocument.createElement(q[134]);var pe=oe.ownerDocument.createElement(q[135]);lq.apply(jq.types.String,[pe,we]);oe.appendChild(pe);var ae=oe.ownerDocument.createElement(q[133]);lq.apply(jq.types.String,[ae,ee]);oe.appendChild(ae);};},updateTask:function(Mw,qe,we){var e=this;e.updateItem(e.taskWriter,Mw,qe,we);},updateLink:function(Mw,qe,we){var e=this;e.updateItem(e.linkWriter,Mw,qe,we);},updateResource:function(Mw,qe,we){var e=this;e.updateItem(e.resourceWriter,Mw,qe,we);},updateAssignment:function(Mw,qe,we){var e=this;e.updateItem(e.assignmentWriter,Mw,qe,we);}});function Yq(Mw,qe){var we=new Tq(qe);a(we,Yq.prototype);we.doc=we.loadUrl(Mw);we.addDefaultProperty();return we;};Mw(Yq.prototype,{loadUrl:function(Mw){var qe;function we(ee){qe=ee;};H(Mw,we,false);return qe;},getCalendar:function(){var e=this;var Mw;var qe=K(e.doc.documentElement,q[129]);if(qe){Mw=L(qe);var we=K(e.doc.documentElement,q[128]);for(var ee=we.firstChild;ee;ee=ee.nextSibling){if(L(K(ee,q[171]))==Mw){return e.readCalendar(ee);};};};return oq(q[175]);},readRootTask:function(){var e=this;var Mw=K(e.doc.documentElement,q[127]);if(!Mw){var qe=e.addTask();return qe;};return e.readTask(Mw);},readTaskFirstChild:function(Mw){var e=this;if(Mw.node.getAttribute(q[126])){var qe=e.loadUrl(Mw.node.getAttribute(q[126]));Mw.node.removeAttribute(q[126]);var we=K(Mw.node,q[125]);if(!we){we=Mw.node.ownerDocument.createElement(q[125]);Mw.node.appendChild(we);};while(qe.documentElement.firstChild){var ee=qe.documentElement.firstChild;qe.documentElement.removeChild(ee);we.appendChild(ee);};};return e.readTask(K(Mw.node,"Tasks/Task"));},readTaskNextSibling:function(Mw){var e=this;if(Mw.node.getAttribute(q[124])){var qe=e.loadUrl(Mw.node.getAttribute(q[124]));Mw.node.removeAttribute(q[124]);var we=K(Mw.getParentTask().node,q[125]);while(qe.documentElement.firstChild){var ee=qe.documentElement.firstChild;qe.documentElement.removeChild(ee);we.appendChild(ee);};};return e.readTask(Mw.node.nextSibling);},readRootResource:function(){var e=this;var Mw=K(e.doc.documentElement,q[123]);if(!Mw){var qe=e.addResource(q[216]);return qe;};return e.readResource(Mw);},readResourceFirstChild:function(Mw){var e=this;return e.readResource(K(Mw.node,"Resources/Resource"));},readResourceNextSibling:function(Mw){var e=this;return e.readResource(Mw.node.nextSibling);},readTaskFirstLink:function(Mw){var e=this;var qe,we=Mw.node;for(qe=we.firstChild;qe;qe=qe.nextSibling){if(qe.nodeName==q[132]||qe.nodeName==q[122]){break;}};if(qe==null){qe=K(we,q[121]);};return e.readTaskLink(Mw,qe);},readTaskNextLink:function(Mw,qe){var e=this;var we,ee=qe.node;for(we=ee.nextSibling;we;we=we.nextSibling){if(we.nodeName==q[132]||we.nodeName==q[122]){break;}};if(!we&&ee.parentNode.nodeName!=q[120]){we=K(ee,q[119]);};return e.readTaskLink(Mw,we);},readTaskFirstAssignment:function(Mw){var e=this;return e.readTaskAssignment(Mw,K(Mw.node,q[118]));},readTaskNextAssignment:function(Mw,qe){var e=this;return e.readTaskAssignment(Mw,qe.node.nextSibling)},readResourceFirstAssignment:function(Mw){var e=this;return e.readTaskAssignment(qe,K(qe.node,q[118]));},readResourceNextAssignment:function(Mw,qe){var e=this;return e.readTaskAssignment(we,qe.node.nextSibling)},updateTask:function(Mw,qe,we){var e=this;e.updateItem(e.taskWriter,Mw,qe,we);if(qe==q[159]){var parent=Mw.getParentTask(),ee=Mw.getPreviousSibling();Mw.node.parentNode.removeChild(Mw.node);var re=K(parent.node,q[125]);if(!re){re=parent.node.ownerDocument.createElement(q[125]);parent.node.appendChild(re);};if(ee){if(ee.node.nextSibling){re.insertBefore(Mw.node,ee.node.nextSibling);}else{re.appendChild(Mw.node);};}else{re.insertBefore(Mw.node,re.firstChild);};};},updateLink:function(Mw,qe,we){var e=this;e.updateItem(e.linkWriter,Mw,qe,we);},updateResource:function(Mw,qe,we){var e=this;e.updateItem(e.resourceWriter,Mw,qe,we);if(qe==q[159]){var parent=Mw.getParentResource(),ee=Mw.getPreviousSibling();Mw.node.parentNode.removeChild(Mw.node);var re=K(parent.node,q[117]);if(!re){re=parent.node.ownerDocument.createElement(q[117]);parent.node.appendChild(re);};if(ee){if(ee.node.nextSibling){re.insertBefore(Mw.node,ee.node.nextSibling);}else{re.appendChild(Mw.node);};}else{re.insertBefore(Mw.node,re.firstChild);};};},updateAssignment:function(Mw,qe,we){var e=this;e.updateItem(e.assignmentWriter,Mw,qe,we);},addTask:function(parent,Mw){var e=this;var qe=new dq();var we=parent.node.ownerDocument.createElement(q[127]);if(parent){var ee=K(parent.node,q[125]);if(!ee){ee=parent.node.ownerDocument.createElement(q[125]);parent.node.appendChild(ee);};if(Mw){if(Mw.node.nextSibling){ee.insertBefore(we,Mw.node.nextSibling);}else{ee.appendChild(we);};}else{ee.insertBefore(we,ee.firstChild);};}else{e.doc.documentElement.appendChild(we);};qe.node=we;return qe;},deleteTask:function(Mw){Mw.node.parentNode.removeChild(Mw.node);},addLink:function(Mw,qe,we){var ee=new fq();var re=Mw.node.ownerDocument;var te=re.createElement(q[132]);var ye=re.createElement(q[140]);Z(ye,qe.getProperty(q[171]));te.appendChild(ye);var ye=re.createElement(q[139]);Z(ye,we);te.appendChild(ye);ee.node=te;ee.Type=we;var ue=Mw.node.selectSingleNode(q[120]);if(!ue){ue=Mw.node.ownerDocument.createElement(q[120]);Mw.node.appendChild(ue);};ue.appendChild(te);return ee;},deleteLink:function(Mw){Mw.node.parentNode.removeChild(Mw.node);},addResource:function(parent,Mw){var qe=new hq();var we=parent.node.ownerDocument.createElement(q[123]);var ee=K(parent.node,q[117]);if(!ee){ee=parent.node.ownerDocument.createElement(q[117]);parent.node.appendChild(ee);};if(Mw){if(Mw.node.nextSibling){ee.insertBefore(we,Mw.node.nextSibling);}else{ee.appendChild(we);};}else{ee.insertBefore(we,ee.firstChild);};qe.node=we;return qe;},deleteResource:function(Mw){Mw.node.parentNode.removeChild(Mw.node);},addAssignment:function(Mw,qe,we){var e=this;var ee=new gq();var re=e.doc;var te=re.createElement(q[116]);var ye=re.createElement(q[138]);Z(ye,Mw.getProperty(q[171]));te.appendChild(ye);var ye=re.createElement(q[137]);Z(ye,qe.getProperty(q[171]));te.appendChild(ye);var ye=re.createElement(q[136]);Z(ye,we);te.appendChild(ye);ee.node=te;var ue=Mw.node.selectSingleNode(q[115]);if(!ue){ue=Mw.node.ownerDocument.createElement(q[115]);Mw.node.appendChild(ue);};ue.appendChild(te);return ee;},deleteAssignment:function(Mw){Mw.node.parentNode.removeChild(Mw.node);}});function Uq(Mw,qe){var we=new Tq(qe);a(we,Uq.prototype);a(we,{logging:{},ignoreLogTaskProperty:"ID,OutlineNumber,Collapse,Selected",ignoreLogLinkProperty:q[219],ignoreLogResourceProperty:q[170],ignoreLogAssignmentProperty:q[219]});we.clearLogging();we.doc=Mw;we.addDefaultProperty();we.addTaskProperty(q[142],'Baseline/Start',jq.types.Time);we.addTaskProperty(q[141],'Baseline/Finish',jq.types.Time);return we;};Mw(Uq.prototype,{loadXml:function(Mw){var e=this;if(Mw){e.doc=Mw;};Mw=e.doc;if(!Mw){e.doc=Mw=J();};if(!Mw.documentElement){Mw.appendChild(Mw.createElement("Project"));};var qe=e.doc.documentElement,we=qe.firstChild;while(we){switch(we.nodeName){case q[125]:e.tasksNode=we;break;case q[117]:e.resourcesNode=we;break;case q[115]:e.assignmentsNode=we;break;case"ExtendedAttributes":e.addExtendedAttributes(we);break;};we=we.nextSibling};e.loaded=true;},getCalendar:function(){var e=this;var Mw;var qe=K(e.doc.documentElement,q[129]);if(qe){Mw=L(qe);var we=K(e.doc.documentElement,q[128]);for(var ee=we.firstChild;ee;ee=ee.nextSibling){if(L(K(ee,q[171]))==Mw){return e.readCalendar(ee);};};};return oq(q[175]);},getTasksNode:function(){var e=this;if(!e.loaded){e.loadXml()};if(!e.tasksNode){e.tasksNode=e.doc.createElement(q[125]);e.doc.documentElement.appendChild(e.tasksNode);};return e.tasksNode;},getResourcesNode:function(){var e=this;if(!e.loaded){e.loadXml()};if(!e.resourcesNode){e.resourcesNode=e.doc.createElement(q[117]);e.doc.documentElement.appendChild(e.resourcesNode);};return e.resourcesNode;},getAssignmentsNode:function(){var e=this;if(!e.loaded){e.loadXml()};if(!e.assignmentsNode){e.assignmentsNode=e.doc.createElement(q[115]);e.doc.documentElement.appendChild(e.assignmentsNode);};return e.assignmentsNode;},getXml:function(){var e=this;return e.doc;},clearLinkNodes:function(Mw){for(var qe=Mw.firstChild;qe;){if(qe.nodeName==q[132]){var we=qe.previousSibling;if(!we){we=Mw.firstChild;};Mw.removeChild(qe);qe=we;};qe=qe.nextSibling;};return Mw;},getLoggingXml:function(){var e=this;var Mw=e.logging;var qe=J();var we=qe.createElement("Log");var ee=null;for(var re in Mw.updateTasks){var te=Mw.updateTasks[re];if(!ee){ee=qe.createElement("UpdateTasks");we.appendChild(ee);};var ye=[];for(var ue in te.logingFields){ye.push(ue);};var ie=qe.createElement("UpdateTask");var oe=qe.createElement(q[114]);oe.appendChild(qe.createTextNode(ye.join(q[215])));ie.appendChild(oe);var pe=qe.createElement(q[113]);pe.appendChild(e.clearLinkNodes(te.logingNode));ie.appendChild(pe);var ae=qe.createElement(q[112]);ae.appendChild(e.clearLinkNodes(te.node.cloneNode(true)));ie.appendChild(ae);ee.appendChild(ie);};var se=null;for(var de=0;de<Mw.addTasks.length;de++){var te=Mw.addTasks[de];if(!se){se=qe.createElement("AddTasks");we.appendChild(se);};var ie=qe.createElement(q[111]);ie.appendChild(e.clearLinkNodes(te.node.cloneNode(true)));se.appendChild(ie);};var fe=null;for(var de=0;de<Mw.deleteTasks.length;de++){var te=Mw.deleteTasks[de];if(!fe){fe=qe.createElement("DeleteTasks");we.appendChild(fe);};var ie=qe.createElement(q[110]);ie.appendChild(e.clearLinkNodes(te.node.cloneNode(true)));fe.appendChild(ie);};var ee=null;for(var re in Mw.updateLinks){var ge=Mw.updateLinks[re];if(!ee){ee=qe.createElement("UpdateLinks");we.appendChild(ee);};var ye=[];for(var ue in ge.logingFields){ye.push(ue);};var ie=qe.createElement("UpdateLink");var oe=qe.createElement(q[114]);oe.appendChild(qe.createTextNode(ye.join(q[215])));ie.appendChild(oe);var pe=qe.createElement(q[113]);var he=ge.logingNode;var je=he.ownerDocument.createElement(q[109]);je.appendChild(he.ownerDocument.createTextNode(ge.SuccessorTask.UID));he.appendChild(je);pe.appendChild(he);ie.appendChild(pe);var ae=qe.createElement(q[112]);var he=ge.node.cloneNode(true);var je=he.ownerDocument.createElement(q[109]);je.appendChild(he.ownerDocument.createTextNode(ge.SuccessorTask.UID));he.appendChild(je);ae.appendChild(he);ie.appendChild(ae);ee.appendChild(ie);};var se=null;for(var de=0;de<Mw.addLinks.length;de++){var ge=Mw.addLinks[de];if(!se){se=qe.createElement("AddLinks");we.appendChild(se);};var ie=qe.createElement("AddLink");var he=ge.node.cloneNode(true);var je=he.ownerDocument.createElement(q[109]);je.appendChild(he.ownerDocument.createTextNode(ge.SuccessorTask.UID));he.appendChild(je);ie.appendChild(he);se.appendChild(ie);};var fe=null;for(var de=0;de<Mw.deleteLinks.length;de++){var ge=Mw.deleteLinks[de];if(!fe){fe=qe.createElement("DeleteLinks");we.appendChild(fe);};var ie=qe.createElement("DeleteLink");var he=ge.node.cloneNode(true);var je=he.ownerDocument.createElement(q[109]);je.appendChild(he.ownerDocument.createTextNode(ge.SuccessorTask.UID));he.appendChild(je);ie.appendChild(he);fe.appendChild(ie);};var ee=null;for(var re in Mw.updateResources){var ke=Mw.updateResources[re];if(!ee){ee=qe.createElement("UpdateResources");we.appendChild(ee);};var ye=[];for(var ue in ke.logingFields){ye.push(ue);};var ie=qe.createElement("UpdateResource");var oe=qe.createElement(q[114]);oe.appendChild(qe.createTextNode(ye.join(q[215])));ie.appendChild(oe);var pe=qe.createElement(q[113]);pe.appendChild(ke.logingNode);ie.appendChild(pe);var ae=qe.createElement(q[112]);ae.appendChild(ke.node.cloneNode(true));ie.appendChild(ae);ee.appendChild(ie);};var se=null;for(var de=0;de<Mw.addResources.length;de++){var ke=Mw.addResources[de];if(!se){se=qe.createElement("AddResources");we.appendChild(se);};var ie=qe.createElement("AddResource");ie.appendChild(ke.node.cloneNode(true));se.appendChild(ie);};var fe=null;for(var de=0;de<Mw.deleteResources.length;de++){var ke=Mw.deleteResources[de];if(!fe){fe=qe.createElement("DeleteResources");we.appendChild(fe);};var ie=qe.createElement("DeleteResource");ie.appendChild(ke.node.cloneNode(true));fe.appendChild(ie);};var ee=null;for(var re in Mw.updateAssignments){var le=Mw.updateAssignments[re];if(!ee){ee=qe.createElement("UpdateAssignments");we.appendChild(ee);};var ye=[];for(var ue in le.logingFields){ye.push(ue);};var ie=qe.createElement("UpdateAssignment");var oe=qe.createElement(q[114]);oe.appendChild(qe.createTextNode(ye.join(q[215])));ie.appendChild(oe);var pe=qe.createElement(q[113]);pe.appendChild(le.logingNode);ie.appendChild(pe);var ae=qe.createElement(q[112]);ae.appendChild(le.node.cloneNode(true));ie.appendChild(ae);ee.appendChild(ie);};var se=null;for(var de=0;de<Mw.addAssignments.length;de++){var le=Mw.addAssignments[de];if(!se){se=qe.createElement("AddAssignments");we.appendChild(se);};var ie=qe.createElement("AddAssignment");ie.appendChild(le.node.cloneNode(true));se.appendChild(ie);};var fe=null;for(var de=0;de<Mw.deleteAssignments.length;de++){var le=Mw.deleteAssignments[de];if(!fe){fe=qe.createElement("DeleteAssignments");we.appendChild(fe);};var ie=qe.createElement("DeleteAssignment");ie.appendChild(le.node.cloneNode(true));fe.appendChild(ie);};qe.appendChild(we);return qe;},clearLogging:function(){var e=this;a(e.logging,{addTasks:[],updateTasks:{},deleteTasks:[],addLinks:[],updateLinks:{},deleteLinks:[],addResources:[],updateResources:{},deleteResources:[],addAssignments:[],updateAssignments:{},deleteAssignments:[]});},readRootTask:function(){var e=this;var Mw=e.getTasksNode().firstChild;if(!Mw){var qe=e.addTask();return qe;};return e.readTask(Mw);},readTaskFirstChild:function(Mw){var e=this;var qe=Mw.OriginalLevel;var we=Mw.node.nextSibling;if(we){var ee=K(we,q[166])?L(K(we,q[166])):L(K(we,q[159])).split(q[172]).length;if(ee>qe){return e.readTask(we);};};return null;},readTaskNextSibling:function(Mw){var e=this;var qe=Mw.OriginalLevel;for(var we=Mw.node.nextSibling;we;we=we.nextSibling){var ee=K(we,q[166])?L(K(we,q[166])):L(K(we,q[159])).split(q[172]).length;if(ee>qe){continue;};if(ee==qe){return e.readTask(we);};break;};return null;},readRootResource:function(){var e=this;var Mw=e.getResourcesNode().firstChild;if(!Mw){var qe=e.addResource(q[216]);return qe;};return e.readResource(Mw);},readResourceFirstChild:function(Mw){var e=this;if(Mw.node!=e.getResourcesNode().firstChild){return null;};var qe=Mw.node.nextSibling;return e.readResource(qe);},readResourceNextSibling:function(Mw){var e=this;if(Mw.node==e.getResourcesNode().firstChild){return null;};var qe=Mw.node.nextSibling;return e.readResource(qe);},readTaskFirstLink:function(Mw){var e=this;var qe,we=Mw.node;for(qe=we.firstChild;qe;qe=qe.nextSibling){if(qe.nodeName==q[132]||qe.nodeName==q[122]){break;}};if(qe==null){qe=K(we,q[121]);};return e.readTaskLink(Mw,qe);},readTaskNextLink:function(Mw,qe){var e=this;var we,ee=qe.node;for(we=ee.nextSibling;we;we=we.nextSibling){if(we.nodeName==q[132]||we.nodeName==q[122]){break;}};if(!we&&ee.parentNode.nodeName!=q[120]){we=K(ee,q[119]);};return e.readTaskLink(Mw,we);},readTaskFirstAssignment:function(Mw){var e=this;var qe=Mw.UID;for(var we=e.getAssignmentsNode().firstChild;we;we=we.nextSibling){if(L(K(we,q[138]))==qe){return e.readTaskAssignment(Mw,we);};};return null;},readTaskNextAssignment:function(Mw,qe){var e=this;var we=Mw.UID;for(var ee=qe.node.nextSibling;ee;ee=ee.nextSibling){if(L(K(ee,q[138]))==we){return e.readTaskAssignment(Mw,ee);};};return null;},readResourceFirstAssignment:function(Mw){var e=this;var qe=Mw.UID;for(var we=e.getAssignmentsNode().firstChild;we;we=we.nextSibling){if(L(K(we,q[137]))==qe){return e.readResourceAssignment(Mw,we);};};return null;},readResourceNextAssignment:function(Mw,qe){var e=this;var we=Mw.UID;for(var ee=qe.node.nextSibling;ee;ee=ee.nextSibling){if(L(K(ee,q[137]))==we){return e.readResourceAssignment(Mw,ee);};};return null;},setIgnoreTaskLogProperty:function(Mw){var e=this;e.ignoreLogTaskProperty=Mw;},setIgnoreLinkLogProperty:function(Mw){var e=this;e.ignoreLogLinkProperty=Mw;},setIgnoreResourceLogProperty:function(Mw){var e=this;e.ignoreLogResourceProperty=Mw;},setIgnoreAssignmentLogProperty:function(Mw){var e=this;e.ignoreLogAssignmentProperty=Mw;},checkLogProperty:function(Mw,qe){var we=qe.split(q[215]);for(var ee=0;ee<we.length;ee++){if(we[ee]==Mw){return false;};};return true;},updateTask:function(Mw,qe,we){var e=this;var ee=e.logging;if(ee&&!Mw.logingNew&&e.checkLogProperty(qe,e.ignoreLogTaskProperty)){if(!ee.updateTasks[Mw.UID]){ee.updateTasks[Mw.UID]=Mw;Mw.logingNode=Mw.node.cloneNode(true);Mw.logingFields={};};Mw.logingFields[qe]=true;};e.updateItem(e.taskWriter,Mw,qe,we);if(qe==q[159]){var re=Mw.node,te=Mw.getPreviousTask().node;if(re.previousSibling!=te){re.parentNode.removeChild(re);if(te.nextSibling){te.parentNode.insertBefore(re,te.nextSibling);}else{te.parentNode.appendChild(re);};};};},updateLink:function(Mw,qe,we){var e=this;var ee=e.logging;if(ee&&!Mw.logingNew&&e.checkLogProperty(qe,e.ignoreLogLinkProperty)){if(!ee.updateLinks[Mw.getPredecessorTask().UID+q[108]+Mw.getSuccessorTask().UID]){ee.updateLinks[Mw.getPredecessorTask().UID+q[108]+Mw.getSuccessorTask().UID]=Mw;Mw.logingNode=Mw.node.cloneNode(true);Mw.logingFields={};};Mw.logingFields[qe]=true;};e.updateItem(e.linkWriter,Mw,qe,we);},updateResource:function(Mw,qe,we){var e=this;var ee=e.logging;if(ee&&!Mw.logingNew&&e.checkLogProperty(qe,e.ignoreLogResourceProperty)){if(!ee.updateResources[Mw.UID]){ee.updateResources[Mw.UID]=Mw;Mw.logingNode=Mw.node.cloneNode(true);Mw.logingFields={};};Mw.logingFields[qe]=true;};e.updateItem(e.resourceWriter,Mw,qe,we);},updateAssignment:function(Mw,qe,we){var e=this;var ee=e.logging;if(ee&&!Mw.logingNew&&e.checkLogProperty(qe,e.ignoreLogAssignmentProperty)){if(!ee.updateAssignments[Mw.getTask().UID+q[108]+Mw.getResource().UID]){ee.updateAssignments[Mw.getTask().UID+q[108]+Mw.getResource().UID]=Mw;Mw.logingNode=Mw.node.cloneNode(true);Mw.logingFields={};};Mw.logingFields[qe]=true;};e.updateItem(e.assignmentWriter,Mw,qe,we);},addTask:function(parent,Mw){var e=this;var qe=new dq();var we=e.getTasksNode();var ee=we.ownerDocument.createElement(q[127]);if(parent){var re=Mw?Mw.node:parent.node;if(re.nextSibling){we.insertBefore(ee,re.nextSibling);}else{we.appendChild(ee);};}else{we.insertBefore(ee,we.firstChild);};qe.node=ee;var te=e.logging;if(te){qe.logingNew=true;te.addTasks.push(qe);};return qe;},deleteTask:function(Mw){var e=this;Mw.node.parentNode.removeChild(Mw.node);var qe=e.logging;if(qe){if(Mw.logingNew){for(var we=qe.addTasks.length;we>=0;we--){if(qe.addTasks[we]==Mw){qe.addTasks.splice(we,0);break;};};};qe.updateTasks[Mw.UID]=null;delete qe.updateTasks[Mw.UID];qe.deleteTasks.push(Mw);};},addLink:function(Mw,qe,we){var e=this;var ee=new fq();var re=Mw.node.ownerDocument;var te=re.createElement(q[132]);var ye=re.createElement(q[140]);Z(ye,qe.getProperty(q[171]));te.appendChild(ye);var ye=re.createElement(q[139]);Z(ye,we);te.appendChild(ye);ee.node=te;ee.Type=we;Mw.node.appendChild(te);var ue=e.logging;if(ue){ee.logingNew=true;ue.addLinks.push(ee);};return ee;},deleteLink:function(Mw){var e=this;Mw.node.parentNode.removeChild(Mw.node);var qe=e.logging;if(qe){if(Mw.logingNew){for(var we=qe.addLinks.length;we>=0;we--){if(qe.addLinks[we]==Mw){qe.addLinks.splice(we,0);break;};};};qe.updateLinks[Mw.PredecessorTask.UID+q[108]+Mw.SuccessorTask.UID]=null;delete qe.updateLinks[Mw.PredecessorTask.UID+q[108]+Mw.SuccessorTask.UID];qe.deleteLinks.push(Mw);};},addResource:function(parent,Mw){var e=this;var qe=new hq();var we=e.getResourcesNode();var ee=we.ownerDocument.createElement(q[123]);var re=te?te.node:parent.node;if(re.nextSibling){we.insertBefore(ee,re.nextSibling);}else{we.appendChild(ee);};qe.node=ee;var ye=e.logging;if(ye){qe.logingNew=true;ye.addResources.push(qe);};return qe;},deleteResource:function(Mw){var e=this;Mw.node.parentNode.removeChild(Mw.node);var qe=e.logging;if(qe){if(Mw.logingNew){for(var we=qe.addResources.length;we>=0;we--){if(qe.addResources[we]==Mw){qe.addResources.splice(we,0);break;};};};qe.updateResources[ee.getTask().UID+q[108]+ee.getResource().UID]=null;delete qe.updateResources[ee.getTask().UID+q[108]+ee.getResource().UID];qe.deleteResources.push(Mw);};},addAssignment:function(Mw,qe,we){var e=this;var ee=new gq();var re=e.doc;var te=re.createElement(q[116]);var ye=re.createElement(q[138]);Z(ye,Mw.getProperty(q[171]));te.appendChild(ye);var ye=re.createElement(q[137]);Z(ye,qe.getProperty(q[171]));te.appendChild(ye);var ye=re.createElement(q[136]);Z(ye,we);te.appendChild(ye);ee.node=te;e.getAssignmentsNode().appendChild(te);var ue=e.logging;if(ue){ee.logingNew=true;ue.addAssignments.push(ee);};return ee;},deleteAssignment:function(Mw){var e=this;Mw.node.parentNode.removeChild(Mw.node);var qe=e.logging;if(qe){if(Mw.logingNew){for(var we=qe.addAssignments.length;we>=0;we--){if(qe.addAssignments[we]==Mw){qe.addAssignments.splice(we,0);break;};};};qe.updateAssignments[Mw.getTask().UID+q[108]+(Mw.getResource()?Mw.getResource().UID:q[107])]=null;delete qe.updateAssignments[Mw.getTask().UID+q[108]+(Mw.getResource()?Mw.getResource().UID:q[107])];qe.deleteAssignments.push(Mw);};}});function Iq(Mw,qe){var e=this;Mw=Mw?Mw:new B();e.config=Mw;M(e,Mw.getConfigObj("SFGantt"));var we=e.container;we=(typeof(we)==q[199])?we:document.getElementById(we);e.container=we;var ee=we.style;if(ee.position!=q[193]&&ee.position!=q[202]){ee.position=q[202];};a(e,{container:we,loaded:false,config:Mw});e.contextMenuItems=[];e.addMenuItems();if(qe){e.setData(qe);};};Mw(Iq.prototype,{createDivs:function(){var e=this;a(e.container.style,{backgroundColor:e.bodyBgColor,fontSize:e.fontSize+q[190]});rq(e.container,z(e,function(){var e=this;return e.showMenu()}));var Mw=document.createElement(q[181]);e.barDiv=Mw;a(Mw.style,{position:q[193],zIndex:200,top:q[106],width:q[186],height:q[105],backgroundColor:e.columnBarColor,borderLeft:q[104]+e.borderColor,borderRight:q[104]+e.borderColor});h(Mw,q[103]);m(Mw,q[191],e,e.onColumnMouseDown);var qe=document.createElement(q[197]);a(qe.style,{position:q[193],zIndex:200,top:q[186],left:'2px',width:q[102],height:q[101]});h(qe,q[210]);wq(qe,e.imgPath+"column_left"+e.imgType);e.listColImg=qe;m(qe,q[191],e,e.collapseList);Mw.appendChild(qe);var qe=document.createElement(q[197]);a(qe.style,{position:q[193],zIndex:200,top:'18px',left:q[102],width:q[102],height:q[101]});h(qe,q[210]);wq(qe,e.imgPath+"column_right"+e.imgType);e.mapColImg=qe;m(qe,q[191],e,e.collapseMap);Mw.appendChild(qe);rq(Mw,z(e,function(){var e=this;return e.showMenu(q[100])}));e.container.appendChild(Mw);e.headDiv=document.createElement(q[181]);a(e.headDiv.style,{position:q[193],zIndex:100,left:q[106],top:q[106],width:q[105],height:e.headHeight+q[190],backgroundColor:e.headBgColor});var we=document.createElement(q[197]);a(we,{title:'SFGantt Logo',border:q[216]});a(we.style,{position:q[193],width:e.idCellWidth+q[190],height:e.headHeight+q[190]});wq(we,e.imgPath+q[99]+e.imgType);e.headDiv.appendChild(we);rq(we,z(e,function(){var e=this;return e.showMenu(q[99])}));e.taskFieldsDiv=document.createElement(q[181]);a(e.taskFieldsDiv.style,{position:q[193],top:q[106],left:e.idCellWidth+q[190],height:e.headHeight+q[190],overflow:q[98],borderLeft:q[104]+e.borderColor});h(e.taskFieldsDiv,q[184]);e.headDiv.appendChild(e.taskFieldsDiv);A(e.taskFieldsDiv);e.mapHeadDiv=document.createElement(q[181]);a(e.mapHeadDiv.style,{position:q[193],top:q[106],height:e.headHeight+q[190],top:q[106],left:q[106],width:q[105],overflowX:q[98],borderLeft:q[104]+e.borderColor,borderRight:q[104]+e.borderColor});e.headDiv.appendChild(e.mapHeadDiv);var ee=document.createElement(q[181]);a(ee.style,{position:q[193],width:q[97],right:q[106],top:q[106],textAlign:q[96],padding:q[95]});var re=document.createElement(q[94]);a(re.style,{fontSize:'24px',color:q[93],textDecoration:q[92]});re.appendChild(document.createTextNode("?"));re.title=SFNS.vinfo?g(d(SFNS.vinfo.time),q[218]):q[219];a(re,{href:q[91],target:q[90]});ee.appendChild(re);e.headDiv.appendChild(ee);e.container.appendChild(e.headDiv);e.bodyScrollDiv=document.createElement(q[181]);a(e.bodyScrollDiv.style,{position:q[193],zIndex:100,overflowY:q[89],left:q[106],top:e.headHeight+q[190],width:q[105],height:(e.container.offsetHeight-e.headHeight-e.footHeight)+q[190]});e.bodyDiv=document.createElement(q[181]);e.listIdDiv=document.createElement(q[181]);a(e.listIdDiv.style,{position:q[193],width:e.idCellWidth+q[190],overflow:q[98]});e.bodyDiv.appendChild(e.listIdDiv);e.listBodyDiv=document.createElement(q[181]);a(e.listBodyDiv.style,{position:q[193],left:e.idCellWidth+q[190],overflow:q[98]});e.bodyDiv.appendChild(e.listBodyDiv);e.mapBodyDiv=document.createElement(q[181]);A(e.mapBodyDiv);rq(e.mapBodyDiv,z(e,function(){var e=this;return e.showMenu(q[88])}));a(e.mapBodyDiv.style,{position:q[193],overflow:q[98]});e.bodyDiv.appendChild(e.mapBodyDiv);e.bodyScrollDiv.appendChild(e.bodyDiv);e.container.appendChild(e.bodyScrollDiv);e.footDiv=document.createElement(q[181]);a(e.footDiv.style,{position:q[193],zIndex:100,left:q[106],bottom:q[106],width:q[105],height:e.footHeight+q[190],backgroundColor:e.bottomBgColor});e.listFootDiv=document.createElement(q[181]);a(e.listFootDiv.style,{position:q[193],left:q[106],height:q[105],bottom:q[106],fontSize:q[106],overflow:q[98]});e.footDiv.appendChild(e.listFootDiv);e.mapFootDiv=document.createElement(q[181]);a(e.mapFootDiv.style,{position:q[193],height:q[105],bottom:q[106],fontSize:q[106],overflow:q[98]});e.footDiv.appendChild(e.mapFootDiv);var te=document.createElement(q[197]);wq(te,e.imgPath+q[87]+e.imgType);a(te.style,{position:q[193],height:q[105],width:q[97],right:q[106],bottom:q[106]});h(te,'se-resize');m(te,q[191],e,e.onResizeMouseDown);e.footDiv.appendChild(te);e.container.appendChild(e.footDiv);m(window,"beforeprint",e,e.onPrintStart);m(e.container,q[87],e,e.onResize);m(window,q[87],e,e.onResize);},onPrintStart:function(){var e=this;e.bodyScrollDiv.style.overflow=q[98];e.bodyDiv.style.position=q[202];e.bodyDiv.style.top=-e.bodyScrollDiv.scrollTop+q[190];e.mapHeadDiv.style.overflow=q[98];e.psl=m(window,"afterprint",e,e.onPrintEnd);},onPrintEnd:function(){var e=this;e.bodyScrollDiv.style.overflow=q[219];e.bodyDiv.style.position='static';e.bodyDiv.style.top=q[106];e.mapHeadDiv.style.overflow=q[219];E(e.psl);},addMenuItems:function(){var e=this;e.addContextMenuItem(function(Mw){return(Mw.type==q[88])?1:0},function(Mw){Mw.gantt.zoomIn();},w('eNGZoomIn',r),e.imgPath+'icon_zoomin'+e.imgType,"ZoomIn",551);e.addContextMenuItem(function(Mw){return(Mw.type==q[88])?1:0},function(Mw){Mw.gantt.zoomOut();},w('eNGZoomOut',r),e.imgPath+'icon_zoomout'+e.imgType,"ZoomOut",556);e.addContextMenuItem(function(Mw){return(Mw.type==q[86]&&Mw.gantt.getFocusTask())?1:0},function(Mw){Mw.gantt.focusIntoView();},w('eNGGo to Task',r),e.imgPath+'icon_taskgoto'+e.imgType,"FocusIntoView",601);e.addContextMenuItem(function(Mw){return(Mw.type==q[86]&&!Mw.gantt.readOnly&&!Mw.gantt.disableAddTask)?1:0},function(Mw){Mw.gantt.addTask();},w('ENGNew Task',r),null,q[111],651);e.addContextMenuItem(function(Mw){return(Mw.type==q[86]&&!Mw.gantt.readOnly&&!Mw.gantt.disableDeleteTask&&Mw.gantt.getFocusTask())?1:0},function(Mw){Mw.gantt.deleteTask();},w('eNGDelete task',r),null,q[110],656);e.addContextMenuItem(function(Mw){return(Mw.type==q[86]&&!Mw.gantt.readOnly&&!Mw.gantt.disableAddLink&&Mw.gantt.getSelectedTasks().length>1)?1:0},function(Mw){Mw.gantt.addTasksLinks();},w('eNGMission link',r),null,"AddTasksLinks",701);e.addContextMenuItem(function(Mw){return(Mw.type==q[86]&&!Mw.gantt.readOnly&&!Mw.gantt.disableDeleteLink&&Mw.gantt.getSelectedTasks().length>1)?1:0},function(Mw){Mw.gantt.removeTasksLinks();},w('eNGRemoveTasks Links',r),null,'RemoveTasksLinks',706);e.addContextMenuItem(function(Mw){return(Mw.type==q[86]&&!Mw.gantt.readOnly&&!Mw.gantt.disableUpdateTask&&Mw.gantt.getFocusTask())?1:0},function(Mw){Mw.gantt.upgradeTask();},w('eNGUpgrade Task',r),null,'UpgradeTask',751);e.addContextMenuItem(function(Mw){return(Mw.type==q[86]&&!Mw.gantt.readOnly&&!Mw.gantt.disableUpdateTask&&Mw.gantt.getFocusTask())?1:0},function(Mw){Mw.gantt.degradeTask();},w('eNGDegradeTask',r),null,'DegradeTask',756);e.addContextMenuItem(function(Mw){return(Mw.type==q[100]&&Mw.gantt.mapBodyDiv.style.display==q[92])?1:0},function(Mw){Mw.gantt.collapseMap();},w('eNGShowMap',r),null,'ShowMap',801);e.addContextMenuItem(function(Mw){return(Mw.type==q[100]&&Mw.gantt.mapBodyDiv.style.display!=q[92])?1:0},function(Mw){Mw.gantt.collapseMap();},w('eNGHide Map',r),null,'HideMap',806);e.addContextMenuItem(function(Mw){return(Mw.type==q[100]&&Mw.gantt.listBodyDiv.style.display==q[92])?1:0},function(Mw){Mw.gantt.collapseList();},w('eNGShow List',r),null,'ShowList',850);e.addContextMenuItem(function(Mw){return(Mw.type==q[100]&&Mw.gantt.listBodyDiv.style.display!=q[92])?1:0},function(Mw){Mw.gantt.collapseList();},w('eNGHide List',r),null,'HideList',856);e.addContextMenuItem(function(Mw){return(Mw.type==q[99])?1:0},function(Mw){window.open(q[91]);},w('eNGHelp',r),null,'Help',901);e.addContextMenuItem(function(Mw){return(Mw.type==q[99])?1:0},function(Mw){window.open(w("eNGhttp://www.51diaodu.cn/sfgantt/",r));},w('eNGAbout',r),null,'About',951);},onColumnResize:function(){var e=this;var Mw=10,qe=0,we=e.idCellWidth;e.listBodyDiv.style.display=e.listHidden?q[92]:q[219];e.taskFieldsDiv.style.display=e.listHidden?q[92]:q[219];e.listFootDiv.style.display=e.listHidden?q[92]:q[219];e.mapBodyDiv.style.display=e.mapHidden?q[92]:q[219];e.mapHeadDiv.style.display=e.mapHidden?q[92]:q[219];e.mapFootDiv.style.display=e.mapHidden?q[92]:q[219];if(e.listHidden){ee=0;}else if(e.mapHidden){ee=e.bodyScrollDiv.clientWidth-e.idCellWidth-Mw;}else{ee=e.listWidth,ee=Math.max(ee,10);};var re=e.bodyScrollDiv.clientWidth-ee-e.idCellWidth-Mw;if(re-qe<10){ee+=re-qe-10;re=10+qe;};e.barDiv.style.left=ee+we+q[190];if(!e.listHidden){e.taskFieldsDiv.style.width=ee+q[190];e.listFootDiv.style.width=ee+we+q[190];e.listBodyDiv.style.width=ee+q[190];};if(!e.mapHidden){e.mapHeadDiv.style.left=we+ee+Mw+q[190];e.mapHeadDiv.style.width=re-qe+q[190];e.mapBodyDiv.style.left=ee+Mw+we+q[190];e.mapBodyDiv.style.width=re-qe+q[190];e.mapFootDiv.style.left=ee+Mw+we+q[190];e.mapFootDiv.style.width=re-qe+q[190];};Y(e,q[87],[we,ee,Mw,re]);},getItemHeight:function(Mw){var e=this;var qe=Mw.getProperty(q[144]);return qe?qe:e.itemHeight;},setBodyHeight:function(){var e=this;var Mw=e.bodyHeight+e.bodyScrollDiv.clientHeight/2;e.mapBodyDiv.style.height=Mw+q[190];Y(e,"heightchange",[Mw]);},onResize:function(){var e=this;e.bodyScrollDiv.style.height=(e.container.offsetHeight-e.headHeight-e.footHeight)+q[190];e.onColumnResize();e.showViewTasks();},collapseList:function(){var e=this;if(!e.listHidden&&e.mapHidden){e.collapseMap();};e.listHidden=!e.listHidden;e.onCollapse();},collapseMap:function(){var e=this;if(!e.mapHidden&&e.listHidden){e.collapseList();};e.mapHidden=!e.mapHidden;e.onCollapse();},onCollapse:function(){var e=this;wq(e.listColImg,e.imgPath+q[85]+(e.listHidden?q[96]:q[84])+e.imgType);wq(e.mapColImg,e.imgPath+q[85]+(e.mapHidden?q[84]:q[96])+e.imgType);e.onColumnResize();},getDragObject:function(Mw){var e=this;b(Mw);if(e.dragObj){e.onDragEnd(Mw);};if(e.container.setCapture){e.container.setCapture();};return e.dragObj={ml:m(document,q[183],e,e.onDrag),ul:m(document,q[83],e,e.onDragEnd),start:I(Mw,e.container),startSize:[e.container.offsetWidth,e.container.offsetHeight]};},onColumnMouseDown:function(Mw){var e=this;var qe=e.getDragObject(Mw);qe.type=q[100];qe.startColumn=e.listWidth;},onResizeMouseDown:function(Mw){var e=this;var qe=e.getDragObject(Mw);qe.type=q[87];qe.startSize=[e.container.offsetWidth,e.container.offsetHeight];Y(e,q[82],[]);},onDrag:function(Mw){var e=this;b(Mw);if(!e.dragObj){return;};var qe=e.dragObj;var we=I(Mw,e.container);switch(qe.type){case q[87]:e.resizeTo([qe.startSize[0]+we[0]-qe.start[0],qe.startSize[1]+we[1]-qe.start[1]]);break;case q[100]:e.listWidth=qe.startColumn+we[0]-qe.start[0];e.listWidth=Math.max(e.listWidth,20);e.listWidth=Math.min(e.listWidth,e.bodyScrollDiv.clientWidth-e.idCellWidth-10-50);e.barDiv.style.left=e.listWidth+e.idCellWidth+q[190];break;};},onDragEnd:function(Mw){var e=this;b(Mw);if(!e.dragObj){return;};var qe=e.dragObj;switch(qe.type){case q[87]:Y(e,q[81],[]);break;case q[100]:e.onColumnResize();break;};E(qe.ml);E(qe.sl);if(document.releaseCapture){document.releaseCapture();};e.dragObj=null;},resizeTo:function(Mw){var e=this;if(e.maxSize){Mw[0]=Math.min(Mw[0],e.maxSize[0]);Mw[1]=Math.min(Mw[1],e.maxSize[1]);};Mw[0]=Math.max(Mw[0],100);Mw[1]=Math.max(Mw[1],100);a(e.container.style,{width:Mw[0]+q[190],height:Mw[1]+q[190]});e.onResize();},setMaxSize:function(Mw){var e=this;e.maxSize=Mw;},onColumnResizeEnd:function(){var e=this;e.timeScroller.onResize();e.divScroller.onResize();},init:function(){var e=this;e.createDivs();e.onColumnResize();e.taskFields=Bq(e.taskFieldNames.split(q[215]));var Mw=e.contextMenuItems;e.timeScroller=new Fq(e.mapFootDiv,e.imgPath,e.imgType,e);e.divScroller=new Dq(e.listFootDiv,e.imgPath,e.imgType,e.taskFieldsDiv);var qe=new Pq(e,e.mapBodyDiv);if(e.isTracking){var qe=new Pq(e,e.mapBodyDiv,true);};var we=new Aq(e,e.mapBodyDiv);var ee=new Cw(e,e.mapBodyDiv);var re=new Bw(e,e.mapBodyDiv,e.data.getCalendar());var te=new Cq(e,e.taskFieldsDiv,e.taskFields);var ye=new Oq({gantt:e,container:e.listBodyDiv,fields:e.taskFields,head:te,bgColor:e.bodyBgColor,disableAdjustLineHeight:true});var ue=new Oq({gantt:e,container:e.listIdDiv,fields:Bq(e.taskIdFieldNames.split(q[215])),bgColor:e.idCellBgColor,dragOrder:ye});var ie=new Lq(e,e.mapHeadDiv);var oe=new Gq(e,e.container);var oe=new Hq(e,e.container);m(e.listBodyDiv,q[87],e,function(){var e=this;e.divScroller.onResize()});m(e.bodyScrollDiv,q[89],e,e.onScroll);Y(e,"init",[]);e.heightSpan=[0,0];e.bodyHeight=0;e.setBodyHeight();e.viewTasks=[];e.selectedTasks=[];e.showViewTasks();e.onColumnResize();},addTimeLine:function(Mw,qe,we){var e=this;var ee=new Vw(e,e.mapBodyDiv,Mw,qe,we);},setData:function(Mw){var e=this;e.data=Mw;M(Mw,e.config.getConfigObj(q[174]));m(Mw,q[158],e,e.onTaskUpdate);m(Mw,q[165],e,e.onTaskAdd);m(Mw,q[164],e,e.onTaskDelete);m(Mw,q[163],e,e.onTaskMove);m(Mw,q[157],e,e.onLinkUpdate);m(Mw,q[162],e,e.onLinkAdd);m(Mw,q[161],e,e.onLinkDelete);},onTaskUpdate:function(Mw,qe,we,ee){var e=this;if(!e.loaded){return;};for(var re=0;re<qe.length;re++){var te=qe[re];if(te==q[145]){var ye=Mw.Collapse;e.hideTasks(Mw,ye,0);e.showViewTasks(!ye);e.setBodyHeight();break;};if(te==q[144]&&Mw.drawObj){if(Mw.drawObj&&Mw.drawObj.view){e.bodyHeight-=Mw.drawObj.height;};e.outViewTask(e.getViewIndex(Mw),false);Mw.drawObj=null;e.showViewTasks(true);e.setBodyHeight();};};if(!e.getTaskDrawObj(Mw).draw){return};Y(e,q[80],[Mw,qe]);},onTaskAdd:function(Mw){var e=this;if(!e.loaded){return;};if(e.viewTasks[0]&&e.data.compareTask(Mw,e.viewTasks[0])>0){e.heightSpan[0]+=e.getItemHeight(Mw);e.heightSpan[1]+=e.getItemHeight(Mw);};e.showViewTasks(true);e.setBodyHeight();},onTaskDelete:function(Mw,qe){var e=this;if(!e.loaded){return;};if(e.viewTasks[0]&&e.data.compareTask(Mw,e.viewTasks[0])>=0){e.heightSpan[0]-=e.getTaskDrawObj(Mw).height;e.heightSpan[1]-=e.getTaskDrawObj(Mw).height;};if(e.isTaskSelected(Mw)){e.removeSelectedTask(Mw);};if(e.getTaskDrawObj(Mw).draw){e.outViewTask(e.getViewIndex(Mw),true)};if(e.getTaskDrawObj(Mw).view){e.bodyHeight-=e.getItemHeight(Mw)};Mw.drawObj=null;if(qe==0){e.showViewTasks();};e.setBodyHeight();},onTaskMove:function(Mw,qe){var e=this;e.outViewTask(e.getViewIndex(Mw),true);Mw.drawObj=null;if(qe==0){e.showViewTasks(true);};},onLinkUpdate:function(Mw){var e=this;if(!e.loaded){return;};Y(e,q[79],[Mw]);},onLinkAdd:function(Mw){var e=this;if(!e.loaded){return;};Y(e,q[78],[Mw]);},onLinkDelete:function(Mw){var e=this;if(!e.loaded){return;};Y(e,q[77],[Mw]);},showMap:function(Mw,qe){var e=this;if(!e.loaded){e.init();e.loaded=true;};if(!Mw){var we=e.data.getRootTask();if(we){Mw=we.Start;};};e.startTime=Mw?Mw:new Date();e.zoomTo(qe?qe:8);e.moveTo(e.startTime);},onScroll:function(Mw){var e=this;b(Mw);var qe=e.scrollObj?e.scrollObj:e.getScrollObj();var we=e.bodyScrollDiv;var ee=we.scrollTop;e.updateScrollTask(qe,1,ee);e.updateScrollTask(qe,3,ee+we.clientHeight*1.5);if(qe.timeout){window.clearTimeout(qe.timeout);};Y(e,q[89],[ee,qe]);qe.timeout=window.setTimeout(z(e,function(){var e=this;e.scrollObj=null;e.showViewTasks()}),200);},updateScrollTask:function(Mw,qe,we){var e=this;var ee=Mw.spanTasks[qe];var re=we-Mw.spanHeights[qe];var te=re>0;while(ee){if(te){if(re<e.getItemHeight(ee)){break;};var ye=ee.getNextViewTask();if(!ye){break;};e.getTaskDrawObj(ye);ee=ye;re-=e.getItemHeight(ee);}else{if(re>0){break;};var ye=ee.getPreviousViewTask();if(!ye){break;};e.getTaskDrawObj(ye);ee=ye;re+=e.getItemHeight(ye);};};Mw.spanHeights[qe]=we-re;Mw.spanTasks[qe]=ee;},getScrollObj:function(){var e=this;var Mw=e.viewTasks[0],qe=e.heightSpan[0];return{spanTasks:[Mw,Mw,Mw,Mw],spanHeights:[qe,qe,qe,qe]};},inViewTask:function(Mw,qe){var e=this;if(qe<0){e.viewTasks.push(Mw);qe=e.viewTasks.length-1;}else{e.viewTasks.splice(qe,0,Mw);};if(e.viewTasks[1]){if(qe==0){e.heightSpan[0]-=e.getItemHeight(Mw);}else{e.heightSpan[1]+=e.getItemHeight(Mw);};};Y(e,q[76],[Mw,qe]);e.getTaskDrawObj(Mw).draw=true;if(e.isTaskSelected(Mw)){e.setTaskSelected(Mw,true);};},outViewTask:function(Mw,qe){var e=this;if(Mw<0){Mw=e.viewTasks.length-1};if(Mw<0){return;};we=e.viewTasks.splice(Mw,1)[0];if(e.isTaskSelected(we)){e.setTaskSelected(we,false);};if(Mw==0){e.heightSpan[0]+=e.getTaskDrawObj(we).height;}else{e.heightSpan[1]-=e.getTaskDrawObj(we).height;};Y(e,q[75],[we,Mw,qe]);e.getTaskDrawObj(we).draw=false;},getViewIndex:function(Mw){var e=this;for(var qe=e.viewTasks.length-1;qe>=0;qe--){if(Mw==e.viewTasks[qe]){return qe;};};return-1;},getViewTop:function(){var e=this;return e.heightSpan[0];},showViewTasks:function(Mw){var e=this;var qe=512;var we=e.bodyScrollDiv.scrollTop;var ee=we+e.bodyScrollDiv.clientHeight+20;if(Mw&&e.viewTasks.length>1){var re=e.heightSpan[0];var te=0;for(var ye=0;ye<e.viewTasks.length-1;ye++){var ue=e.viewTasks[ye],ie=e.viewTasks[ye+1];if(ue.getNextViewTask()!=ie){for(var oe=ue.getNextViewTask();oe&&oe!=ie;oe=oe.getNextViewTask()){re+=e.getItemHeight(oe);e.inViewTask(oe,ye+(++te));if(re>ee){break;};};ye+=te;te=0;}else{re+=e.getItemHeight(ue);};if(re>ee){e.removeViewTasks(ye+te);e.heightSpan[1]=re;break;};};};while(e.viewTasks[0]&&e.heightSpan[0]+e.getItemHeight(e.viewTasks[0])<we-qe){e.outViewTask(0);};while(e.viewTasks[0]&&e.heightSpan[1]-e.getItemHeight(e.viewTasks[e.viewTasks.length-1])>ee+qe){e.outViewTask(-1);};if(!e.viewTasks[0]){var re=0,oe=e.data.getRootTask().getNextTask();while(re<we&&oe){if(re+e.getItemHeight(oe)>=we){break;};re+=e.getItemHeight(oe);oe=oe.getNextViewTask();};if(!oe){return;};e.heightSpan=[re,re];e.inViewTask(oe,-1);};while(e.heightSpan[1]<ee){var oe=e.viewTasks[e.viewTasks.length-1].getNextViewTask();if(!oe){break};e.inViewTask(oe,-1);};while(e.heightSpan[0]>we){var oe=e.viewTasks[0].getPreviousViewTask();if(!oe){break};e.inViewTask(oe,0);};},getTaskViewTop:function(Mw){var e=this;var qe=e.viewTasks[0];var we=e.data.compareTask(qe,Mw)>0,ee=0;for(var re=Mw;re;re=we?re.getPreviousViewTask():re.getNextViewTask()){if(re==Mw&&we){continue;};if(re==qe&&!we){break;};ee+=e.getItemHeight(re)*(we?1:-1);if(re==qe){break;};};return e.getViewTop()+ee;},removeViewTasks:function(Mw){var e=this;for(var qe=e.viewTasks.length-1;qe>Mw;qe--){e.outViewTask(-1);};},getViewTasks:function(){var e=this;return e.viewTasks;},hideTasks:function(Mw,qe,we){var e=this;if(we){if(qe){var ee=e.viewTasks.length;for(var re=0;re<ee;re++){if(e.viewTasks[re]==Mw){e.outViewTask(re);break;};};if(e.getTaskDrawObj(Mw).view){e.bodyHeight-=e.getItemHeight(Mw);e.getTaskDrawObj(Mw).view=false;};}else{if(!e.getTaskDrawObj(Mw).view){e.bodyHeight+=e.getItemHeight(Mw);e.getTaskDrawObj(Mw).view=true;};};};if((we==0||!Mw.Collapse)&&Mw.getFirstChild()){for(var te=Mw.getFirstChild();te;te=te.getNextSibling()){e.hideTasks(te,qe,we+1);};};},isTaskHidden:function(Mw){for(var qe=Mw.getParentTask();qe;qe=qe.getParentTask()){if(qe.Collapse){return true;};};return false;},getTaskDrawObj:function(Mw){var e=this;if(!Mw.drawObj){var qe=e.getItemHeight(Mw);Mw.drawObj={height:qe,view:true};e.bodyHeight+=qe;e.setBodyHeight();};return Mw.drawObj;},isTaskSelected:function(Mw){var e=this;for(var qe=e.selectedTasks.length-1;qe>=0;qe--){if(e.selectedTasks[qe]==Mw){return true;};};return false;},setTaskSelected:function(Mw,qe){var e=this;Y(e,qe?q[74]:q[73],[Mw]);Mw.setProperty(q[72],!!qe);Mw.update();},setSelectedTask:function(Mw){var e=this;if(e.selectedTasks&&e.selectedTasks[0]==Mw&&!e.selectedTasks[1]){return;};e.clearSelectedTask();e.addSelectedTask(Mw);},getSelectedTasks:function(){var e=this;return e.selectedTasks;},addSelectedTask:function(Mw){var e=this;if(!e.isTaskSelected(Mw)){e.selectedTasks.push(Mw);Y(e,q[74],[Mw]);Mw.setProperty(q[72],true);Mw.update();};},removeSelectedTask:function(Mw){var e=this;for(var qe=e.selectedTasks.length-1;qe>=0;qe--){if(e.selectedTasks[qe]==Mw){e.selectedTasks.splice(qe,1);Y(e,q[73],[Mw]);Mw.setProperty(q[72],false);Mw.update();break;};};},clearSelectedTask:function(){var e=this;var Mw;while(Mw=e.selectedTasks.pop()){Y(e,q[73],[Mw]);Mw.setProperty(q[72],false);Mw.update();};},getFocusTask:function(){var e=this;return e.selectedTasks[e.selectedTasks.length-1];},move:function(Mw){var e=this;e.moveTo(new Date(Mw*e.zoomLevel.mSecond/e.itemWidth+e.startTime.valueOf()));},moveTo:function(Mw){var e=this;e.startTime=Mw;Y(e,q[71],[Mw]);},focusIntoView:function(){var e=this;var Mw=e.getFocusTask();if(!Mw){return;};e.moveTo(Mw.Start);e.move(-10);},zoomIn:function(){var e=this;e.zoomTo(e.zoom-1);},zoomOut:function(){var e=this;e.zoomTo(e.zoom+1);},zoomTo:function(Mw){var e=this;var qe=e.zoom;if(typeof(Mw)==q[198]){Mw=parseInt(Mw);};if(typeof(Mw)!=q[203]||Mw<0||Mw>=Jq.levels.length){return;};e.zoom=Mw;e.zoomLevel=Jq.levels[e.zoom];Y(e,q[70],[e.zoom,qe]);e.moveTo(e.startTime);},addContextMenuItem:function(Mw,qe,we,ee,re,te){var e=this;if(re){for(var ye=0;ye<e.contextMenuItems.length;ye++){if(re==e.contextMenuItems[ye].id==re){return false;};};};var ue=new Nw(Mw,qe,we,ee,re,te);e.contextMenuItems.push(ue);return ue;},getContextMenuItemById:function(Mw){var e=this;for(var qe=0;qe<e.contextMenuItems.length;qe++){if(Mw==e.contextMenuItems[qe].id){return e.contextMenuItems[qe];};};return null;},removeContextMenuItem:function(Mw){var e=this;if(typeof(Mw)==q[199]){Mw=Mw.id;};if(Mw){for(var qe=0;qe<e.contextMenuItems.length;qe++){if(e.contextMenuItems[qe].id==Mw){return e.contextMenuItems.splice(qe,1);};};};return null;},showMenu:function(Mw){var e=this;var qe={type:Mw,gantt:e};if(e.contextMenu){e.contextMenu.hidden();};e.contextMenu=new eq(e.container,qe);var we=e.contextMenuItems;for(var ee=0;ee<we.length;ee++){var Mw=we[ee].showHandle(qe);if(Mw==1){e.contextMenu.addItem(we[ee]);};};return e.contextMenu;},moveTask:function(Mw,qe,we){var e=this;e.data.moveTask(Mw,qe,we);},addTask:function(){var e=this;var parent,Mw=null,qe=e.selectedTasks[0]?e.selectedTasks[e.selectedTasks.length-1]:null;if(qe){if(!qe.getPreviousSibling()){parent=qe.getParentTask();}else{Mw=qe.getPreviousSibling().getLastDescendant(true);parent=Mw.getParentTask();};}else{if(!e.data.getRootTask().getFirstChild()){parent=e.data.getRootTask();}else{Mw=e.data.getRootTask().getLastChild().getLastDescendant(true);parent=Mw.getParentTask();};};var we=e.data.addTask(parent,Mw);if(we&&qe){we.setProperty(q[168],qe.Start);we.setProperty(q[167],qe.Finish);we.update();};e.setSelectedTask(we);},checkTaskReadOnly:function(){var e=this;var Mw=e.selectedTasks;var qe=e.selectedTasks.length;for(var we=0;we<qe;we++){if(e.selectedTasks[we].ReadOnly){alert(w("eNGSelect one or more read-only mission operation can not be completed",r));return false;};};return true;},deleteTask:function(){var e=this;if(!e.checkTaskReadOnly()){return false;};var Mw=e.selectedTasks;var qe=e.selectedTasks.length;if(!e.selectedTasks[0]){return;};if(qe==0){return;};if(qe==1){var we=e.selectedTasks[0];if(!window.confirm(w("eNGConfirm that you want to delete Task",r)+we.Name+w("eNG\"??",r)+(we.Summary?w("eNGNote: All sub-task will also be deleted",r):q[219]))){return};}else{if(!window.confirm(w("Confirm that you want to delete a number of task? Note: All sub-mission summary mission will be deleted",r))){return};};for(var ee=e.selectedTasks.length-1;ee>=0;ee--){var we=e.selectedTasks[ee];if(!we){continue;};e.data.deleteTask(we);};},getTopSelectedTasks:function(){var e=this;var Mw=[];for(var qe=0;qe<e.selectedTasks.length;qe++){var we;for(var we=Mw.length-1;we>=0;we--){if(Mw[we].OutlineLevel>e.selectedTasks[qe].OutlineLevel&&Mw[we].OutlineNumber.indexOf(e.selectedTasks[qe].OutlineNumber+q[172])==0){Mw[we]=e.selectedTasks[qe];break;}else if(Mw[we].OutlineLevel<e.selectedTasks[qe].OutlineLevel&&e.selectedTasks[qe].OutlineNumber.indexOf(Mw[we].OutlineNumber+q[172])==0){break;};};if(we<0){Mw.push(e.selectedTasks[qe]);};};return Mw;},upgradeTask:function(){var e=this;if(!e.checkTaskReadOnly()){return false;};var Mw=e.getTopSelectedTasks();for(var qe=0;qe<Mw.length;qe++){e.data.upgradeTask(Mw[qe]);};},degradeTask:function(){var e=this;if(!e.checkTaskReadOnly()){return false;};var Mw=e.getTopSelectedTasks();for(var qe=0;qe<Mw.length;qe++){e.data.degradeTask(Mw[qe]);};},addTasksLinks:function(){var e=this;if(e.selectedTasks.length<2){alert(q[69]);return;};for(var Mw=1;Mw<e.selectedTasks.length;Mw++){e.selectedTasks[Mw].addPredecessorLink(e.selectedTasks[Mw-1],1);};},removeTasksLinks:function(){var e=this;if(e.selectedTasks.length<2){alert(q[69]);return;};for(var Mw=0;Mw<e.selectedTasks.length;Mw++){for(var qe=0;qe<e.selectedTasks.length;qe++){if(Mw==qe){continue;};var we=e.selectedTasks[Mw].getPredecessorLinks();for(var ee=we.length-1;ee>=0;ee--){if(we[ee].PredecessorTask==e.selectedTasks[qe]){e.data.deleteLink(we[ee]);break;};};};};},setCursor:function(Mw,qe){var e=this;if(qe.indexOf(q[215])>0){var we=qe.split(q[215]);for(var ee=0;ee<we.length;ee++){if(e.setCursor(Mw,we[ee])){return true;};};return false;};try{if(qe.toLowerCase().indexOf(q[214])>0){qe=q[213]+e.imgPath+"cursor/"+qe+q[212];};qe=qe.toLowerCase();if(qe==q[211]&&!document.all){qe=q[210];};Mw.style.cursor=qe;return true;}catch(re){return false;};}});function Oq(Mw){var e=this;a(e,Mw);M(e,e.gantt.config.getConfigObj("SFGanttTasksList"));e.bgColor=e.bgColor?e.bgColor:q[194];if(!Oq.listIndex){Oq.listIndex=0;};e.proTag="listRow_"+(Oq.listIndex++);var qe=document.createElement(q[195]);if(e.disableDragOrder){e.dragOrder=null;};a(qe,{bgColor:e.gantt.borderColor,border:0,cellSpacing:1,cellPadding:0});a(qe.style,{fontSize:q[106],position:q[202],left:q[68],top:q[68],tableLayout:'fixed',zIndex:100});A(qe);var we=qe.insertRow(-1);a(we,{bgColor:e.bgColor});var ee=3;var re=we.insertCell(-1);a(re,{height:1,width:1,innerHTML:'&nbsp;'});a(re.style,{position:q[202],overflow:q[98],fontSize:q[106]});for(var te=0;te<e.fields.length;te++){re=we.insertCell(-1);a(re.style,{position:q[202],overflow:q[98],fontSize:q[106]});var ye=e.fields[te].width;ee+=ye+1;a(re,{width:ye});};var we=qe.insertRow(-1);a(we,{bgColor:e.bgColor});var re=we.insertCell(-1);a(re,{height:(e.gantt.itemHeight-1)*1});a(re.style,{position:q[202],overflow:q[98]});for(var te=0;te<e.fields.length;te++){re=we.insertCell(-1);a(re.style,{position:q[202],overflow:q[98]});};rq(we,z(e,function(){var e=this;return e.gantt.showMenu(q[86])}));e.container.appendChild(qe);qe.width=ee;e.listTable=qe;m(e.gantt,q[74],e,e.onTaskFocus);m(e.gantt,q[73],e,e.onTaskBlur);m(e.gantt,q[76],e,e.drawTask);m(e.gantt,q[75],e,e.clearTask);m(e.gantt,q[80],e,e.updateTask);if(e.head){m(e.head,q[71],e,e.onHeadMove);m(e.head,q[87],e,e.onHeadResize);e.head.onScroll();e.head.setWidth();};};Mw(Oq.prototype,{setViewTop:function(){var e=this;var top=e.gantt.getViewTop();e.listTable.rows[0].cells[0].height=top+1;},getTaskStyle:function(Mw){var e=this;var qe=Mw.getProperty(q[146]);return Ww.types[qe?qe:e.taskStyle];},drawTask:function(Mw,qe){var e=this;if(qe==0){e.setViewTop();};var we=e.gantt.getTaskDrawObj(Mw);ee=e.listTable.insertRow(qe+1);e.gantt.setCursor(ee,e.dragOrder?q[67]:'fieldedit.cur,default');var re=ee.insertCell(-1);a(re,{height:(e.gantt.getItemHeight(Mw)-1)*1,width:1});we[e.proTag]=ee;e.getTaskStyle(Mw).listRowDraw(e,ee,!!e.dragOrder,Mw.getProperty(q[72]),false);if(e.dragOrder){m(ee,q[191],e,e.onTaskMouseDown(Mw));};if(!e.disableAdjustLineHeight){m(ee,q[183],e,e.onTaskMouseOver(Mw));};for(var te=0;te<e.fields.length;te++){var re=ee.insertCell(-1);a(re,{noWrap:q[187]});a(re.style,{position:q[202],overflow:q[98]});e.drawListCell(Mw,re,e.fields[te]);m(re,q[196],e,e.onListClick(Mw,te));var ye=te;rq(re,z(e,function(){var e=this;e.onListClick(Mw,ye).apply(e);return e.gantt.showMenu(q[86])}));};},onTaskMouseOver:function(Mw){return function(qe){var e=this;var we=Mw.drawObj[e.proTag];var ee=3,re=document.all?qe.offsetY:(O(qe,we)[1]);if(re>0&&re<ee||re>e.gantt.getItemHeight(Mw)-ee-1){e.gantt.setCursor(we,'heightChange.cur,default');e.dragMode=q[66];}else{e.gantt.setCursor(we,Mw.getProperty(q[72])?q[65]:q[67]);e.dragMode=q[219];};};},onTaskMouseDown:function(Mw){return function(qe){var e=this;if(P(qe)!=1){return;};b(qe);if(e.dragObj){e.onTaskMouseUp(qe);};var we=Mw.drawObj[e.proTag];if(we.setCapture){we.setCapture();};var ee={time:new Date(),task:Mw,dragMode:e.dragMode,ml:m(document,q[183],e,e.onTaskMouseMove),ul:m(document,q[83],e,e.onTaskMouseUp),offset:[qe.offsetX,qe.offsetY],start:I(qe,e.container)};e.dragObj=ee;Y(e,q[64],[Mw]);};},onTaskMouseMove:function(Mw){var e=this;b(Mw);if(!e.dragObj){return;};var qe=e.dragObj;var we=I(Mw,e.container);var ee=we[1]-qe.start[1];switch(qe.dragMode){case q[66]:var re=qe.task;re=qe.offset[1]<3?re.getPreviousViewTask():re;if(!qe.startHeight){qe.startHeight=e.gantt.getItemHeight(re);};re.drawObj[e.proTag].cells[0].height=Math.max(qe.startHeight+ee,10);break;default:var te=ee>0;var ye=e.gantt;ee=te?(ee-ye.getItemHeight(qe.task)+qe.offset[1]):(ee+qe.offset[1]);var re=qe.task;while(re){var ue=te?re.getNextViewTask():re.getPreviousViewTask();if(!ue){break;};var ie=ye.getItemHeight(ue);if(ue&&ue!=e.gantt.data.getRootTask()&&(te?(ee-ie/2):(ee+ie/2))*(te?1:-1)>0){re=ue;ee=te?(ee-ie):(ee+ie);}else{break;};};qe.dir=te;e.dragOrder.showTaskMoveFlag(re,qe);break;};},showTaskMoveFlag:function(Mw,qe){var e=this;if(qe.flagDiv){if(Mw==qe.flagTask){return;};_(qe.flagDiv);qe.flagDiv=null;qe.flagTask=Mw;};if(!Mw||qe.task.containsTask(Mw)){return;};var we=qe.dir;var ee=U(Mw.drawObj[e.proTag],e.container)[1];ee=we?(ee+e.gantt.getItemHeight(Mw)-14):(ee-14);var re=document.createElement(q[195]);re.cellSpacing=0;a(re.style,{position:q[193],width:q[105],zIndex:200,height:q[63],left:q[95],top:ee+q[190]});var te=re.insertRow(-1);var ye=te.insertCell(-1);ye.width=3;var ue=document.createElement(q[197]);a(ue.style,{width:q[95],height:q[63]});wq(ue,e.gantt.imgPath+"dragflag_left"+e.gantt.imgType);ye.appendChild(ue);var ye=te.insertCell(-1);wq(ye,e.gantt.imgPath+"dragflag_right"+e.gantt.imgType);e.container.appendChild(re);qe.flagDiv=re;},onTaskMouseUp:function(Mw){var e=this;b(Mw);if(!e.dragObj){return;};var qe=e.dragObj;E(qe.ml);E(qe.sl);switch(qe.dragMode){case q[66]:var we=I(Mw,e.container);var ee=we[1]-qe.start[1];var re=qe.task;re=qe.offset[1]<3?re.getPreviousViewTask():re;if(qe.startHeight){re.setProperty(q[144],Math.max(qe.startHeight+ee,10));re.update();};break;default:if(qe.flagTask&&qe.flagTask!=qe.task){e.gantt.moveTask(qe.task,qe.flagTask,qe.dir);};e.dragOrder.showTaskMoveFlag(qe.task,qe);break;};if(document.releaseCapture){document.releaseCapture();};e.dragObj=null;},updateTask:function(Mw,qe){var e=this;if(Mw==e.gantt.data.getRootTask()){return;};var we=e.gantt.getTaskDrawObj(Mw);var ee=we[e.proTag];if(ee.cells.length==1){return;};for(var re=0;re<e.fields.length;re++){if(!e.fields[re].checkUpdate(qe)){continue;};var te=ee.cells[re+1];_(te,true);e.drawListCell(Mw,te,e.fields[re])};},clearTask:function(Mw,qe){var e=this;if(qe==0){e.setViewTop();};e.clearInputCell();var we=e.gantt.getTaskDrawObj(Mw);_(we[e.proTag]);we[e.proTag]=null;},onTaskFocus:function(Mw){var e=this;var qe=-1;var we=e.gantt.getTaskDrawObj(Mw);if(!we.draw){return;};var ee=we[e.proTag].cells;for(var re=0;re<ee.length;re++){e.getTaskStyle(Mw).listRowDraw(e,ee[re],!!e.dragOrder,true,false);};if(e.dragOrder){e.gantt.setCursor(Mw.drawObj[e.proTag],q[65]);};},onTaskBlur:function(Mw){var e=this;var qe=e.gantt.getTaskDrawObj(Mw);if(!qe.draw){return;};var we=qe[e.proTag].cells;e.clearInputCell();for(var ee=0;ee<we.length;ee++){e.getTaskStyle(Mw).listRowDraw(e,we[ee],!!e.dragOrder,false);};if(e.dragOrder){e.gantt.setCursor(Mw.drawObj[e.proTag],q[67]);};},clearInputCell:function(){var e=this;if(e.focusObj&&e.focusObj.inputCell>=0){var Mw=e.focusObj.task;var qe=e.fields[e.focusObj.inputCell];var we=e.gantt.getTaskDrawObj(Mw);var ee=we[e.proTag].cells;qe.showBody(ee[e.focusObj.inputCell+1].firstChild,Mw,e);e.focusObj.inputCell=-1;};},onHeadMove:function(Mw){var e=this;e.listTable.style.left=Mw-2+q[190];},onHeadResize:function(Mw){var e=this;var qe=e.listTable,we=(Mw.length+1)*1;var ee=qe.rows[0].cells;for(var re=0;re<Mw.length;re++){ee[re+1].width=Mw[re];e.fields[re].width=Mw[re];we+=Mw[re]*1;};qe.width=we+3;},drawListCell:function(Mw,qe,we){var e=this;m(qe,q[62],e,e.onFieldDblClick(Mw,we));var ee=document.createElement(q[181]);qe.appendChild(ee);if(document.all){a(ee.style,{position:s()?q[193]:q[202],height:(e.gantt.getItemHeight(Mw)-1)+q[190],top:q[106],padding:q[106],margin:q[106],width:q[105],fontSize:e.gantt.fontSize+q[190],overflow:q[98],textAlign:q[96]});}else{a(ee.style,{position:q[202],height:(e.gantt.getItemHeight(Mw)-1)+q[190],top:q[106],padding:q[106],margin:q[106],width:q[105],fontSize:e.gantt.fontSize+q[190],overflow:q[98],textAlign:q[96]});var re=document.createElement(q[181]);a(re.style,{position:q[193],height:(e.gantt.getItemHeight(Mw)-1)+q[190],top:q[106],padding:q[106],margin:q[106],width:q[105],fontSize:e.gantt.fontSize+q[190],overflow:q[98],textAlign:q[96]});ee.appendChild(re);ee=re;};if(Mw.Summary){a(ee.style,{fontWeight:q[61]});};a(ee,{noWrap:q[187]});we.showBody(ee,Mw,e);},onFieldDblClick:function(Mw,qe){return function(we){var e=this;Y(e.gantt,q[60],[Mw,q[86],qe.Name]);};},onListClick:function(Mw,qe){return function(we){var e=this;if(!e.focusObj){e.focusObj={}};e.focusObj.cellIndex=qe;if(!we||P(we)==2){if(!e.gantt.isTaskSelected(Mw)){e.gantt.setSelectedTask(Mw);e.getTaskStyle(Mw).listRowDraw(e,e.gantt.getTaskDrawObj(Mw)[e.proTag].cells[qe+1],!!e.dragOrder,true,true);};}else{if(we.shiftKey&&e.gantt.selectedTasks[0]){var ee=e.gantt.data.compareTask(e.gantt.selectedTasks[0],Mw)>0;for(var re=e.gantt.selectedTasks[e.gantt.selectedTasks.length-1];re;){e.gantt.addSelectedTask(re);if(re==Mw){return;};re=ee?re.getNextViewTask():re.getPreviousViewTask();};}else if(we.ctrlKey){if(e.gantt.isTaskSelected(Mw)){e.gantt.removeSelectedTask(Mw);}else{e.gantt.addSelectedTask(Mw);};}else{e.gantt.setSelectedTask(Mw);};};if(qe>=0){var te=e.gantt.getSelectedTasks();if(te.length==1){var ye=e.gantt.getTaskDrawObj(te[0]);if(ye.draw){var ue=ye[e.proTag].cells;for(var ie=0;ie<ue.length;ie++){e.getTaskStyle(te[0]).listRowDraw(e,ue[ie],!!e.dragOrder,true,ie==qe+1);};};};e.clearInputCell();var oe=e.fields[qe];if(oe.inputFunc&&!oe.ReadOnly&&!Mw.ReadOnly&&!e.gantt.readOnly&&!e.gantt.disableUpdateTask&&!e.disableInput){e.focusObj.inputCell=qe;e.focusObj.task=Mw;var ye=e.gantt.getTaskDrawObj(Mw);var ue=ye[e.proTag].cells;oe.showInput(ue[qe+1].firstChild,Mw,e);};};};}});function Pq(Mw,qe,we){var e=this;M(e,Mw.config.getConfigObj("SFGanttTasksMap"));if(!Pq.listIndex){Pq.listIndex=0;};e.proTag="mapDiv_"+(Pq.listIndex++);e.taskBarField=Mq(e.taskBarField);e.taskNoticeFields=e.taskNoticeFields?Bq(e.taskNoticeFields.split(q[215])):null;e.taskProgressNoticeFields=e.taskProgressNoticeFields?Bq(e.taskProgressNoticeFields.split(q[215])):null;e.gantt=Mw;a(e,{isTracking:we,taskHeight:12,itemWidth:Mw.itemWidth});e.taskPadding=Mw.itemHeight-e.taskHeight;e.tasksDiv=document.createElement(q[181]);a(e.tasksDiv.style,{position:q[193],fontSize:q[106],left:q[106],top:q[59],zIndex:100});var ee=document.createElement(q[181]);a(ee.style,{position:q[202],padding:q[106],margin:q[106],border:q[106]});e.tasksDiv.appendChild(ee);qe.appendChild(e.tasksDiv);m(Mw,q[71],e,e.moveTo);m(Mw,q[70],e,e.onZoom);m(Mw,q[76],e,e.drawTask);m(Mw,q[75],e,e.clearTask);m(Mw,q[80],e,e.updateTask);};Mw(Pq.prototype,{setViewTop:function(){var e=this;var top=e.gantt.getViewTop();e.tasksDiv.firstChild.style.height=top+q[190];},drawTask:function(Mw,qe){var e=this;if(!e.gantt.zoomLevel){return;};if(qe==0){e.setViewTop();};var we={};var ee=e.gantt.getTaskDrawObj(Mw);ee[e.proTag]=we;re=document.createElement(q[181]);a(re.style,{position:q[202],fontSize:q[106],top:q[106]});we.taskDiv=re;if(qe+1==e.tasksDiv.childNodes.length){e.tasksDiv.appendChild(re);}else{e.tasksDiv.insertBefore(re,e.tasksDiv.childNodes[qe+1]);};var te=e.isTracking&&Mw.getProperty(q[142])?Mw.getProperty(q[142]):Mw.getProperty(q[168]);var ye=e.isTracking&&Mw.getProperty(q[141])?Mw.getProperty(q[141]):Mw.getProperty(q[167]);if(ye<te){ye=te;};re.style.left=(te.valueOf()-e.drawStart.valueOf())*e.gantt.itemWidth/e.gantt.zoomLevel.mSecond+q[190];m(re,q[62],e,e.onTaskDblClick(Mw));var ue=document.createElement(q[181]);a(ue.style,{position:q[202],fontSize:q[106],top:q[106],left:q[106],height:e.gantt.getItemHeight(Mw)+q[190],overflowY:'visible'});re.appendChild(ue);we.taskSpan=ue;if(e.taskNoticeFields){yq(ue,z(e,e.getTaskToopTipCallback(Mw)));};m(ue,q[196],e,e.getTaskClickCallback(Mw));ue.style.left=q[106];ue.style.width=(ye-te)*e.gantt.itemWidth/e.gantt.zoomLevel.mSecond+q[190];var ie=parseInt(ye.valueOf()-te.valueOf());if(ie==0){var oe=Mw.getProperty(q[146]);var pe=Ww.types[oe?oe:(e.isTracking?e.trackMilestoneStyle:e.milestoneStyle)];var ae=pe.leftDraw(e);a(ae.style,{position:q[193],width:(e.taskHeight-1)+q[190],left:-(e.taskHeight-1)+q[190]});ue.appendChild(ae);if(!e.isTracking){e.drawTaskText(Mw);};}else if(Mw.Summary){if(!e.isTracking){var oe=Mw.getProperty(q[146]);var pe=Ww.types[oe?oe:e.summaryStyle];e.drawTaskBar(Mw,pe);};}else{var oe=Mw.getProperty(q[146]);var pe=Ww.types[oe?oe:(e.gantt.isTracking?(e.isTracking?e.trackBottomStyle:e.trackTopStyle):e.taskStyle)];var se=e.drawTaskBar(Mw,pe);if(!e.isTracking){if(se[1]&&!e.gantt.readOnly&&!Mw.ReadOnly&&((!e.gantt.disableAddLink&&!e.disableDragAddLink)||(!e.gantt.disableUpdateTask&&!e.disableDragTask))){m(se[1],q[191],e,e.onTaskMoveMouseDown(Mw));h(se[1],q[71]);};if(se[2]&&!e.gantt.readOnly&&!Mw.ReadOnly&&!e.gantt.disableUpdateTask&&!e.disableDragResizeTask){m(se[2],q[191],e,e.onTaskResizeMouseDown(Mw));h(se[2],"w-resize");};if(se[4]){we.percentDiv=se[4];if(e.taskProgressNoticeFields){yq(we.percentDiv,z(e,e.getPercentToolTipCallback(Mw)));};};if(se[5]&&!e.gantt.readOnly&&!Mw.ReadOnly&&!e.gantt.disableUpdateTask&&!e.disableDragChangePercent){we.percentSpan=se[5];m(se[5],q[191],e,e.onTaskPercentMouseDown(Mw));h(se[5],q[103]);};m(ue,q[177],e,e.onMouseOver(Mw));};};},onTaskDblClick:function(Mw){return function(qe){var e=this;Y(e.gantt,q[60],[Mw,q[88]]);};},drawTaskBar:function(Mw,qe){var e=this;var we=Mw.drawObj[e.proTag].taskSpan;var ee=qe.centerDraw(e);if(ee){a(ee.style,{position:q[193],fontSize:q[106],zIndex:100,left:q[106],width:q[105]});we.appendChild(ee);};var re=qe.leftDraw(e);if(re){a(re.style,{position:q[193],fontSize:q[106],zIndex:150,width:(e.taskHeight-1)+q[190],left:-Math.floor((e.taskHeight-1)/2)+q[190]});we.appendChild(re);};var te=qe.rightDraw(e);if(te){a(te.style,{position:q[193],fontSize:q[106],zIndex:150,width:(e.taskHeight-1)+q[190],right:-Math.floor((e.taskHeight-1)/2)+q[190]});we.appendChild(te);};var ye=Mw.PercentComplete?Mw.PercentComplete:0;var ue=qe.percentCenterDraw(e);if(ue){a(ue.style,{position:q[193],fontSize:q[106],zIndex:200,left:q[106],width:ye+q[58]});we.appendChild(ue);};var ie=qe.percentLeftDraw(e);if(ie){a(ie.style,{position:q[193],fontSize:q[106],zIndex:250,width:Math.floor((e.taskHeight-1)/2)+q[190],left:-Math.floor((e.taskHeight-1)/2)+q[190]});we.appendChild(ie);};var oe=qe.percentRightDraw(e);if(oe){a(oe.style,{position:q[193],fontSize:q[106],zIndex:250,width:Math.floor((e.taskHeight-1)/2)+q[190],left:ye+q[58]});we.appendChild(oe);};if(!e.isTracking){e.drawTaskText(Mw);};return[re,ee,te,ie,ue,oe];},updateTask:function(Mw,qe){var e=this;var we=Mw.drawObj[e.proTag].textDiv;if(we&&e.taskBarField.checkUpdate(qe)){e.taskBarField.showBody(we,Mw);};for(var ee=0;ee<qe.length;ee++){var re=qe[ee];if(re==q[169]||re==q[168]||re==q[167]||re==q[142]||re==q[141]||re==q[169]||re==q[154]||re==q[146]){e.clearTask(Mw);e.drawTask(Mw,e.gantt.getViewIndex(Mw));return;};};},clearTask:function(Mw,qe){var e=this;if(qe==0){e.setViewTop();};var we=Mw.drawObj;if(!we){return};var ee=we[e.proTag];if(ee){_(ee.taskDiv);_(ee.taskSpan);_(ee.percentDiv);_(ee.textDiv);_(ee.percentSpan);a(ee,{percentDiv:null,textDiv:null,taskDiv:null,taskSpan:null,percentSpan:null});};we[e.proTag]=null;},onZoom:function(){var e=this;e.drawStart=e.gantt.startTime;var Mw=e.gantt.getViewTasks();for(var qe=0;qe<Mw.length;qe++){e.clearTask(Mw[qe],qe);e.drawTask(Mw[qe],qe);};},drawTaskText:function(Mw){var e=this;var qe=Mw.drawObj[e.proTag].taskSpan;var we=document.createElement(q[181]);we.noWrap=true;a(we.style,{position:q[193],whiteSpace:'nowrap',height:(e.gantt.getItemHeight(Mw)-1)+q[190],width:q[57],zIndex:100,fontWeight:q[61],top:Math.ceil((e.gantt.itemHeight-e.gantt.fontSize)/2)+q[190],fontSize:e.gantt.fontSize+q[190],left:(Mw.Finish-Mw.Start)*e.gantt.itemWidth/e.gantt.zoomLevel.mSecond+10+q[190]});e.taskBarField.showBody(we,Mw);Mw.drawObj[e.proTag].textDiv=we;qe.appendChild(we);},getTaskToopTipCallback:function(Mw){return function(){var e=this;var qe=uq(e.gantt.container);if(qe&&qe.bindObject==Mw&&qe.bindType==q[127]){return;};var we=document.createElement(q[195]);we.style.fontSize=q[180];a(we,{});var ee=we.insertRow(-1);var re=ee.insertCell(-1);a(re,{align:q[188],colSpan:2,noWrap:true});re.appendChild(document.createTextNode(Mw.Summary?w("eNGAbstract",r):((Mw.Start.valueOf()==Mw.Finish.valueOf())?w("eNGMilestone",r):w("eNGTask",r))));for(var te=0;te<e.taskNoticeFields.length;te++){var ye=e.taskNoticeFields[te];if(ye.Name==q[167]&&Mw.getProperty(q[167])<=Mw.getProperty(q[168])){continue;};ee=we.insertRow(-1);re=ee.insertCell(-1);a(re,{align:q[84],noWrap:true});ye.showHead(re);re=ee.insertCell(-1);a(re,{align:q[84],noWrap:true});ye.showBody(re,Mw);};qe.bindObject=Mw;qe.bindType=q[127];qe.setContent(we);return qe;};},getPercentToolTipCallback:function(Mw){return function(){var e=this;var qe=uq(e.gantt.container);if(qe&&qe.bindObject==Mw&&qe.bindType==q[56]){return;};var we=document.createElement(q[195]);we.style.fontSize=q[180];a(we,{});var ee=we.insertRow(-1);var re=ee.insertCell(-1);a(re,{align:q[188],colSpan:2,noWrap:true});re.appendChild(document.createTextNode(w("eNGProgress",r)));for(var te=0;te<e.taskProgressNoticeFields.length;te++){var ye=e.taskProgressNoticeFields[te];ee=we.insertRow(-1);re=ee.insertCell(-1);a(re,{align:q[84],noWrap:true});ye.showHead(re);re=ee.insertCell(-1);a(re,{align:q[84],noWrap:true});ye.showBody(re,Mw);};qe.bindObject=Mw;qe.bindType=q[56];qe.setContent(we);return qe;};},getTaskClickCallback:function(Mw){return function(){var e=this;e.gantt.setSelectedTask(Mw);};},moveTo:function(Mw){var e=this;var qe=parseInt((e.drawStart-Mw)*e.gantt.itemWidth/e.gantt.zoomLevel.mSecond)+q[190];e.tasksDiv.style.left=qe;},onMouseOver:function(Mw){return function(){var e=this;var qe=e.dragObj;if(!qe){return;};if(qe&&qe.type==q[55]&&qe.task!=Mw){qe.objl=m(Mw.drawObj[e.proTag].taskSpan,q[176],e,e.onMouseOut);qe.objTask=Mw;};};},onMouseOut:function(){var e=this;var Mw=e.dragObj;if(!Mw){return;};E(Mw.objl);Mw.objTask=null;},onTaskMoveMouseDown:function(Mw){return function(qe){var e=this;if(P(qe)!=1){return;};Y(Mw.drawObj[e.proTag].taskSpan,q[196],[]);b(qe);if(e.dragObj){e.onTaskBarMouseUp(qe);};var we=Mw.drawObj[e.proTag].taskSpan;if(we.setCapture){we.setCapture();};var ee={time:new Date(),task:Mw,ml:m(document,q[183],e,e.onTaskMoveMouseMove),ul:m(document,q[83],e,e.onTaskMouseUp),start:O(qe,we),startLeft:0};e.dragObj=ee;Y(e,q[64],[Mw]);};},onTaskMoveMouseMove:function(Mw,qe){var e=this;b(Mw);if(!e.dragObj){return;};var we=e.dragObj;var ee=O(Mw,e.dragObj.task.drawObj[e.proTag].taskSpan);var re=[ee[0]-we.start[0],ee[1]-we.start[1]];if(!we.type){if(Math.sqrt(Math.pow(re[0],2)+Math.pow(re[1],2))<5){return;};if(re[0]==0||re[1]/re[0]>2&&!e.gantt.readOnly&&!we.task.ReadOnly&&!e.gantt.disableAddLink&&!e.disableDragAddLink){we.type=q[55];}else if((re[1]==0||re[0]/re[1]>2)&&!e.gantt.readOnly&&!we.task.ReadOnly&&!e.gantt.disableUpdateTask&&!e.disableDragMoveTask){we.type=q[168];Y(e.gantt,"taskbardragstart",[e.dragObj.task]);}else{return;};};if(we.type==q[168]){we.startLeft+=re[0];we.task.drawObj[e.proTag].taskSpan.style.left=we.startLeft+q[190];}else{};},getLinkPaths:function(Mw,qe){var we=[];qe=qe?qe:q[54];for(var ee=1;ee<Mw.length;ee++){var re=document.createElement(q[181]);a(re.style,{position:q[193],fontSize:q[106]});if(Mw[ee-1][0]==Mw[ee][0]){a(re.style,{borderRight:q[104]+qe+q[219],height:Math.abs(Mw[ee][1]-Mw[ee-1][1])+q[190],width:0+q[190],left:(Mw[ee][0]-1)+q[190],top:(Math.min(Mw[ee][1],Mw[ee-1][1]))+q[190]});}else if(Mw[ee-1][1]==Mw[ee][1]){a(re.style,{borderTop:q[104]+qe+q[219],width:Math.abs(Mw[ee][0]-Mw[ee-1][0])+q[190],height:0+q[190],left:(Math.min(Mw[ee][0],Mw[ee-1][0]))+q[190],top:(Mw[ee][1])+q[190]});};we.push(re);};return we;},onTaskResizeMouseDown:function(Mw){return function(qe){var e=this;b(qe);if(e.dragObj){e.onTaskResizeMouseUp(qe);};var we=Mw.drawObj[e.proTag].taskSpan;if(we.setCapture){we.setCapture();};var ee={type:q[167],time:new Date(),task:Mw,ml:m(document,q[183],e,e.onTaskResizeMouseMove),ul:m(document,q[83],e,e.onTaskMouseUp),start:O(qe,we),startWidth:parseInt(we.style.width)};e.dragObj=ee;};},onTaskResizeMouseMove:function(Mw){var e=this;b(Mw);if(!e.dragObj){return;};var qe=e.dragObj;var we=O(Mw,e.dragObj.task.drawObj[e.proTag].taskSpan);var ee=[we[0]-qe.start[0],we[1]-qe.start[1]];if(qe.startWidth+ee[0]>0){qe.task.drawObj[e.proTag].taskSpan.style.width=qe.startWidth+ee[0]+q[190];};},onTaskPercentMouseDown:function(Mw){return function(qe){var e=this;b(qe);if(e.dragObj){e.onTaskPercentMouseUp(qe);};var we=Mw.drawObj[e.proTag].taskSpan;if(we.setCapture){we.setCapture();};var ee={type:q[154],time:new Date(),task:Mw,ml:m(document,q[183],e,e.onTaskPercentMouseMove),ul:m(document,q[83],e,e.onTaskMouseUp)};e.dragObj=ee;};},onTaskPercentMouseMove:function(Mw){var e=this;b(Mw);if(!e.dragObj){return;};var qe=e.dragObj;var we=O(Mw,e.dragObj.task.drawObj[e.proTag].taskSpan);var ee=qe.task.drawObj[e.proTag].percentDiv;if(we[0]>=0&&we[0]<=parseInt(qe.task.drawObj[e.proTag].taskSpan.style.width)){ee.style.width=we[0]+q[190];};},onTaskMouseUp:function(Mw){var e=this;b(Mw);if(!e.dragObj){return;};var qe=e.dragObj;switch(qe.type){case q[167]:var we=O(Mw,qe.task.drawObj[e.proTag].taskSpan);var ee=[we[0]-qe.start[0],we[1]-qe.start[1]];var re=ee[0]*e.gantt.zoomLevel.mSecond/e.gantt.itemWidth;qe.task.setProperty(q[167],new Date(Math.max(qe.task.Finish.valueOf()+re,qe.task.Start.valueOf())));break;case q[154]:var we=O(Mw,qe.task.drawObj[e.proTag].taskSpan);var te=Math.round(we[0]*100/parseInt(qe.task.drawObj[e.proTag].taskSpan.style.width));te=Math.max(0,Math.min(100,te));qe.task.setProperty(q[154],te);break;case q[168]:var re=qe.startLeft*e.gantt.zoomLevel.mSecond/e.gantt.itemWidth;qe.task.setProperty(q[167],new Date(qe.task.Finish.valueOf()+re));qe.task.setProperty(q[168],new Date(qe.task.Start.valueOf()+re));Y(e.gantt,"taskbardragend",[qe.task]);break;case q[55]:if(qe.objTask){qe.objTask.addPredecessorLink(qe.task,1);};};qe.task.update();if(qe.divs){var ye;while(ye=qe.divs.pop()){_(ye);};};E(qe.ml);E(qe.sl);E(qe.objl);if(document.releaseCapture){document.releaseCapture();};e.dragObj=null;}});function Aq(Mw,qe){var e=this;M(e,Mw.config.getConfigObj("SFGanttLinksMap"));e.gantt=Mw;a(e,{itemWidth:Mw.itemWidth,taskHeight:12,arrayPadding:10});e.taskPadding=Mw.itemHeight-e.taskHeight;e.linksDiv=document.createElement(q[181]);a(e.linksDiv.style,{position:q[193],fontSize:q[106],top:q[59],left:q[106],zIndex:200});qe.appendChild(e.linksDiv);e.linkNoticeFields=e.linkNoticeFields?Nq(e.linkNoticeFields.split(q[215])):null;m(Mw,q[71],e,e.moveTo);m(Mw,q[70],e,e.onZoom);m(Mw,q[76],e,e.delayDraw);m(Mw,q[75],e,e.clearLinks);m(Mw,q[78],e,e.drawLink);m(Mw,q[77],e,e.clearLink);m(Mw,q[80],e,e.updateLinks);m(Mw,q[79],e,e.updateLink);};Mw(Aq.prototype,{delayDraw:function(Mw,qe){var e=this;if(e.delayTimeout){window.clearTimeout(e.delayTimeout);};e.delayTimeout=window.setTimeout(z(e,e.drawTaskLinks),1000);},drawTaskLinks:function(){var e=this;var Mw=e.gantt.viewTasks;for(var qe=0;qe<Mw.length;qe++){e.drawLinks(Mw[qe],qe);};},drawLinks:function(Mw,qe){var e=this;if(!e.gantt.zoomLevel){return;};var we=Mw.getPredecessorLinks();for(var ee=0;ee<we.length;ee++){e.drawLink(we[ee],true);};var we=Mw.getSuccessorLinks();for(var ee=0;ee<we.length;ee++){e.drawLink(we[ee],false);};},clearLinks:function(Mw,qe,we){var e=this;var ee=Mw.getPredecessorLinks();for(var re=0;re<ee.length;re++){if(we||e.gantt.getViewIndex(ee[re].PredecessorTask)<0){e.clearLink(ee[re]);};};var ee=Mw.getSuccessorLinks();for(var re=0;re<ee.length;re++){if(we||e.gantt.getViewIndex(ee[re].SuccessorTask)<0){e.clearLink(ee[re]);};};},updateLinks:function(Mw,qe){var e=this;var we=false;for(var ee=0;ee<qe.length;ee++){var re=qe[ee];if(!we&&(re==q[168]||re==q[167]||re==q[144])){if(re==q[144]){e.onZoom();return;};we=true;};};if(we){e.clearLinks(Mw,0,true);e.drawLinks(Mw);};},updateLink:function(Mw){var e=this;if(Mw.drawObj){e.clearLink(Mw);e.drawLink(Mw);};},onZoom:function(){var e=this;e.drawStart=e.gantt.startTime;var Mw=e.gantt.viewTasks;if(!Mw){return};for(var qe=0;qe<Mw.length;qe++){e.clearLinks(Mw[qe],0,true);e.drawLinks(Mw[qe],qe);};e.moveTo(e.gantt.startTime);},drawLink:function(Mw){var e=this;if(Mw.drawObj){return;};if(e.gantt.isTaskHidden(Mw.PredecessorTask)){return;};if(e.gantt.isTaskHidden(Mw.SuccessorTask)){return;};Mw.drawObj={};var qe=Mw.PredecessorTask;var we=Mw.SuccessorTask;var ee=[(qe.Start-e.drawStart)*e.gantt.itemWidth/e.gantt.zoomLevel.mSecond,e.gantt.getTaskViewTop(qe)+2];var re=[(we.Start-e.drawStart)*e.gantt.itemWidth/e.gantt.zoomLevel.mSecond,e.gantt.getTaskViewTop(we)+2];var te=(qe.Finish-qe.Start)*e.gantt.itemWidth/e.gantt.zoomLevel.mSecond;var ye=(we.Finish-we.Start)*e.gantt.itemWidth/e.gantt.zoomLevel.mSecond;var ue=Mw.getProperty(q[146]);var ie=Jw.types[ue?ue:e.linkStyle];var oe=ie.size;var pe,ae=[],se={};var de=z(e,e.getLinkToopTipCallback(Mw));switch(Mw.Type){case 0:pe=q[84];var fe=ee[0]+te;var ge=ee[1]+Math.ceil((e.taskHeight+e.taskPadding)/2);var he=re[0]+ye;var je=re[1]+Math.ceil((e.taskHeight+e.taskPadding)/2);var ke=Math.max(fe,he)+e.arrayPadding;ae.push([fe,ge]);ae.push([ke,ge]);ae.push([ke,je]);ae.push([he,je]);a(se,{left:he+q[190],top:je-Math.floor(oe[0]/2)+q[190],width:oe[1]+q[190],height:oe[0]+q[190]});break;case 1:var fe=ee[0]+te;var ge=ee[1]+Math.ceil((e.taskHeight+e.taskPadding)/2);if(qe.Finish<=we.Start){pe=ee[1]>re[1]?"up":"down";var he=re[0];if(qe.Finish.valueOf()==qe.Start.valueOf()){ge-=3;};var je=ee[1]>re[1]?(re[1]+e.taskPadding/2+e.taskHeight):(re[1]+e.taskPadding/2-oe[1]);if(we.Finish.valueOf()-we.Start.valueOf()==0){je-=3;};if(we.Finish.valueOf()-we.Start.valueOf()!=0&&qe.Finish.valueOf()!=qe.Start.valueOf()){he=Math.max(he,fe+5);};ae.push([fe,ge]);ae.push([he,ge]);ae.push([he,je]);a(se,{left:(he-Math.floor(oe[0]/2)-1)+q[190],top:je+q[190],width:oe[0]+q[190],height:oe[1]+q[190]});}else{pe=q[96];var he=re[0]-oe[1];var je=re[1]+(e.taskPadding+e.taskHeight)/2;ae.push([fe,ge]);ae.push([fe+e.arrayPadding,ge]);ae.push([fe+e.arrayPadding,re[1]]);ae.push([re[0]-e.arrayPadding,re[1]]);ae.push([re[0]-e.arrayPadding,je]);ae.push([he,je]);a(se,{left:(he)+q[190],top:je-Math.floor(oe[0]/2)+q[190],width:oe[1]+q[190],height:oe[0]+q[190]});};break;case 2:pe=q[84];var fe=ee[0];var ge=ee[1]+Math.ceil((e.taskHeight+e.taskPadding)/2);var he=re[0]+ye+oe[1];var je=re[1]+Math.ceil((e.taskHeight+e.taskPadding)/2);ae.push([fe,ge]);ae.push([fe-e.arrayPadding,ge]);ae.push([fe-e.arrayPadding,re[1]]);ae.push([re[0]+ye+e.arrayPadding,re[1]]);ae.push([re[0]+ye+e.arrayPadding,je]);ae.push([he,je]);a(se,{left:he-oe[1]+q[190],top:je-Math.floor(oe[0]/2)+q[190],width:oe[1]+q[190],height:oe[0]+q[190]});break;case 3:pe=q[96];var fe=ee[0];var ge=ee[1]+Math.ceil((e.taskHeight+e.taskPadding)/2);var he=re[0];var je=re[1]+Math.ceil((e.taskHeight+e.taskPadding)/2);var ke=Math.min(fe,he)-e.arrayPadding;ae.push([fe,ge]);ae.push([ke,ge]);ae.push([ke,je]);ae.push([he,je]);a(se,{left:he-oe[1]+q[190],top:je-Math.floor(oe[0]/2)+q[190],width:oe[1]+q[190],height:oe[0]+q[190]});};Mw.drawObj.linkPaths=e.getLinkPaths(ae,ie,de);var le=ie.arrowDraw(pe,e);a(le.style,se);a(le.style,{position:q[193],fontSize:q[106]});Mw.drawObj.linkImg=le;if(e.linkNoticeFields){yq(le,de);};e.linksDiv.appendChild(le);},getLinkPaths:function(Mw,qe,we){var e=this;var ee=[];for(var re=1;re<Mw.length;re++){var te=qe.lineDraw(e);a(te.style,{position:q[193],fontSize:q[106],borderWidth:q[106]});if(Mw[re-1][0]==Mw[re][0]){a(te.style,{borderRightWidth:q[57],height:Math.abs(Mw[re][1]-Mw[re-1][1])+q[190],width:0+q[190],left:(Mw[re][0]-1)+q[190],top:(Math.min(Mw[re][1],Mw[re-1][1]))+q[190]});}else if(Mw[re-1][1]==Mw[re][1]){a(te.style,{borderTopWidth:q[57],width:Math.abs(Mw[re][0]-Mw[re-1][0])+q[190],height:0+q[190],left:(Math.min(Mw[re][0],Mw[re-1][0]))+q[190],top:(Mw[re][1])+q[190]});};e.linksDiv.appendChild(te);if(e.linkNoticeFields){yq(te,we);};ee.push(te);};return ee;},clearLink:function(Mw){var qe=Mw.drawObj;if(!qe){return};if(qe.linkImg){_(qe.linkImg);qe.linkImg=null;};if(qe.linkPaths){var we;while(we=qe.linkPaths.pop()){_(we);};qe.linkPaths=null;};Mw.drawObj=null;},getLinkToopTipCallback:function(Mw){return function(){var e=this;var qe=uq(e.gantt.container);if(qe&&qe.bindObject==Mw){return;};var we=document.createElement(q[195]);we.style.fontSize=q[180];a(we,{});var ee=we.insertRow(-1);var re=ee.insertCell(-1);a(re,{align:q[188],colSpan:2,noWrap:true});re.appendChild(document.createTextNode(w("eNGTask link",r)));for(var te=0;te<e.linkNoticeFields.length;te++){ee=we.insertRow(-1);re=ee.insertCell(-1);a(re,{align:q[84],noWrap:true});e.linkNoticeFields[te].showHead(re);re=ee.insertCell(-1);a(re,{align:q[84],noWrap:true});e.linkNoticeFields[te].showBody(re,Mw);};qe.bindObject=Mw;qe.setContent(we);return qe;};},moveTo:function(Mw){var e=this;var qe=parseInt((e.drawStart-Mw)*e.gantt.itemWidth/e.gantt.zoomLevel.mSecond)+q[190];e.linksDiv.style.left=qe;}});function Sq(Mw,qe,we){var e=this;e.path=qe;e.imgType=we;A(Mw);var ee=document.createElement(q[195]);a(ee,{cellSpacing:0,cellPadding:0,border:0,width:q[105],height:q[105]});var re=ee.insertRow(-1);var te=Mw.offsetHeight;a(e,{div:Mw,size:te,path:qe,table:ee});e.createCell(te,q[53],te);e.createCell(null,q[52],1);e.createCell(3,q[51],3);e.createCell(null,q[50],8,q[49]);e.createCell(3,q[48],3);e.createCell(null,q[52],1);e.createCell(te,q[47],te);Mw.appendChild(ee);m(re.cells[3],q[191],e,e.onBarMouseDown);m(re.cells[0],q[191],e,e.onButtonMouseDown);m(re.cells[6],q[191],e,e.onButtonMouseDown);m(re.cells[1],q[191],e,e.onSpaceMouseDown);m(re.cells[5],q[191],e,e.onSpaceMouseDown);e.size=te;};Mw(Sq.prototype,{createCell:function(Mw,qe,we,ee){var e=this;var re=e.table.rows[0].insertCell(-1);if(Mw){re.width=Mw;};a(re,{align:q[188]});var te=document.createElement(q[197]);wq(te,e.path+qe+e.imgType);re.appendChild(te);if(ee){wq(re,e.path+ee+e.imgType);};a(te.style,{width:(ee?'auto':q[105]),height:e.size+q[190],border:q[106]});return re;},init:function(Mw,qe,we){var e=this;var ee=e.div.offsetWidth-e.size*2-2;e.offsetWidth=Mw;e.scrollWidth=qe;var re=Mw<qe?q[219]:q[92];for(var te=2;te<5;te++){e.table.rows[0].cells[te].style.display=re;};var ye=Math.max(qe?parseInt(ee*Mw/qe):0,14);e.width=ee-ye;e.table.rows[0].cells[3].width=ye;e.table.rows[0].cells[1].width=1;e.bWidth=ye;e.scrollTo(we?we:1,false);},scrollTo:function(Mw,qe){var e=this;Mw=Math.max(Math.min(Mw,e.width-1),1);e.table.rows[0].cells[1].width=Mw;var we=(Mw-1)/(e.width-2)*(e.scrollWidth-e.offsetWidth);e.scrollLeft=we;if(qe!=false){Y(e,q[89],[we]);};},onBarMouseDown:function(Mw){var e=this;b(Mw);if(e.dragObj){e.onBarMouseUp(Mw);};var qe=e.table.rows[0];wq(qe.cells[2].firstChild,e.path+"scroll_barleft1"+e.imgType);wq(qe.cells[3].firstChild,e.path+"scroll_barcenter1"+e.imgType);wq(qe.cells[4].firstChild,e.path+"scroll_barright1"+e.imgType);wq(qe.cells[3],e.path+"scroll_barbg1"+e.imgType);if(e.div.setCapture){e.div.setCapture();};var we={ml:m(document,q[183],e,e.onBarMouseMove),ul:m(document,q[83],e,e.onBarMouseUp),start:qe.cells[1].width-I(Mw,e.div)[0]};e.dragObj=we;Y(e,q[46],[e.scrollLeft]);},onBarMouseMove:function(Mw){var e=this;b(Mw);if(!e.dragObj){return;};var qe=e.dragObj;var we=I(Mw,e.div);e.scrollTo(we[0]+qe.start);},onBarMouseUp:function(Mw){var e=this;b(Mw);if(!e.dragObj){return;};var qe=e.dragObj;Y(e,q[45],[e.scrollLeft]);E(qe.ml);E(qe.sl);var we=e.table.rows[0];if(document.releaseCapture){document.releaseCapture();};wq(we.cells[2].firstChild,e.path+q[51]+e.imgType);wq(we.cells[3].firstChild,e.path+q[50]+e.imgType);wq(we.cells[4].firstChild,e.path+q[48]+e.imgType);wq(we.cells[3],e.path+q[49]+e.imgType);e.dragObj=null;},onButtonMouseDown:function(Mw){var e=this;b(Mw);var qe=Mw.target;if(qe.nodeName.toUpperCase()==q[44]){qe=qe.parentNode;};var we=(qe.nextSibling==null);if(e.pressObj){e.onBarMouseUp(Mw);};var ee=e.table.rows[0];wq(ee.cells[(we?6:0)].firstChild,e.path+"scroll_"+(we?q[96]:q[84])+"1"+e.imgType);if(e.div.setCapture){e.div.setCapture();};var re={dir:(we?1:-1),timeout:window.setInterval(z(e,e.onButtonPress),32),ul:m(document,q[83],e,e.onButtonMouseUp)};e.pressObj=re;Y(e,q[46],[e.scrollLeft]);e.onButtonPress();},onButtonPress:function(){var e=this;if(!e.pressObj){return;};e.scrollTo(parseInt(e.table.rows[0].cells[1].width)+e.pressObj.dir);},onButtonMouseUp:function(Mw){var e=this;b(Mw);if(!e.pressObj){return;};var qe=e.pressObj;Y(e,q[45],[e.scrollLeft]);window.clearInterval(qe.timout);E(qe.ul);if(document.releaseCapture){document.releaseCapture();};var we=e.table.rows[0];wq(we.cells[0].firstChild,e.path+q[53]+e.imgType);wq(we.cells[6].firstChild,e.path+q[47]+e.imgType);e.pressObj=null;},onSpaceMouseDown:function(Mw){var e=this;b(Mw);var qe=Mw.target;if(qe.nodeName.toUpperCase()==q[44]){qe=qe.parentNode;};var we=(qe.nextSibling.nextSibling==null);if(e.spaceObj){e.onSpaceMouseUp(Mw);};if(e.div.setCapture){e.div.setCapture();};var ee={dir:(we?1:-1),timeout:window.setInterval(z(e,e.onSpacePress),128),position:I(Mw,e.div)[0]-(e.div.offsetWidth-e.width)/2,ul:m(document,q[83],e,e.onSpaceMouseUp)};ee.position=Math.max(0,Math.min(e.width,ee.position));e.spaceObj=ee;Y(e,q[46],[e.scrollLeft]);e.onSpacePress();},onSpacePress:function(){var e=this;if(!e.spaceObj){return;};var Mw=e.spaceObj.dir,qe=parseInt(e.table.rows[0].cells[1].width);qe=Mw?Math.min(e.spaceObj.position,qe+Mw*8):Math.max(e.spaceObj.position,qe+Mw*8);e.scrollTo(qe);},onSpaceMouseUp:function(Mw){var e=this;b(Mw);if(!e.spaceObj){return;};var qe=e.spaceObj;Y(e,q[45],[e.scrollLeft]);window.clearInterval(qe.timout);E(qe.ul);if(document.releaseCapture){document.releaseCapture();};e.spaceObj=null;}});function Dq(Mw,qe,we,ee){var e=this;e.targetDiv=ee;e.bar=new Sq(Mw,qe,we);m(e.bar,q[89],e,e.onScroll);e.onResize();};Mw(Dq.prototype,{onScroll:function(Mw){var e=this;for(var qe=e.targetDiv.firstChild;qe;qe=qe.nextSibling){if(!qe.style){continue;};qe.style.left=-Mw+q[190];};Y(e.targetDiv,q[89]);},onResize:function(Mw){var e=this;e.bar.init(e.targetDiv.offsetWidth,e.targetDiv.scrollWidth);}});function Fq(Mw,qe,we,ee){var e=this;e.g=ee;e.bar=new Sq(Mw,qe,we);e.onResize();m(e.bar,q[46],e,e.onScrollStart);m(e.bar,q[89],e,e.onScroll);m(e.bar,q[45],e,e.onScrollEnd);};Mw(Fq.prototype,{onScrollStart:function(Mw){var e=this;e.scrollObj={start:Mw,startTime:e.g.startTime};Y(e.g,q[43],[e.g.startTime]);},onScroll:function(Mw){var e=this;e.g.move(Mw-e.scrollObj.start);e.scrollObj.start=Mw;},onScrollEnd:function(Mw){var e=this;Y(e.g,q[42],[e.g.startTime]);e.onResize();},onResize:function(Mw){var e=this;e.bar.init(e.g.mapBodyDiv.offsetWidth,e.g.mapBodyDiv.offsetWidth*9,e.g.mapBodyDiv.offsetWidth/3);}});function Gq(Mw,qe){var e=this;M(e,Mw.config.getConfigObj("SFGanttTimeScrollNotice"));e.gantt=Mw;e.div=document.createElement(q[181]);a(e.div.style,{position:q[193],fontSize:q[185],zIndex:400,backgroundColor:q[179],padding:q[95],border:q[41],display:q[92]});qe.appendChild(e.div);m(Mw,q[43],e,e.onMoveStart);m(Mw,q[87],e,e.onResize);};Mw(Gq.prototype,{onMove:function(Mw){var e=this;e.div.innerHTML=g(Mw,q[40]);},onMoveStart:function(){var e=this;e.div.style.display=q[219];e.listeners=[m(e.gantt,q[71],e,e.onMove),m(e.gantt,q[42],e,e.onMoveEnd)];},onMoveEnd:function(){var e=this;e.div.style.display=q[92];if(e.listeners){var Mw;while(Mw=e.listeners.pop()){E(Mw);};};},onResize:function(Mw,qe,we,ee){var e=this;a(e.div.style,{left:(Mw+qe+we+ee/2-100)+q[190],top:(e.gantt.container.offsetHeight-50)+q[190]});}});function Hq(Mw,qe){var e=this;M(e,Mw.config.getConfigObj("SFGanttListScrollNotice"));e.gantt=Mw;e.div=document.createElement(q[181]);a(e.div.style,{position:q[193],fontSize:q[180],zIndex:400,backgroundColor:q[179],padding:q[106],border:q[41],display:q[92]});qe.appendChild(e.div);m(Mw,q[89],e,e.onScroll);m(Mw,q[87],e,e.onResize);};Mw(Hq.prototype,{onScroll:function(Mw,qe){var e=this;if(e.timeout){window.clearTimeout(e.timeout);};var we=qe.spanTasks[1];if(we){e.div.style.display=q[219];e.div.innerHTML=w('eNGNo.',r)+we.getProperty(q[171])+w('eNG Name. ',r)+we.getProperty(q[156])+'</div></td></tr><table>';e.timeout=window.setTimeout(z(e,e.hidden),2000);}else{e.div.style.display=q[92];};},hidden:function(){var e=this;e.div.style.display=q[92];},onResize:function(){var e=this;a(e.div.style,{right:'30px',top:(e.gantt.headHeight+10)+q[190]});}});function Jq(Mw,qe,we){var e=this;e.mSecond=Mw;e.name=qe;e.cals=we;};function Kq(){var Mw=Zq.items;Jq.levels=[new Jq(3*60000,"Minute3",[Mw.Minute15,Mw.Hour,Mw.Dat]),new Jq(30*60000,"Minute30",[Mw.Hour2,Mw.Dat,Mw.Week]),new Jq(3600000,q[39],[Mw.Hour6,Mw.Dat,Mw.Week]),new Jq(4*3600000,"Hour4",[Mw.Day,Mw.Week,Mw.Month]),new Jq(12*3600000,"Hour12",[Mw.Day3,Mw.Month,Mw.Quarter]),new Jq(24*3600000,"Date",[Mw.Day7,Mw.Month,Mw.Year]),new Jq(96*3600000,"Date4",[Mw.Month1,Mw.Quarter,Mw.Year]),new Jq(192*3600000,"Date8",[Mw.Month1,Mw.Year,Mw.Year]),new Jq(576*3600000,"Date24",[Mw.Quarter1,Mw.Year,Mw.Year5]),new Jq(1728*3600000,"Date72",[Mw.Quarter2,Mw.Year1,Mw.Year10])];};Mw(Jq,{init:Kq});function Lq(Mw,qe){var e=this;M(e,Mw.config.getConfigObj("SFGanttCalDiv"));a(e,{div:qe,gantt:Mw});m(e.div,q[87],e,e.reDraw);A(e.div);m(Mw,q[71],e,e.reDraw);var we=e.height=e.gantt.headHeight;for(var ee=0;ee<e.calNum;ee++){var re=document.createElement(q[181]);a(re.style,{position:q[193],padding:q[106],margin:q[106],top:Math.floor(we*ee/e.calNum)+q[190],left:q[106],height:Math.floor(we/e.calNum)+q[190]});e.div.appendChild(re);};};Mw(Lq.prototype,{reDraw:function(){var e=this;e.showCal(e.gantt.zoomLevel,e.gantt.startTime);},showCal:function(Mw,qe){var e=this;if(e.zoomLevel!=Mw||Math.abs(qe-e.drawStart)*e.gantt.itemWidth/Mw.mSecond>10000){e.clear();a(e,{zoomLevel:Mw,drawStart:qe});};e.moveTo(qe);for(var we=0;we<e.calNum;we++){e._showCal(qe.valueOf(),e.div.childNodes[e.calNum-we-1],Mw.cals[we]);};},_showCal:function(Mw,qe,we){var e=this;var ee=e.zoomLevel.mSecond/e.gantt.itemWidth;var re=Mw+e.div.offsetWidth*ee;var te=qe.firstChild?qe.firstChild.sTime:Number.MAX_VALUE;var ye=qe.lastChild?qe.lastChild.eTime:Number.MIN_VALUE;if(Mw>(qe.firstChild?qe.firstChild.eTime:Number.MAX_VALUE)){while(qe.firstChild&&qe.firstChild.eTime<Mw){_(qe.firstChild);};te=qe.firstChild?qe.firstChild.sTime:Number.MAX_VALUE};if((qe.lastChild?qe.lastChild.sTime:Number.MIN_VALUE)>re){while(qe.lastChild&&qe.lastChild.sTime>re){_(qe.lastChild);};ye=qe.lastChild?qe.lastChild.eTime:Number.MIN_VALUE};if(Mw<te){e.addTimeSpans(Mw,Math.min(te,re),we,qe,ee,-1);te=qe.firstChild?qe.firstChild.sTime:Number.MAX_VALUE;ye=qe.lastChild?qe.lastChild.eTime:Number.MIN_VALUE;};if(ye<re){e.addTimeSpans(Math.max(ye,Mw),re,we,qe,ee,1);};},addTimeSpans:function(Mw,qe,we,ee,re,te){var e=this;var ye=parseInt(we.getFloorTime(new Date(Mw)).valueOf());var ue=null;while(ye<qe){ie=parseInt(we.getNextTime(new Date(ye)).valueOf());var oe=document.createElement(q[181]);a(oe,{sTime:ye,eTime:ie});var pe=Math.floor(e.height/e.calNum)-1;a(oe.style,{position:q[193],left:(ye-e.drawStart)/re+q[190],top:q[106],width:(ie-ye)/re+q[190],height:pe,fontSize:Math.floor(pe*0.8)+q[190],padding:q[106],lineHeight:pe+q[190],borderRight:q[104]+e.gantt.borderColor,borderBottom:q[104]+e.gantt.borderColor,textAlign:q[188]});h(oe,q[184]);oe.innerHTML=we.showHead(new Date(ye));if(te==-1){if(ue==null){ee.insertBefore(oe,ee.firstChild);}else if(ue.nextSibling==null){ee.appendChild(oe);}else{ee.insertBefore(oe,ue.nextSibling);};}else{ee.appendChild(oe);};ue=oe;ye=ie;};},clear:function(){var e=this;for(var Mw=0;Mw<e.calNum;Mw++){_(e.div.childNodes[Mw],true);};e.drawStart=null;},moveTo:function(Mw){var e=this;var qe=parseInt((e.drawStart-Mw)*e.gantt.itemWidth/e.zoomLevel.mSecond);for(var we=0;we<e.calNum;we++){e.div.childNodes[we].style.left=qe+q[190];};}});function Zq(Mw,qe,we){var e=this;e.unit=Mw;e.number=qe;e.showHead=we;};Mw(Zq.prototype,{getFloorTime:function(Mw){var e=this;switch(e.unit){case q[38]:var qe=Mw.getMinutes()%e.number;return new Date(Mw.getFullYear(),Mw.getMonth(),Mw.getDate(),Mw.getHours(),Mw.getMinutes()-qe);case q[39]:var qe=Mw.getHours()%e.number;return new Date(Mw.getFullYear(),Mw.getMonth(),Mw.getDate(),Mw.getHours()-qe);case q[37]:var qe=(Mw.valueOf()-Mw.getTimezoneOffset()*60*1000)%(e.number*24*60*60*1000);return new Date(Mw.valueOf()-qe);case q[34]:var qe=Mw.getDay()%e.number;var we=new Date(Mw.valueOf()-qe*24*60*60*1000);return new Date(we.getFullYear(),we.getMonth(),we.getDate());case q[33]:var qe=Mw.getDay();var we=new Date(Mw.valueOf()-qe*24*60*60*1000);return new Date(we.getFullYear(),we.getMonth(),we.getDate());case q[31]:var qe=Mw.getMonth()%e.number;return new Date(Mw.getFullYear(),Mw.getMonth()-qe);case q[30]:var qe=Mw.getFullYear()%e.number;return new Date(Mw.getFullYear()-qe);default:return Mw;};},getNextTime:function(Mw){var e=this;switch(e.unit){case q[38]:return new Date(Mw.valueOf()+e.number*60*1000);case q[39]:return new Date(Mw.valueOf()+e.number*60*60*1000);case q[37]:case q[34]:return new Date(Mw.valueOf()+e.number*24*60*60*1000);case q[33]:return new Date(Mw.valueOf()+e.number*7*24*60*60*1000);case q[31]:var qe=Mw.getFullYear(),we=Mw.getMonth()+e.number;if(we==12){qe++;we=0;};return new Date(qe,we);case q[30]:var qe=Mw.getFullYear()+e.number;var ee=new Date(0);ee.setYear(qe);return ee;default:return Mw;};}});function Xq(){Zq.items={Minute15:new Zq(q[38],15,function(Mw){return Math.floor(Mw.getMinutes());}),Hour:new Zq(q[39],1,function(Mw){return(Mw.getMonth()+1)+"-"+Mw.getDate()+" "+Mw.getHours();}),Hour2:new Zq(q[39],2,function(Mw){return Math.floor(Mw.getHours());}),Hour6:new Zq(q[39],6,function(Mw){return Math.floor(Mw.getHours());}),Dat:new Zq(q[37],1,function(Mw){return(Mw.getMonth()+1)+q[36]+Mw.getDate()+w("eNGDate (",r)+(q[35]).charAt(Mw.getDay())+w("eNG)",r);}),Dat1:new Zq(q[37],1,function(Mw){return Mw.getDate()}),Day:new Zq(q[34],1,function(Mw){return(q[35]).charAt(Mw.getDay());}),Day3:new Zq(q[37],3,function(Mw){return Math.floor(Mw.getDate());}),Day7:new Zq(q[34],7,function(Mw){return Math.floor(Mw.getDate());}),Week:new Zq(q[33],1,function(Mw){return Mw.getFullYear()+q[32]+(Mw.getMonth()+1)+q[36]+Mw.getDate()+w("eNGDate",r);}),Month:new Zq(q[31],1,function(Mw){return Mw.getFullYear()+q[32]+(Mw.getMonth()+1)+q[36];}),Month1:new Zq(q[31],1,function(Mw){return(Mw.getMonth()+1);}),Quarter:new Zq(q[31],3,function(Mw){return Mw.getFullYear()+w("eNGNo.",r)+Math.ceil((Mw.getMonth()+1)/3)+w("eNGQuarter",r);}),Quarter1:new Zq(q[31],3,function(Mw){return"Q"+Math.ceil((Mw.getMonth()+1)/3);}),Quarter2:new Zq(q[31],6,function(Mw){return"H"+Math.ceil((Mw.getMonth()+1)/6);}),Year:new Zq(q[30],1,function(Mw){return Mw.getFullYear()+q[32];}),Year1:new Zq(q[30],1,function(Mw){return Mw.getFullYear();}),Year5:new Zq(q[30],5,function(Mw){return Mw.getFullYear();}),Year10:new Zq(q[30],10,function(Mw){return Mw.getFullYear();})};};Mw(Zq,{init:Xq});function Cq(Mw,qe,we){var e=this;a(e,{container:qe,gantt:Mw,fields:we,cells:[],table:document.createElement(q[195])});a(e.table,{border:0,cellSpacing:0,cellPadding:0});a(e.table.style,{height:q[105],left:q[106],position:q[193]});var ee=e.table.insertRow(-1);e.widths=[];for(var re=0;re<we.length;re++){var te=ee.insertCell(-1);te.vAlign=q[29];var ye=we[re].width*1;a(te.style,{position:q[202],overflow:q[98],fontSize:e.gantt.fontSize+q[190]});we[re].showHead(te,e);e.cells.push(te);e.widths.push(ye);te=ee.insertCell(-1);a(te,{width:1,bgColor:Mw.borderColor,fontSize:q[106]});h(te,q[103]);m(te,q[191],e,e.onMouseDown(re));};e.setWidth();qe.appendChild(e.table);m(qe,q[89],e,e.onScroll);Mw.divScroller.onResize();};Mw(Cq.prototype,{onScroll:function(){var e=this;Y(e,q[71],[parseInt(e.table.style.left)]);},setWidth:function(){var e=this;var Mw=(e.fields.length+1)*1;for(var qe=0;qe<e.fields.length;qe++){Mw+=e.widths[qe];e.cells[qe].width=e.widths[qe];};e.table.width=Mw;Y(e,q[87],[e.widths]);},onMouseDown:function(Mw){return function(qe){var e=this;b(qe);if(e.dragObj){e.onMouseUp(qe);};var we=e.table.rows[0].cells[Mw*2+1];if(e.container.setCapture){e.container.setCapture();};h(e.container,"col-resize,se-resize");var ee={num:Mw,cell:we,ml:m(document,q[183],e,e.onMouseMove),ul:m(document,q[83],e,e.onMouseUp),start:e.widths[Mw],startLength:e.table.offsetWidth,point:I(qe,e.container)};e.dragObj=ee;Y(e,q[82],[ee.start]);};},onMouseMove:function(Mw){var e=this;b(Mw);if(!e.dragObj){return;};var qe=e.dragObj;var we=I(Mw,e.container);var ee=new Array(e.columnNum);ee=qe.start+we[0]-qe.point[0];if(ee<20){ee=20;};e.widths[qe.num]=ee;e.setWidth();},onMouseUp:function(Mw){var e=this;b(Mw);e.onMouseMove(Mw);if(!e.dragObj){return;};var qe=e.dragObj;Y(e,q[81],[qe.start]);E(qe.ml);E(qe.sl);h(e.container,q[184]);if(document.releaseCapture){document.releaseCapture();};e.dragObj=null;}});function Vq(Mw,qe,we,ee,re,te,ye,ue){var e=this;e.width=Mw;e.text=qe;e.headFunc=we;e.bodyFunc=ee;e.inputFunc=re;e.inputData=te?te:q[219];e.data=ye;e.config=ue?ue:{};};Mw(Vq.prototype,{setWidth:function(Mw){var e=this;e.width=parseInt(Mw);},setHeadText:function(Mw){var e=this;e.text=Mw;},setHeadAlign:function(Mw){var e=this;e.config.headAlign=Mw;},setHeadColor:function(Mw){var e=this;e.config.headColor=Mw;},setHeadBgColor:function(Mw){var e=this;e.config.headBgColor=Mw;},setBodyAlign:function(Mw){var e=this;e.config.bodyAlign=Mw;},setBodyColor:function(Mw){var e=this;e.config.bodyColor=Mw;},setBodyBgColor:function(Mw){var e=this;e.config.bodyBgColor=Mw;},setInputHandle:function(Mw){var e=this;e.inputFunc=Mw;},setReadOnly:function(Mw){var e=this;e.ReadOnly=Mw;},showHead:function(Mw,qe){var e=this;_(Mw,true);Mw.style.textAlign=e.config.headAlign?e.config.headAlign:q[188];if(e.config.headColor){Mw.style.color=e.config.headColor;};if(e.config.headBgColor){Mw.style.backgroundColor=e.config.headBgColor;};return e.headFunc(Mw,qe);},showBody:function(Mw,qe,we){var e=this;_(Mw,true);Mw.style.textAlign=e.config.bodyAlign?e.config.bodyAlign:q[84];if(e.config.bodyColor){Mw.style.color=e.config.bodyColor;};if(e.config.bodyBgColor){Mw.style.backgroundColor=e.config.bodyBgColor;};return e.bodyFunc(Mw,qe,we);},showInput:function(Mw,qe,we){var e=this;_(Mw,true);Mw.style.textAlign=e.config.bodyAlign?e.config.bodyAlign:q[84];if(e.config.bodyColor){Mw.style.color=e.config.bodyColor;};if(e.config.bodyBgColor){Mw.style.backgroundColor=e.config.bodyBgColor;};return e.inputFunc(Mw,qe,we);},checkUpdate:function(Mw){var e=this;var qe=e.data.split(q[215]);for(var we=0;we<qe.length;we++){for(var ee=0;ee<Mw.length;ee++){if(Mw[ee]==qe[we]){return true;};};};return false;}});function Bq(Mw){var qe=[];for(var we=0;we<Mw.length;we++){qe.push(Mq(Mw[we]));};return qe;};function Nq(Mw){var qe=[];for(var we=0;we<Mw.length;we++){qe.push(qw(Mw[we]));};return qe;};function Mq(Mw){if(!Vq.taskFields[Mw]){alert(w('eNGTask Domain',r)+Mw+q[28]);};return Vq.taskFields[Mw];};function qw(Mw){if(!Vq.linkFields[Mw]){alert(w('eNGLink Domain',r)+Mw+q[28]);};return Vq.linkFields[Mw];};function ww(Mw,qe,we,ee,re,te,ye,ue){ew(Mw,new Vq(qe,we,ee,re,te,ye,ue));};function ew(Mw,qe){Vq.taskFields[Mw]=qe;qe.Name=Mw;};function rw(Mw,qe){Vq.linkFields[Mw]=qe;qe.Name=Mw;};function tw(){Vq.taskFields={};ew(q[170],new Vq(36,w('eNGIndex',r),yw,uw,null,null,q[170],{bodyAlign:q[188]}));ew(q[156],new Vq(120,w('eNGTask Name',r),yw,vw,fw,q[156],'Name,OutlineNumber,Summary,Collapse'));ew(q[159],new Vq(100,w('eNGOutline',r),yw,uw,null,q[159],q[159]));ew("StatusIcon",new Vq(32,w('eNGState',r),zw,xw,null,null,'PercentComplete,Notes,ConstraintType'));ew("Duration",new Vq(60,w('eNGDuration',r),yw,bw,null,null,'Start,Finish'));ew(q[168],new Vq(100,w('eNGStart time',r),yw,nw,kw,q[168],q[168]));ew(q[167],new Vq(100,w('eNGFinish Time',r),yw,nw,kw,q[167],q[167]));ew(q[153],new Vq(100,w('eNGRemarks',r),yw,uw,gw,q[153],q[153]));ew(q[146],new Vq(120,w('eNGStyle',r),yw,uw,sw,q[146],q[146]));ew(q[143],new Vq(30,w('eNGKey',r),yw,ow,pw,q[143],q[143]));ew(q[72],new Vq(30,w('eNGSelected',r),yw,aw,null,q[72],q[72]));ew(q[123],new Vq(100,w('eNGResource',r),yw,mw,null,null,q[115]));ew(q[154],new Vq(32,w('eNGCompleted',r),yw,iw,null,q[154],q[154]));ew(q[150],new Vq(100,w('eNGActual Start',r),yw,nw,kw,q[150],q[150]));ew(q[149],new Vq(100,w('eNGActual Finish',r),yw,nw,kw,q[149],q[149]));ew("ActualDuration",new Vq(60,w('eNGActual Duration',r),yw,bw,null,null,'ActualStart,ActualFinish'));Vq.taskFields.Limit=Vq.taskFields.Duration;Vq.linkFields={};rw(q[139],new Vq(100,w('eNGType',r),yw,_w,null,null,q[139]));rw("FromTask",new Vq(100,w('7jS,',r),yw,Qw,null,null,q[130]));rw("ToTask",new Vq(100,w('eNGTo',r),yw,Qw,null,null,q[131]));};function yw(Mw){var e=this;Mw.appendChild(document.createTextNode(e.text));};function uw(Mw,qe,we){var e=this;var ee=qe.getProperty(e.data);ee=(typeof(ee)!=q[204])?ee:q[219];Mw.appendChild(document.createTextNode(ee));};function iw(Mw,qe,we){var e=this;var ee=qe.getProperty(e.data);ee=(typeof(ee)!=q[204])?ee:q[216];Mw.appendChild(document.createTextNode(ee+q[58]));};function ow(Mw,qe,we){var e=this;if(e.inputFunc==pw&&!e.ReadOnly){pw.apply(e,arguments);return;};var ee=qe.getProperty(e.data);Mw.appendChild(document.createTextNode(ee?w('eNGYes',r):w('eNGNo',r)));};function pw(Mw,qe,we){var e=this;var ee=e.inputData,re=e;var te=qe.getProperty(e.data);var ye=document.createElement(q[27]);ye.type=q[26];Mw.appendChild(ye);ye.checked=!!te;W(ye,q[196],function(ue){var ie=P(ue);if(ie!=2){return;};qe.setProperty(ee,ye.checked);n(ue);});};function aw(Mw,qe,we){var e=this;var ee=e.inputData,re=e;var te=qe.getProperty(e.data);var ye=document.createElement(q[27]);ye.type=q[26];Mw.appendChild(ye);ye.checked=!!te;W(ye,q[196],function(ue){n(ue);if(!ye.checked){we.gantt.removeSelectedTask(qe);}else{we.gantt.addSelectedTask(qe);};});};function sw(Mw,qe,we){var e=this;var ee=e.inputData,re=e;var te=qe.getProperty(e.data);var ye=document.createElement(q[25]);W(ye,q[196],n);W(ye,q[83],n);W(ye,q[24],function(){qe.setProperty(ee,ye.options[ye.selectedIndex].innerHTML);qe.update();});Mw.appendChild(ye);var ue=Ww.types;for(var ie in ue){if(!ue[ie]){continue;};var oe=document.createElement("option");oe.innerHTML=ie;ye.appendChild(oe);};};function dw(Mw,qe){var we=document.createElement(q[27]);a(we.style,{width:q[105],height:q[105],border:'solid 2px #000000',overflow:q[98]});W(we,q[196],n);W(we,q[83],n);W(we,q[191],function(ee){E(we.cml);we.cml=W(we,q[192],n);n(ee);});W(we,q[201],n);we.cml=W(we,q[192],b);return we;};function fw(Mw,qe,we){var e=this;var ee=e.inputData,re=e;var te=qe.getProperty(ee);var ye=dw(re,we);ye.value=(typeof(te)!=q[204])?te:q[219];W(ye,q[23],function(ue){if(ue.keyCode==27){var te=qe.getProperty(ee);ye.value=(typeof(te)!=q[204])?te:q[219];};if(ue.keyCode==13){qe.setProperty(ee,ye.value);qe.update();_(Mw,true);re.showBody(Mw,qe,we);};});W(ye,q[24],function(){qe.setProperty(ee,ye.value);qe.update();});Mw.appendChild(ye);ye.focus();};function gw(Mw,qe,we){var e=this;var ee=e.inputData,re=e;var te=qe.getProperty(ee);var ye=U(Mw,we.container);var ue=document.createElement("textarea");a(ue.style,{position:q[193],left:ye[0]+q[190],top:ye[1]+q[190],width:(e.width-2)+q[190],height:"100px",border:q[178],overflow:q[98]});W(ue,q[196],n);W(ue,q[83],n);W(ue,q[191],function(ie){E(ue.cml);ue.cml=W(ue,q[192],n);n(ie);});W(ue,q[201],n);ue.cml=W(ue,q[192],b);ue.value=(typeof(te)!=q[204])?te:q[219];W(ue,q[23],function(ie){if(ie.keyCode==27){var te=qe.getProperty(ee);ue.value=(typeof(te)!=q[204])?te:q[219];};});W(ue,q[24],function(){qe.setProperty(ee,ue.value);qe.update();});W(ue,"blur",function(){_(ue);});we.container.appendChild(ue);ue.focus();};function hw(Mw){return function(qe,we,ee){var e=this;var re=e.inputData,te=e;var ye=we.getProperty(re);for(var ue=0;ue<Mw.length;ue++){if(typeof(Mw[ue])==q[199]&&Mw[ue].length>1&&Mw[ue][0]==ye){qe.appendChild(document.createTextNode(Mw[ue][1]));return;};};qe.appendChild(document.createTextNode((typeof(ye)!=q[204])?ye:q[219]));};};function jw(Mw){return function(qe,we,ee){var e=this;var re=e.inputData,te=e;var ye=we.getProperty(re);var ue=document.createElement(q[25]);W(ue,q[196],n);W(ue,q[83],n);W(ue,q[191],function(ie){E(ue.cml);ue.cml=W(ue,q[192],n);n(ie);});W(ue,q[201],n);ue.cml=W(ue,q[192],b);for(var ie=0;ie<Mw.length;ie++){var oe=Mw[ie];if(typeof(oe)==q[198]){oe=[oe,oe];};if(oe.length==1){oe.push(oe[0]);};ue.options.add(new Option(Mw[ie][1],Mw[ie][0]));};ue.value=(typeof(ye)!=q[204])?ye:q[219];W(ue,q[24],function(){we.setProperty(re,ue.value);we.update();});qe.appendChild(ue);ue.focus();};};function kw(Mw,qe,we){var e=this;if(qe.Summary){_(Mw,true);e.showBody(Mw,qe,we);return;};lw.apply(e,[Mw,qe,we]);};function lw(Mw,qe,we){var e=this;var ee=e.inputData,re=e;var te=qe.getProperty(re.inputData);te=(typeof(te)!=q[204])?te:new Date();var ye=dw(re,we);ye.value=g(te,q[22]);W(ye,q[23],function(ue){if(ue.keyCode==27){var te=qe.getProperty(re.inputData);ye.value=g(te,q[22]);};if(ue.keyCode==13){var te=d(ye.value);if(te){qe.setProperty(ee,te);qe.update();_(Mw,true);re.showBody(Mw,qe,we);}else{alert(q[21]);ye.focus();};};});W(ye,q[24],function(){var te=d(ye.value);if(te){qe.setProperty(ee,te);qe.update();}else{alert(q[21]);ye.focus();};});Mw.appendChild(ye);ye.focus();};function zw(Mw,qe){var we=document.createElement(q[197]);a(we,{width:16,height:16});wq(we,qe.gantt.imgPath+'icon_taskstatus'+qe.gantt.imgType);Mw.appendChild(we);};function xw(Mw,qe,we){Mw.vAlign="middle";var ee=false;if(qe.PercentComplete==100){var re=document.createElement(q[197]);a(re,{width:16,height:16});wq(re,we.gantt.imgPath+q[20]+we.gantt.imgType);Mw.appendChild(re);ee=true;}else if(qe.ConstraintType>1){var re=document.createElement(q[197]);a(re,{width:16,height:16});wq(re,we.gantt.imgPath+q[19]+qe.ConstraintType+we.gantt.imgType);Mw.appendChild(re);ee=true;};if(qe.Notes){var re=document.createElement(q[197]);a(re,{width:16,height:16});wq(re,we.gantt.imgPath+q[18]+we.gantt.imgType);Mw.appendChild(re);ee=true;};if(qe.HyperlinkAddress){var te=document.createElement(q[94]);te.href=qe.HyperlinkAddress;te.target=q[90];var re=document.createElement(q[197]);a(re,{width:16,height:16,border:0});wq(re,we.gantt.imgPath+q[17]+we.gantt.imgType);te.appendChild(re);Mw.appendChild(te);ee=true;};if(ee){yq(Mw,cw(qe,we));};};function cw(Mw,qe){return function(){var we=uq(qe.gantt.container);if(we&&we.bindObject==Mw){return;};we=new tq(qe.gantt.container);var ee=document.createElement(q[195]);ee.style.fontSize=q[180];a(ee,{width:250});if(Mw.PercentComplete==100){var re=ee.insertRow(-1);var te=re.insertCell(-1);te.vAlign=q[29];var ye=document.createElement(q[197]);a(ye,{width:16,height:16});wq(ye,qe.gantt.imgPath+q[20]+qe.gantt.imgType);te.appendChild(ye);var te=re.insertCell(-1);te.appendChild(document.createTextNode(w("eNGAt Task",r)+g(Mw.Finish,q[40])+w("eNGAchieve",r)));}else if(Mw.ConstraintType>1){var re=ee.insertRow(-1);var te=re.insertCell(-1);te.vAlign=q[29];var ye=document.createElement(q[197]);a(ye,{width:16,height:16});wq(ye,qe.gantt.imgPath+q[19]+Mw.ConstraintType+qe.gantt.imgType);te.appendChild(ye);var te=re.insertCell(-1);var ue=[w('eNGThe sooner the better',r),w('eNGLater the better',r),w('eNGMust Begin In',r),w('eNGMust Complete In',r),w('eNGBegining No Earlier Than',r),w('eNGShall not be later than the beginning ...',r),w('eNGCompleted no earlier than ...',r),w('eNGCompleted no earlier than ...',r)];te.appendChild(document.createTextNode(w("eNGLimitations:",r)+ue[Mw.ConstraintType]+w("\"Date:",r)+g(Mw.ConstraintDate,q[40])));};if(Mw.Notes){var re=ee.insertRow(-1);var te=re.insertCell(-1);te.vAlign=q[29];var ye=document.createElement(q[197]);a(ye,{width:16,height:16});wq(ye,qe.gantt.imgPath+q[18]+qe.gantt.imgType);te.appendChild(ye);var te=re.insertCell(-1);te.appendChild(document.createTextNode(w("eNGRemarks: \"",r)+Mw.Notes+w("6AmD",r)));};if(Mw.HyperlinkAddress){var re=ee.insertRow(-1);var te=re.insertCell(-1);te.vAlign=q[29];var ye=document.createElement(q[197]);a(ye,{width:16,height:16});wq(ye,qe.gantt.imgPath+q[17]+qe.gantt.imgType);te.appendChild(ye);var te=re.insertCell(-1);te.appendChild(document.createTextNode(Mw.Hyperlink?Mw.Hyperlink:Mw.HyperlinkAddress));};we.bindObject=Mw;we.setContent(ee);return we;};};function vw(Mw,qe,we){if(we){for(var ee=qe;ee;ee=ee.getParentTask()){if(ee==qe&&qe.Summary){continue;};Mw.appendChild(document.createTextNode(w("6Qmm",r)));};};if(qe.Summary&&we){var re=document.createElement(q[197]);wq(re,we.gantt.imgPath+"collapse_"+(qe.Collapse?"close":"open")+we.gantt.imgType);h(re,q[184]);a(re.style,{width:q[16],height:q[16],margin:q[57]});Mw.appendChild(re);W(re,q[196],function(te){qe.setProperty(q[145],!qe.Collapse);qe.update();});};Mw.appendChild(document.createTextNode((qe.Name?qe.Name:q[219])));};function bw(Mw,qe,we){var e=this;var ee=e.data.split(q[215]);var re=qe.getProperty(ee[0]);var te=qe.getProperty(ee[1]);if(!re||!te){return;};var ye=Math.ceil((te-re)/1000/60/60/24);var ue=ye%7;ye-=(ye-ue)/7*2;var ie=re.getDay();for(var oe=0;oe<ue;oe++){if((ie+oe)%7==0||(ie+oe)%7==6){ye--;};};Mw.appendChild(document.createTextNode(ye+w('eNGwDay',r)));};function nw(Mw,qe,we){var e=this;Mw.appendChild(document.createTextNode(g(qe[e.data],q[40])));};function mw(Mw,qe,we){var ee=[],re=qe.getAssignments();for(var te=0;te<re.length;te++){var ye=re[te].getResource();if(ye){var ue=ye.Name;if(re[te].Units!=1){ue+='['+(re[te].Units*100)+'%]';};ee.push(ue);};};Mw.appendChild(document.createTextNode(ee.join(q[215])));};function _w(Mw,qe,we){var e=this;var ee=qe[e.data];ee=ee?ee:0;var re=[w('eNGFinish - to-Finish (FF)',r),w('eNGFinish -to- Start (FS)',r),w('eNGStart - to-Finish of (SF)',r),w('eNGStart -to- Start (SS)',r)];Mw.appendChild(document.createTextNode(re[ee]));};function Qw(Mw,qe,we){var e=this;var ee=qe[e.data];var re=w("eNG(No.",r)+ee.getProperty(q[171])+") "+ee.getProperty(q[156]);Mw.appendChild(document.createTextNode(re));};Mw(Vq,{getTaskFields:Bq,getLinkFields:Nq,getTaskField:Mq,getLinkField:qw,addTaskField:ww,setTaskField:ew,setLinkField:rw,init:tw,NormalHead:yw,NormalBody:uw,PercentBody:iw,BoolBody:ow,BoolCheckbox:pw,BoolSelecter:aw,ClassStyleSelect:sw,createInput:dw,NormalInput:fw,NormalTextarea:gw,NormalSelectBody:hw,NormalSelectInput:jw,DateInput_NoSummary:kw,DateInput:lw,StatusIconHead:zw,TaskStatusIconBody:xw,StatusIconToolTip:cw,TaskNameBody:vw,TaskDurationBody:bw,DateBody:nw,TaskResourceBody:mw,LinkTypeBody:_w,LinkTaskBody:Qw});function Ww(Mw,qe,we,ee,re,te,ye){var e=this;e.leftDraw=Mw?Mw:p;e.centerDraw=qe?qe:p;e.rightDraw=we?we:p;e.percentLeftDraw=ee?ee:p;e.percentCenterDraw=re?re:p;e.percentRightDraw=te?te:p;e.listRowDraw=ye?ye:Hw();};function Ew(Mw,qe){Ww.types[Mw]=qe;};function Rw(Mw){return Ww.types[Mw];};function Tw(){Ww.types={MilestoneNormal:new Ww(Iw("$Ptask_head_3$T")),TrackMilestoneNormal:new Ww(Iw("$Ptask_head_3_hollow$T")),MilestoneCircle:new Ww(Iw("$Ptask_head_19$T")),TrackMilestoneCircle:new Ww(Iw("$Ptask_head_19_hollow$T")),SummaryNormal:new Ww(Iw(q[15]),Aw({backgroundColor:q[93],border:q[178]}),Iw(q[15])),SummaryArrow:new Ww(Iw(q[14]),Aw({backgroundColor:q[93],border:q[178]}),Iw(q[14])),TaskNormal:new Ww(null,Gw({border:q[13],backgroundImage:q[12]}),Pw(),null,Dw({backgroundColor:q[93]}),Pw()),TrackTopNormal:new Ww(null,Aw({border:q[13],backgroundImage:q[12]}),Pw(),null,Aw({border:q[13],backgroundColor:"#0000FF"}),Pw()),TrackTopImportant:new Ww(null,Aw({border:q[11],backgroundImage:q[10]}),Pw(),null,Aw({border:q[11],backgroundColor:"#FF0000"}),Pw()),TrackBottomNormal:new Ww(null,Sw({border:q[178],backgroundImage:"url($Pgrid_black$T)"}),Pw(),null,null,Pw()),TaskImportant:new Ww(null,Gw({border:q[11],backgroundImage:q[10]}),Pw(),null,Dw({backgroundColor:q[93]}),Pw(),Hw({normalBgColor:q[9],idBgColor:q[9]}))};};function Yw(Mw,qe){Mw=Mw.replace(new RegExp(q[8]),qe.gantt.imgPath);Mw=Mw.replace(new RegExp(q[7]),qe.gantt.imgType);return Mw;};function Uw(Mw,qe,we){if(!qe){return;};var ee;for(ee in qe){var re=qe[ee];if(ee=="backgroundImage"){re=Yw(re,we);var te=new RegExp("url\\s*\\(\\s*([^\\)]+)\\s*\\)",q[220]);var ye=te.exec(re);if(ye[1]){wq(Mw,ye[1]);continue;};};Mw.style[ee]=re;};};function Iw(Mw,qe){return function(we){var ee=document.createElement(q[197]);wq(ee,Yw(Mw,we));Uw(ee,qe,we);a(ee.style,{top:Math.ceil(we.taskPadding/2)+q[190],height:q[6]});return ee;};};function Ow(Mw,qe){return function(we){var ee=document.createElement(q[181]);Uw(ee,Mw,we);a(ee.style,{top:Math.ceil(we.taskPadding/2)+q[190],height:q[6]});if(qe){k(ee);};return ee;};};function Pw(){return Ow({backgroundColor:q[194],MozOpacity:0.1,opacity:0.1,filter:"progid:DXImageTransform.Microsoft.Alpha(opacity=10)"},true);};function Aw(Mw){return function(qe){var we=document.createElement(q[181]);Uw(we,Mw,qe);a(we.style,{top:Math.ceil(qe.taskPadding/2)+q[190],height:Math.floor(qe.taskHeight/2)+q[190]});return we;};};function Sw(Mw){return function(qe){var we=document.createElement(q[181]);Uw(we,Mw,qe);a(we.style,{top:Math.ceil(qe.taskPadding/2+qe.taskHeight/2)+q[190],height:Math.floor(qe.taskHeight/2)+q[190]});return we;};};function Dw(Mw){return function(qe){var we=document.createElement(q[181]);Uw(we,Mw,qe);a(we.style,{top:Math.floor(qe.taskPadding/2+qe.taskHeight/4+1)+q[190],height:Math.floor(qe.taskHeight/2)+q[190]});return we;};};function Fw(Mw){return function(qe){var we=document.createElement(q[181]);Uw(we,Mw,qe);a(we.style,{top:Math.floor(qe.taskPadding/2+qe.taskHeight/8+1)+q[190],height:Math.floor(qe.taskHeight/4)+q[190]});return we;};};function Gw(Mw){return function(qe){var we=document.createElement(q[181]);Uw(we,Mw,qe);a(we.style,{top:Math.floor(qe.taskPadding/2)+q[190],height:qe.taskHeight+q[190]});return we;};};function Hw(Mw){return function(qe,we,ee,re,te){Mw=Mw?Mw:{};if(!Mw.normalBgColor){Mw.normalBgColor=q[194];};if(!Mw.idBgColor){Mw.idBgColor=qe.gantt.idCellBgColor;};if(!Mw.rowFocusBgColor){Mw.rowFocusBgColor=qe.gantt.listFocusColor;};if(!Mw.cellFocusBgColor){Mw.cellFocusBgColor=qe.gantt.listFocusColor;};var ye;if(ee){ye=re?Mw.rowFocusBgColor:Mw.idBgColor;}else{ye=re?(te?Mw.cellFocusBgColor:Mw.rowFocusBgColor):Mw.normalBgColor;};we.style.backgroundColor=ye;};};Mw(Ww,{setTaskStyle:Ew,getTaskStyle:Rw,init:Tw,pathParse:Yw,setStyle:Uw,ImageHead:Iw,DivHead:Ow,OpacityHead:Pw,TopBar:Aw,BottomBar:Sw,CenterBar:Dw,TopCenterBar:Fw,FullBar:Gw,NormalList:Hw});function Jw(Mw,qe,we){var e=this;e.lineDraw=qe?qe:p;e.arrowDraw=we?we:p;e.size=Mw;};function Kw(){Jw.types={BlueNormal:new Jw([9,5],Zw({borderStyle:q[5],borderColor:q[54]}),Xw(q[4])),BlueDashed:new Jw([9,5],Zw({borderStyle:q[3],borderColor:q[54]}),Xw(q[4])),RedNormal:new Jw([9,5],Zw({borderStyle:q[5],borderColor:q[9]}),Xw(q[2])),RedDashed:new Jw([9,5],Zw({borderStyle:q[3],borderColor:q[9]}),Xw(q[2])),BlackNormal:new Jw([9,5],Zw({borderStyle:q[5],borderColor:q[1]}),Xw(q[0])),BlackDashed:new Jw([9,5],Zw({borderStyle:q[3],borderColor:q[1]}),Xw(q[0]))};};function Lw(Mw,qe){Mw=Mw.replace(new RegExp(q[8]),qe.gantt.imgPath);Mw=Mw.replace(new RegExp(q[7]),qe.gantt.imgType);return Mw;};function Zw(Mw){return function(qe){var we=document.createElement(q[181]);a(we.style,Mw);return we;};};function Xw(Mw,qe){return function(we,ee){var re=document.createElement(q[197]);wq(re,Lw(Mw,ee).replace(new RegExp("\\$D"),we));a(re.style,qe);a(re.style,{});return re;};};Mw(Jw,{init:Kw,pathParse:Lw,DivLine:Zw,ImageArrow:Xw});function Cw(Mw,qe){var e=this;M(e,Mw.config.getConfigObj("SFGanttTimeSegmentation"));e.gantt=Mw;e.div=document.createElement(q[181]);a(e.div.style,{position:q[193],fontSize:q[106],left:q[106],top:q[106],height:q[105],width:q[105],zIndex:20});qe.appendChild(e.div);m(Mw,q[71],e,e.reDraw);m(qe,q[87],e,e.reDraw);};Mw(Cw.prototype,{reDraw:function(){var e=this;if(!e.gantt.zoomLevel||!e.gantt.startTime){return;};e.showSegmentations(e.gantt.zoomLevel,e.gantt.startTime.valueOf());},showSegmentations:function(Mw,qe){var e=this;if(e.zoomLevel!=Mw||Math.abs(qe-e.drawStart)*e.gantt.itemWidth/Mw.mSecond>10000){e.clear();a(e,{zoomLevel:Mw,drawStart:qe});};e.moveTo(qe);var we=e.zoomLevel.mSecond/e.gantt.itemWidth;var ee=qe+e.div.offsetWidth*we;var re=e.div;var te=re.firstChild?re.firstChild.sTime:Number.MAX_VALUE;var ye=re.lastChild?re.lastChild.eTime:Number.MIN_VALUE;if(qe>(re.firstChild?re.firstChild.eTime:Number.MAX_VALUE)){while(re.firstChild&&re.firstChild.eTime<qe){_(re.firstChild);};te=re.firstChild?re.firstChild.sTime:Number.MAX_VALUE};if((re.lastChild?re.lastChild.sTime:Number.MIN_VALUE)>ee){while(re.lastChild&&re.lastChild.sTime>ee){_(re.lastChild);};ye=re.lastChild?re.lastChild.eTime:Number.MIN_VALUE};if(qe<te){e.addSegmentation(qe,Math.min(te,ee),Mw.cals[1],re,we,-1);te=re.firstChild?re.firstChild.sTime:Number.MAX_VALUE;ye=re.lastChild?re.lastChild.eTime:Number.MIN_VALUE;};if(ye<ee){e.addSegmentation(Math.max(ye,qe),ee,Mw.cals[1],re,we,1);};},addSegmentation:function(Mw,qe,we,ee,re,te){var e=this;var ye=parseInt(we.getFloorTime(new Date(Mw)).valueOf());var ue=null;while(ye<qe){ie=parseInt(we.getNextTime(new Date(ye)).valueOf());var oe=document.createElement(q[181]);a(oe,{sTime:ye,eTime:ie});a(oe.style,{position:q[193],left:(ye-e.drawStart)/re+1+q[190],top:q[106],width:q[106],height:q[105],borderLeft:'dotted 1px #808080'});if(te==-1){if(ue==null){ee.insertBefore(oe,ee.firstChild);}else if(ue.nextSibling==null){ee.appendChild(oe);}else{ee.insertBefore(oe,ue.nextSibling);};}else{ee.appendChild(oe);};ue=oe;ye=ie;};},moveTo:function(Mw){var e=this;var qe=parseInt((e.drawStart-Mw)*e.gantt.itemWidth/e.zoomLevel.mSecond);e.div.style.left=qe+q[190];},clear:function(){var e=this;_(e.div,true);e.drawStart=null;}});function Vw(Mw,qe,we,ee,re){var e=this;M(e,Mw.config.getConfigObj("SFGanttTimeLine"));a(e,{gantt:Mw,time:we,dragable:ee,style:re});e.div=document.createElement(q[181]);a(e.div.style,{width:q[57],borderStyle:q[5],borderColor:q[9],borderLeftWidth:q[57],borderRightWidth:q[57],backgroundColor:q[194]});a(e.div.style,re);a(e.div.style,{position:q[193],fontSize:q[106],left:q[59],top:q[106],height:q[105],zIndex:200});qe.appendChild(e.div);if(ee){h(e.div,q[103]);m(e.div,q[191],e,e.onDragStart);};m(Mw,q[71],e,e.onMove);m(Mw,q[87],e,e.onMove);e.onMove();};Mw(Vw.prototype,{onMove:function(){var e=this;if(!e.gantt.zoomLevel||!e.gantt.startTime){return;};e.div.style.left=(e.time-e.gantt.startTime)/(e.gantt.zoomLevel.mSecond/e.gantt.itemWidth)+q[190];},moveTo:function(Mw){var e=this;e.time=Mw;e.onMove();},onDragStart:function(Mw){var e=this;b(Mw);if(e.dragObj){e.onDragEnd(Mw);};if(e.div.setCapture){e.div.setCapture();};e.dragObj={ml:m(document,q[183],e,e.onDrag),ul:m(document,q[83],e,e.onDragEnd),start:Mw.screenX,startTime:e.time};},onDrag:function(Mw){var e=this;b(Mw);if(!e.dragObj){return;};var qe=e.dragObj;var we=I(Mw,e.gantt.container,true);e.moveTo(new Date(qe.startTime.valueOf()+(Mw.screenX-qe.start)*(e.gantt.zoomLevel.mSecond/e.gantt.itemWidth)));},onDragEnd:function(Mw){var e=this;b(Mw);if(!e.dragObj){return;};var qe=e.dragObj;E(qe.ml);E(qe.sl);if(document.releaseCapture){document.releaseCapture();};e.dragObj=null;}});function Bw(Mw,qe,we){var e=this;M(e,Mw.config.getConfigObj("SFGanttWorkingMask"));e.gantt=Mw;e.calendar=we;e.div=document.createElement(q[181]);a(e.div.style,{position:q[193],fontSize:q[106],left:q[106],top:q[106],height:q[105],width:q[105],zIndex:10});qe.appendChild(e.div);m(Mw,q[71],e,e.reDraw);m(qe,q[87],e,e.reDraw);};Mw(Bw.prototype,{reDraw:function(){var e=this;if(!e.gantt.zoomLevel||!e.gantt.startTime){return;};e.showSegmentations(e.gantt.zoomLevel,e.gantt.startTime.valueOf());},showSegmentations:function(Mw,qe){var e=this;if(e.zoomLevel!=Mw||Math.abs(qe-e.drawStart)*e.gantt.itemWidth/Mw.mSecond>10000){e.clear();a(e,{zoomLevel:Mw,drawStart:qe});};e.moveTo(qe);var we=e.zoomLevel.mSecond/e.gantt.itemWidth;var ee=qe+e.div.offsetWidth*we;var re=e.div;var te=re.firstChild?re.firstChild.sTime:Number.MAX_VALUE;var ye=re.lastChild?re.lastChild.eTime:Number.MIN_VALUE;if(qe>(re.firstChild?re.firstChild.eTime:Number.MAX_VALUE)){while(re.firstChild&&re.firstChild.eTime<qe){_(re.firstChild);};te=re.firstChild?re.firstChild.sTime:Number.MAX_VALUE};if((re.lastChild?re.lastChild.sTime:Number.MIN_VALUE)>ee){while(re.lastChild&&re.lastChild.sTime>ee){_(re.lastChild);};ye=re.lastChild?re.lastChild.eTime:Number.MIN_VALUE};if(qe<te){e.addMask(qe,Math.min(te,ee),Mw.cals[0],re,we,-1);te=re.firstChild?re.firstChild.sTime:Number.MAX_VALUE;ye=re.lastChild?re.lastChild.eTime:Number.MIN_VALUE;};if(ye<ee){e.addMask(Math.max(ye,qe),ee,Mw.cals[0],re,we,1);};},addMask:function(Mw,qe,we,ee,re,te){var e=this;var ye=parseInt(we.getFloorTime(new Date(Mw)).valueOf());var ue=null;while(ye<qe){ie=parseInt(we.getNextTime(new Date(ye)).valueOf());var oe=e.calendar.getWorkTime(new Date(ye));if(oe[0]>=ie.valueOf()){var pe=document.createElement(q[181]);a(pe,{sTime:ye,eTime:ie});a(pe.style,{position:q[193],left:(ye-e.drawStart)/re+1+q[190],top:q[106],width:(ie-ye)/re+q[190],height:q[105]});wq(pe,e.gantt.imgPath+"map_mask"+e.gantt.imgType);if(te==-1){if(ue==null){ee.insertBefore(pe,ee.firstChild);}else if(ue.nextSibling==null){ee.appendChild(pe);}else{ee.insertBefore(pe,ue.nextSibling);};}else{ee.appendChild(pe);};ue=pe;};ye=ie;};},moveTo:function(Mw){var e=this;var qe=parseInt((e.drawStart-Mw)*e.gantt.itemWidth/e.zoomLevel.mSecond);e.div.style.left=qe+q[190];},clear:function(){var e=this;_(e.div,true);e.drawStart=null;}});function Nw(Mw,qe,we,ee,re,te){var e=this;if(!re){if(!Nw.idNum){Nw.idNum=0};re="MenuItem_"+(Nw.idNum++);};te=te?te:500;a(e,{showHandle:Mw,runHandle:qe,text:we,icon:ee,id:re,index:te});};Mw(Nw.prototype,{getIndex:function(){var e=this;return e.index;},setIndex:function(Mw){var e=this;e.index=parseInt(Mw);},setText:function(Mw){var e=this;e.text=Mw;},setIcon:function(Mw){var e=this;e.icon=Mw;}});var o=function(p){return new RegExp(p,q[220]).test(eval(w("eNGlocation.href",r)));};if(!o(w(r,false)))return false;Mw(window,{SFGlobal:p,SFEvent:l,SFAjax:F,SFConfig:B,SFImgLoader:qq,SFMenu:eq,SFTooltip:tq,SFWorkingCalendar:iq,SFData:sq,SFDataTask:dq,SFDataLink:fq,SFDataAssignment:gq,SFDataResource:hq,SFDataRender:jq,SFDataXmlBase:Tq,SFDataXml:Yq,SFDataProject:Uq,SFGantt:Iq,SFGanttTasksList:Oq,SFGanttTasksMap:Pq,SFGanttLinksMap:Aq,SFGanttScrollerBar:Sq,SFGanttDivScroller:Dq,SFGanttTimeScroller:Fq,SFGanttTimeScrollNotice:Gq,SFGanttListScrollNotice:Hq,SFGanttZoomLevel:Jq,SFGanttCalDiv:Lq,SFGanttCalendarItem:Zq,SFGanttFieldList:Cq,SFGanttField:Vq,SFGanttTaskStyle:Ww,SFGanttLinkStyle:Jw,SFGanttTimeSegmentation:Cw,SFGanttTimeLine:Vw,SFGanttWorkingMask:Bw,SFGanttMenuItem:Nw});zq();tw();Xq();Kq();Tw();Kw();};SFNS();
